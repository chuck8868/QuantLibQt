<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: QuantLib::SobolRsg Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_quant_lib_1_1_sobol_rsg.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">QuantLib::SobolRsg Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="QuantLib::SobolRsg" -->
<p>Sobol low-discrepancy sequence generator.  
 <a href="class_quant_lib_1_1_sobol_rsg.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for QuantLib::SobolRsg:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_lib_1_1_sobol_rsg__coll__graph.png" border="0" usemap="#_quant_lib_1_1_sobol_rsg_coll__map" alt="Collaboration graph"/></div>
<map name="_quant_lib_1_1_sobol_rsg_coll__map" id="_quant_lib_1_1_sobol_rsg_coll__map">
<area shape="rect" id="node4" href="struct_quant_lib_1_1_sample.html" title="{QuantLib::Sample\&lt; std::vector\&lt; Real \&gt; \&gt;\n|+ value\l+ weight\l|+ Sample()\l}" alt="" coords="147,481,408,583"/><area shape="rect" id="node10" title="STL class." alt="" coords="372,157,487,243"/><area shape="rect" id="node16" href="struct_quant_lib_1_1_sample.html" title="weighted sample" alt="" coords="5,310,163,413"/><area shape="rect" id="node30" href="classbool.html" title="{bool\n||}" alt="" coords="1000,489,1045,575"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_quant_lib_1_1_sobol_rsg-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198e">DirectionIntegers</a> { <br/>
&#160;&#160;<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7062e2e83a0101c29f22f093d607d73d">Unit</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a">Jaeckel</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eac905d7dad337425451148623dd611852">SobolLevitan</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7c05aca73695d816b1ca14c9c1a73d0a">SobolLevitanLemieux</a>, 
<br/>
&#160;&#160;<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea291be55f0d4a4e76723d0576192e140e">JoeKuoD5</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea3e87f4b80a2255b2182b754a3f8090f7">JoeKuoD6</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eae537726fb0cc93018c3c24715c34103f">JoeKuoD7</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea5f4682bbab602a2be86aae2e4b7717c8">Kuo</a>, 
<br/>
&#160;&#160;<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea313b0c1cb348bf427ca25928ff0a7b52">Kuo2</a>, 
<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea27e06eba18e90f7b454972df9c558a17">Kuo3</a>
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="struct_quant_lib_1_1_sample.html">Sample</a>&lt; std::vector<br class="typebreak"/>
&lt; <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">sample_type</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a9e664d4d94f4b46225598b74e987d86b">SobolRsg</a> (<a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> dimensionality, unsigned long seed=0, <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198e">DirectionIntegers</a> directionIntegers=<a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a">Jaeckel</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a085f759d23f6141706115cfff9b5f440">skipTo</a> (unsigned long n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::vector&lt; unsigned <br class="typebreak"/>
long &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ad599608efe6fa8b4a66292fc0ac394f6">nextInt32Sequence</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">SobolRsg::sample_type</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a6243fb058bb4ac51549778c455a6ed2a">nextSequence</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">sample_type</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a029e6036db427b65b2668f8fa9950036">lastSequence</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ab8408639f89583293d48990ebba339f9">dimension</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">sequenceCounter_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a634729475f839566d0c7e5bfc909c5b5">firstDraw_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">sample_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ad7d8aa0d8dd78a57d2cdfb63f07040cc">sequence_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; unsigned long &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ac0a67a99bbb574ba1762d94852f9dd57">bits_</a> = 8*sizeof(unsigned long)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a374bb09fd8d54735e56ede5f79ecb356">normalizationFactor_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Sobol low-discrepancy sequence generator. </p>
<p>A Gray code counter and bitwise operations are used for very fast sequence generation.</p>
<p>The implementation relies on primitive polynomials modulo two from the book "Monte Carlo Methods in Finance" by Peter Jäckel.</p>
<p>21 200 primitive polynomials modulo two are provided in <a class="el" href="namespace_quant_lib.html">QuantLib</a>. Jäckel has calculated 8 129 334 polynomials: if you need that many dimensions you can replace the <a class="el" href="primitivepolynomials_8c.html">primitivepolynomials.c</a> file included in <a class="el" href="namespace_quant_lib.html">QuantLib</a> with the one provided in the CD of the "Monte Carlo
        Methods in Finance" book.</p>
<p>The choice of initialization numbers (also know as free direction integers) is crucial for the homogeneity properties of the sequence. Sobol defines two homogeneity properties: Property A and Property A'.</p>
<p>The unit initialization numbers suggested in "Numerical
        Recipes in C", 2nd edition, by Press, Teukolsky, Vetterling, and Flannery (section 7.7) fail the test for Property A even for low dimensions.</p>
<p>Bratley and Fox published coefficients of the free direction integers up to dimension 40, crediting unpublished work of Sobol' and Levitan. See Bratley, P., Fox, B.L. (1988) "Algorithm 659: Implementing Sobol's quasirandom sequence
        generator," ACM Transactions on Mathematical Software 14:88-100. These values satisfy Property A for d&lt;=20 and d = 23, 31, 33, 34, 37; Property A' holds for d&lt;=6.</p>
<p>Jäckel provides in his book (section 8.3) initialization numbers up to dimension 32. Coefficients for d&lt;=8 are the same as in Bradley-Fox, so Property A' holds for d&lt;=6 but Property A holds for d&lt;=32.</p>
<p>The implementation of Lemieux, Cieslak, and Luttmer includes coefficients of the free direction integers up to dimension 360. Coefficients for d&lt;=40 are the same as in Bradley-Fox. For dimension 40&lt;d&lt;=360 the coefficients have been calculated as optimal values based on the "resolution" criterion. See "RandQMC user's guide - A package for
        randomized quasi-Monte Carlo methods in C," by C. Lemieux, M. Cieslak, and K. Luttmer, version January 13 2004, and references cited there (<a href="http://www.math.ucalgary.ca/~lemieux/randqmc.html">http://www.math.ucalgary.ca/~lemieux/randqmc.html</a>). The values up to d&lt;=360 has been provided to the <a class="el" href="namespace_quant_lib.html">QuantLib</a> team by Christiane Lemieux, private communication, September 2004.</p>
<p>For more info on Sobol' sequences see also "Monte Carlo
        Methods in Financial Engineering," by P. Glasserman, 2004, Springer, section 5.2.3</p>
<p>The Joe--Kuo numbers and the Kuo numbers are due to Stephen Joe and Frances Kuo.</p>
<p><a class="el" href="class_s.html">S</a>. Joe and F. Y. Kuo, Constructing Sobol sequences with better two-dimensional projections, preprint Nov 22 2007</p>
<p>See <a href="http://web.maths.unsw.edu.au/~fkuo/sobol/">http://web.maths.unsw.edu.au/~fkuo/sobol/</a> for more information.</p>
<p>Note that the Kuo numbers were generated to work with a different ordering of primitive polynomials for the first 40 or so dimensions which is why we have the Alternative Primitive Polynomials.</p>
<dl class="test"><dt><b><a class="el" href="test.html#_test000060">Test:</a></b></dt><dd><ul>
<li>the correctness of the returned values is tested by reproducing known good values.</li>
<li>the correctness of the returned values is tested by checking their discrepancy against known good values. </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00106">106</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="aeb1f097c92ea0ee29444cdf737679831"></a><!-- doxytag: member="QuantLib::SobolRsg::sample_type" ref="aeb1f097c92ea0ee29444cdf737679831" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="struct_quant_lib_1_1_sample.html">Sample</a>&lt;std::vector&lt;<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&gt; &gt; <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">QuantLib::SobolRsg::sample_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00108">108</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

</div>
</div>
<hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198e"></a><!-- doxytag: member="QuantLib::SobolRsg::DirectionIntegers" ref="a8f49db623f15993ffd3c00abf9fe198e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198e">QuantLib::SobolRsg::DirectionIntegers</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea7062e2e83a0101c29f22f093d607d73d"></a><!-- doxytag: member="Unit" ref="a8f49db623f15993ffd3c00abf9fe198ea7062e2e83a0101c29f22f093d607d73d" args="" -->Unit</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a"></a><!-- doxytag: member="Jaeckel" ref="a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a" args="" -->Jaeckel</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198eac905d7dad337425451148623dd611852"></a><!-- doxytag: member="SobolLevitan" ref="a8f49db623f15993ffd3c00abf9fe198eac905d7dad337425451148623dd611852" args="" -->SobolLevitan</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea7c05aca73695d816b1ca14c9c1a73d0a"></a><!-- doxytag: member="SobolLevitanLemieux" ref="a8f49db623f15993ffd3c00abf9fe198ea7c05aca73695d816b1ca14c9c1a73d0a" args="" -->SobolLevitanLemieux</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea291be55f0d4a4e76723d0576192e140e"></a><!-- doxytag: member="JoeKuoD5" ref="a8f49db623f15993ffd3c00abf9fe198ea291be55f0d4a4e76723d0576192e140e" args="" -->JoeKuoD5</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea3e87f4b80a2255b2182b754a3f8090f7"></a><!-- doxytag: member="JoeKuoD6" ref="a8f49db623f15993ffd3c00abf9fe198ea3e87f4b80a2255b2182b754a3f8090f7" args="" -->JoeKuoD6</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198eae537726fb0cc93018c3c24715c34103f"></a><!-- doxytag: member="JoeKuoD7" ref="a8f49db623f15993ffd3c00abf9fe198eae537726fb0cc93018c3c24715c34103f" args="" -->JoeKuoD7</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea5f4682bbab602a2be86aae2e4b7717c8"></a><!-- doxytag: member="Kuo" ref="a8f49db623f15993ffd3c00abf9fe198ea5f4682bbab602a2be86aae2e4b7717c8" args="" -->Kuo</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea313b0c1cb348bf427ca25928ff0a7b52"></a><!-- doxytag: member="Kuo2" ref="a8f49db623f15993ffd3c00abf9fe198ea313b0c1cb348bf427ca25928ff0a7b52" args="" -->Kuo2</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8f49db623f15993ffd3c00abf9fe198ea27e06eba18e90f7b454972df9c558a17"></a><!-- doxytag: member="Kuo3" ref="a8f49db623f15993ffd3c00abf9fe198ea27e06eba18e90f7b454972df9c558a17" args="" -->Kuo3</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00109">109</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>
<div class="fragment"><pre class="fragment">                               {
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7062e2e83a0101c29f22f093d607d73d">Unit</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a">Jaeckel</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eac905d7dad337425451148623dd611852">SobolLevitan</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7c05aca73695d816b1ca14c9c1a73d0a">SobolLevitanLemieux</a>,
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea291be55f0d4a4e76723d0576192e140e">JoeKuoD5</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea3e87f4b80a2255b2182b754a3f8090f7">JoeKuoD6</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eae537726fb0cc93018c3c24715c34103f">JoeKuoD7</a>,
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea5f4682bbab602a2be86aae2e4b7717c8">Kuo</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea313b0c1cb348bf427ca25928ff0a7b52">Kuo2</a>, <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea27e06eba18e90f7b454972df9c558a17">Kuo3</a> };
</pre></div>
</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9e664d4d94f4b46225598b74e987d86b"></a><!-- doxytag: member="QuantLib::SobolRsg::SobolRsg" ref="a9e664d4d94f4b46225598b74e987d86b" args="(Size dimensionality, unsigned long seed=0, DirectionIntegers directionIntegers=Jaeckel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a9e664d4d94f4b46225598b74e987d86b">QuantLib::SobolRsg::SobolRsg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>dimensionality</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>seed</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198e">DirectionIntegers</a>&#160;</td>
          <td class="paramname"><em>directionIntegers</em> = <code><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a">Jaeckel</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="pre"><dt><b>Precondition:</b></dt><dd>dimensionality must be &lt;= PPMT_MAX_DIM </dd></dl>

<p>Definition at line <a class="el" href="sobolrsg_8cpp_source.html#l39718">39718</a> of file <a class="el" href="sobolrsg_8cpp_source.html">sobolrsg.cpp</a>.</p>

<p>References <a class="el" href="sobolrsg_8cpp_source.html#l00133">QuantLib::anonymous_namespace{sobolrsg.cpp}::AltPrimitivePolynomials</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00130">bits_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00132">dimensionality_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00137">directionIntegers_</a>, <a class="el" href="sobolrsg_8cpp_source.html#l00323">QuantLib::anonymous_namespace{sobolrsg.cpp}::initializers</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00136">integerSequence_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00110">Jaeckel</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00111">JoeKuoD5</a>, <a class="el" href="sobolrsg_8cpp_source.html#l37708">QuantLib::anonymous_namespace{sobolrsg.cpp}::JoeKuoD5initializers</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00111">JoeKuoD6</a>, <a class="el" href="sobolrsg_8cpp_source.html#l30100">QuantLib::anonymous_namespace{sobolrsg.cpp}::JoeKuoD6initializers</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00111">JoeKuoD7</a>, <a class="el" href="sobolrsg_8cpp_source.html#l33804">QuantLib::anonymous_namespace{sobolrsg.cpp}::JoeKuoD7initializers</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00112">Kuo</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00112">Kuo2</a>, <a class="el" href="sobolrsg_8cpp_source.html#l15170">QuantLib::anonymous_namespace{sobolrsg.cpp}::Kuo2initializers</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00112">Kuo3</a>, <a class="el" href="sobolrsg_8cpp_source.html#l23708">QuantLib::anonymous_namespace{sobolrsg.cpp}::Kuo3initializers</a>, <a class="el" href="sobolrsg_8cpp_source.html#l06292">QuantLib::anonymous_namespace{sobolrsg.cpp}::Kuoinitializers</a>, <a class="el" href="sobolrsg_8cpp_source.html#l01002">QuantLib::anonymous_namespace{sobolrsg.cpp}::Linitializers</a>, <a class="el" href="sobolrsg_8cpp_source.html#l00033">QuantLib::anonymous_namespace{sobolrsg.cpp}::maxAltDegree</a>, <a class="el" href="mt19937uniformrng_8hpp_source.html#l00054">QuantLib::MersenneTwisterUniformRng::next()</a>, <a class="el" href="primitivepolynomials_8h_source.html#l00204">PPMT_MAX_DIM</a>, <a class="el" href="primitivepolynomials_8c_source.html#l21323">PrimitivePolynomials</a>, <a class="el" href="errors_8hpp_source.html#l00086">QL_REQUIRE</a>, <a class="el" href="sobolrsg_8cpp_source.html#l00227">QuantLib::anonymous_namespace{sobolrsg.cpp}::SLinitializers</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00110">SobolLevitan</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00110">SobolLevitanLemieux</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00110">Unit</a>, and <a class="el" href="sample_8hpp_source.html#l00039">QuantLib::Sample&lt; T &gt;::value</a>.</p>
<div class="fragment"><pre class="fragment">    : <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>(<a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>), <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">sequenceCounter_</a>(0), <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a634729475f839566d0c7e5bfc909c5b5">firstDraw_</a>(<span class="keyword">true</span>),
      <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ad7d8aa0d8dd78a57d2cdfb63f07040cc">sequence_</a>(std::vector&lt;Real&gt; (<a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>), 1.0),
      <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>(<a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>, 0),
      <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>(<a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>,std::vector&lt;unsigned long&gt;(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac0a67a99bbb574ba1762d94852f9dd57">bits_</a>)) {

        <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>&gt;0,
                   <span class="stringliteral">&quot;dimensionality must be greater than 0&quot;</span>);
      <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>&lt;=<a class="code" href="primitivepolynomials_8h.html#a6c2091084460dee210ef8fb1da02403a">PPMT_MAX_DIM</a>,
               <span class="stringliteral">&quot;dimensionality &quot;</span> &lt;&lt; <a class="code" href="namespaceanonymous__namespace_02lowdiscrepancysequences_8cpp_03.html#a11ca759ea6330cbf0d5e7bd1eb207efa">dimensionality</a>
                   &lt;&lt; <span class="stringliteral">&quot; exceeds the number of available &quot;</span>
                   &lt;&lt; <span class="stringliteral">&quot;primitive polynomials modulo two (&quot;</span>
                   &lt;&lt; <a class="code" href="primitivepolynomials_8h.html#a6c2091084460dee210ef8fb1da02403a">PPMT_MAX_DIM</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);

        <span class="comment">// initializes coefficient array of the k-th primitive polynomial</span>
        <span class="comment">// and degree of the k-th primitive polynomial</span>
        std::vector&lt;unsigned int&gt; degree(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>);
        std::vector&lt;long&gt; ppmt(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>);

        <span class="keywordtype">bool</span> useAltPolynomials = <span class="keyword">false</span>;

        <span class="keywordflow">if</span> (directionIntegers == <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea5f4682bbab602a2be86aae2e4b7717c8">Kuo</a> || directionIntegers == <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea313b0c1cb348bf427ca25928ff0a7b52">Kuo2</a> || directionIntegers == <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea27e06eba18e90f7b454972df9c558a17">Kuo3</a>
            || directionIntegers == <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eac905d7dad337425451148623dd611852">SobolLevitan</a> || directionIntegers == <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7c05aca73695d816b1ca14c9c1a73d0a">SobolLevitanLemieux</a>)
            useAltPolynomials = <span class="keyword">true</span>;

        <span class="comment">// degree 0 is not used</span>
        ppmt[0]=0;
        degree[0]=0;
        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k, index;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currentDegree=1;
        k=1;
        index=0;

        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> altDegree = useAltPolynomials ? <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac3513a4c0175a4ca9e282a9664ea3356">maxAltDegree</a> : 0;

        <span class="keywordflow">for</span> (; k&lt;std::min&lt;Size&gt;(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>,altDegree); k++,index++)
        {
            ppmt[k] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a65058c1b87697f66ced9a65a3be0258b">AltPrimitivePolynomials</a>[currentDegree-1][index];
            <span class="keywordflow">if</span> (ppmt[k]==-1)
            {
                ++currentDegree;
                index=0;
                ppmt[k] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a65058c1b87697f66ced9a65a3be0258b">AltPrimitivePolynomials</a>[currentDegree-1][index];
            }

            degree[k] = currentDegree;
        }



        <span class="keywordflow">for</span> (; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; k++,index++)
        {
            ppmt[k] = <a class="code" href="primitivepolynomials_8c.html#a1f0cd59c5f4201126b25c7b95beeecb1">PrimitivePolynomials</a>[currentDegree-1][index];
            <span class="keywordflow">if</span> (ppmt[k]==-1)
            {
                ++currentDegree;
                index=0;
                ppmt[k] = <a class="code" href="primitivepolynomials_8c.html#a1f0cd59c5f4201126b25c7b95beeecb1">PrimitivePolynomials</a>[currentDegree-1][index];
            }
            degree[k] = currentDegree;

        }

        <span class="comment">// initializes bits_ direction integers for each dimension</span>
        <span class="comment">// and store them into directionIntegers_[dimensionality_][bits_]</span>
        <span class="comment">//</span>
        <span class="comment">// In each dimension k with its associated primitive polynomial,</span>
        <span class="comment">// the first degree_[k] direction integers can be chosen freely</span>
        <span class="comment">// provided that only the l leftmost bits can be non-zero, and</span>
        <span class="comment">// that the l-th leftmost bit must be set</span>

        <span class="comment">// degenerate (no free direction integers) first dimension</span>
        <span class="keywordtype">int</span> j;
        <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac0a67a99bbb574ba1762d94852f9dd57">bits_</a>; j++)
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[0][j] = (1UL&lt;&lt;(bits_-j-1));


        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> maxTabulated = 0;
        <span class="comment">// dimensions from 2 (k=1) to maxTabulated (k=maxTabulated-1) included</span>
        <span class="comment">// are initialized from tabulated coefficients</span>
        <span class="keywordflow">switch</span> (directionIntegers) {
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7062e2e83a0101c29f22f093d607d73d">Unit</a>:
                maxTabulated=<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>;
                <span class="keywordflow">for</span> (k=1; k&lt;maxTabulated; k++) {
                    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> l=1; l&lt;=degree[k]; l++) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-1] = 1UL;
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-1] &lt;&lt;= (bits_-l);
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea19ee2700505c6baba904334441ed3f3a">Jaeckel</a>:
                <span class="comment">// maxTabulated=32</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a20fe9277ea65ac5ec414e393935d82e0">initializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a20fe9277ea65ac5ec414e393935d82e0">initializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a20fe9277ea65ac5ec414e393935d82e0">initializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eac905d7dad337425451148623dd611852">SobolLevitan</a>:
                <span class="comment">// maxTabulated=40</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac8f107dfe0d77a0e558c35a5677f6907">SLinitializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac8f107dfe0d77a0e558c35a5677f6907">SLinitializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac8f107dfe0d77a0e558c35a5677f6907">SLinitializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea7c05aca73695d816b1ca14c9c1a73d0a">SobolLevitanLemieux</a>:
                <span class="comment">// maxTabulated=360</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ad55765c3cdb63d849d44f10ec295fd00">Linitializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ad55765c3cdb63d849d44f10ec295fd00">Linitializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ad55765c3cdb63d849d44f10ec295fd00">Linitializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea291be55f0d4a4e76723d0576192e140e">JoeKuoD5</a>:
                <span class="comment">// maxTabulated=1898</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a121e49d5cf4bdc286cb0ce1ee309d930">JoeKuoD5initializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a121e49d5cf4bdc286cb0ce1ee309d930">JoeKuoD5initializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a121e49d5cf4bdc286cb0ce1ee309d930">JoeKuoD5initializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea3e87f4b80a2255b2182b754a3f8090f7">JoeKuoD6</a>:
                <span class="comment">// maxTabulated=1799</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac747d9ecd0e51c3d8393f9572aeb7544">JoeKuoD6initializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac747d9ecd0e51c3d8393f9572aeb7544">JoeKuoD6initializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ac747d9ecd0e51c3d8393f9572aeb7544">JoeKuoD6initializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198eae537726fb0cc93018c3c24715c34103f">JoeKuoD7</a>:
                <span class="comment">// maxTabulated=1898</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ab5d5c0ff659d52a84db23d83904c31b4">JoeKuoD7initializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ab5d5c0ff659d52a84db23d83904c31b4">JoeKuoD7initializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#ab5d5c0ff659d52a84db23d83904c31b4">JoeKuoD7initializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;



            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea5f4682bbab602a2be86aae2e4b7717c8">Kuo</a>:
                <span class="comment">// maxTabulated=4925</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#aab1420c505ea2fdf326022f1c309a7c9">Kuoinitializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#aab1420c505ea2fdf326022f1c309a7c9">Kuoinitializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#aab1420c505ea2fdf326022f1c309a7c9">Kuoinitializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea313b0c1cb348bf427ca25928ff0a7b52">Kuo2</a>:
                <span class="comment">// maxTabulated=3946</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#abb5624d53b11ebadc521440e4ca8abba">Kuo2initializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#abb5624d53b11ebadc521440e4ca8abba">Kuo2initializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#abb5624d53b11ebadc521440e4ca8abba">Kuo2initializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;

            <span class="keywordflow">case</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a8f49db623f15993ffd3c00abf9fe198ea27e06eba18e90f7b454972df9c558a17">Kuo3</a>:
                <span class="comment">// maxTabulated=4585</span>
                maxTabulated = <span class="keyword">sizeof</span>(<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a62b2f55e4b4aa766c1071c7f73c74a00">Kuo3initializers</a>)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *)+1;
                <span class="keywordflow">for</span> (k=1; k&lt;std::min(dimensionality_, maxTabulated); k++) {
                    j = 0;
                    <span class="comment">// 0UL marks coefficients&#39; end for a given dimension</span>
                    <span class="keywordflow">while</span> (<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a62b2f55e4b4aa766c1071c7f73c74a00">Kuo3initializers</a>[k-1][j] != 0UL) {
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] = <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02sobolrsg_8cpp_03.html#a62b2f55e4b4aa766c1071c7f73c74a00">Kuo3initializers</a>[k-1][j];
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j] &lt;&lt;= (bits_-j-1);
                        j++;
                    }
                }
                <span class="keywordflow">break</span>;

            <span class="keywordflow">default</span>:
                <span class="keywordflow">break</span>;
        }

        <span class="comment">// random initialization for higher dimensions</span>
        <span class="keywordflow">if</span> (dimensionality_&gt;maxTabulated) {
            MersenneTwisterUniformRng uniformRng(seed);
            <span class="keywordflow">for</span> (k=maxTabulated; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; k++) {
                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> l=1; l&lt;=degree[k]; l++) {
                    <span class="keywordflow">do</span> {
                        <span class="comment">// u is in (0,1)</span>
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> u = uniformRng.next().value;
                        <span class="comment">// the direction integer has at most the</span>
                        <span class="comment">// rightmost l bits non-zero</span>
                        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-1] =
                            (<span class="keywordtype">unsigned</span> long)(u*(1UL&lt;&lt;l));
                    } <span class="keywordflow">while</span> (!(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-1] &amp; 1UL));
                    <span class="comment">// iterate until the direction integer is odd</span>
                    <span class="comment">// that is it has the rightmost bit set</span>

                    <span class="comment">// shifting bits_-l bits to the left</span>
                    <span class="comment">// we are guaranteed that the l-th leftmost bit</span>
                    <span class="comment">// is set, and only the first l leftmost bit</span>
                    <span class="comment">// can be non-zero</span>
                    <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-1] &lt;&lt;= (bits_-l);
                }
            }
        }

        <span class="comment">// computation of directionIntegers_[k][l] for l&gt;=degree_[k]</span>
        <span class="comment">// by recurrence relation</span>
        <span class="keywordflow">for</span> (k=1; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; k++) {
            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gk = degree[k];
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=gk; l&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac0a67a99bbb574ba1762d94852f9dd57">bits_</a>; l++) {
                <span class="comment">// eq. 8.19 &quot;Monte Carlo Methods in Finance&quot; by P. Jäckel</span>
                <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n = (<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-gk]&gt;&gt;gk);
                <span class="comment">// a[k][j] are the coefficients of the monomials in ppmt[k]</span>
                <span class="comment">// The highest order coefficient a[k][0] is not actually</span>
                <span class="comment">// used in the recurrence relation, and the lowest order</span>
                <span class="comment">// coefficient a[k][gk] is always set: this is the reason</span>
                <span class="comment">// why the highest and lowest coefficient of</span>
                <span class="comment">// the polynomial ppmt[k] are not included in its encoding,</span>
                <span class="comment">// provided that its degree is known.</span>
                <span class="comment">// That is: a[k][j] = ppmt[k] &gt;&gt; (gk-j-1)</span>
                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=1; j&lt;gk; j++) {
                    <span class="comment">// XORed with a selection of (unshifted) direction</span>
                    <span class="comment">// integers controlled by which of the a[k][j] are set</span>
                    <span class="keywordflow">if</span> ((ppmt[k] &gt;&gt; (gk-j-1)) &amp; 1UL)
                        n ^= <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-j];
                }
                <span class="comment">// a[k][gk] is always set, so directionIntegers_[k][l-gk]</span>
                <span class="comment">// will always enter</span>
                n ^= <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l-gk];
                <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][l]=n;
            }
        }

        <span class="comment">// in case one needs to check the directionIntegers used</span>
        <span class="comment">/* bool printDirectionIntegers = false;</span>
<span class="comment">           if (printDirectionIntegers) {</span>
<span class="comment">               std::ofstream outStream(&quot;directionIntegers.txt&quot;);</span>
<span class="comment">               for (k=0; k&lt;std::min(32UL,dimensionality_); k++) {</span>
<span class="comment">                   outStream &lt;&lt; std::endl &lt;&lt; k+1       &lt;&lt; &quot;\t&quot;</span>
<span class="comment">                                          &lt;&lt; degree[k] &lt;&lt; &quot;\t&quot;</span>
<span class="comment">                                          &lt;&lt; ppmt[k]   &lt;&lt; &quot;\t&quot;;</span>
<span class="comment">                   for (j=0; j&lt;10; j++) {</span>
<span class="comment">                       outStream &lt;&lt; io::power_of_two(</span>
<span class="comment">                           directionIntegers_[k][j]) &lt;&lt; &quot;\t&quot;;</span>
<span class="comment">                   }</span>
<span class="comment">               }</span>
<span class="comment">               outStream.close();</span>
<span class="comment">           }</span>
<span class="comment">        */</span>

        <span class="comment">// initialize the Sobol integer/double vectors</span>
        <span class="comment">// first draw</span>
        <span class="keywordflow">for</span> (k=0; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; k++) {
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>[k]=<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][0];
        }
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab8408639f89583293d48990ebba339f9"></a><!-- doxytag: member="QuantLib::SobolRsg::dimension" ref="ab8408639f89583293d48990ebba339f9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ab8408639f89583293d48990ebba339f9">QuantLib::SobolRsg::dimension</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00128">128</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>References <a class="el" href="sobolrsg_8hpp_source.html#l00132">dimensionality_</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a029e6036db427b65b2668f8fa9950036"></a><!-- doxytag: member="QuantLib::SobolRsg::lastSequence" ref="a029e6036db427b65b2668f8fa9950036" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">sample_type</a>&amp; <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a029e6036db427b65b2668f8fa9950036">QuantLib::SobolRsg::lastSequence</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00127">127</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>References <a class="el" href="sobolrsg_8hpp_source.html#l00135">sequence_</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ad7d8aa0d8dd78a57d2cdfb63f07040cc">sequence_</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="ad599608efe6fa8b4a66292fc0ac394f6"></a><!-- doxytag: member="QuantLib::SobolRsg::nextInt32Sequence" ref="ad599608efe6fa8b4a66292fc0ac394f6" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; unsigned long &gt; &amp; <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ad599608efe6fa8b4a66292fc0ac394f6">QuantLib::SobolRsg::nextInt32Sequence</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8cpp_source.html#l40032">40032</a> of file <a class="el" href="sobolrsg_8cpp_source.html">sobolrsg.cpp</a>.</p>

<p>References <a class="el" href="sobolrsg_8hpp_source.html#l00132">dimensionality_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00137">directionIntegers_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00134">firstDraw_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00136">integerSequence_</a>, <a class="el" href="errors_8hpp_source.html#l00086">QL_REQUIRE</a>, and <a class="el" href="sobolrsg_8hpp_source.html#l00133">sequenceCounter_</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8hpp_source.html#l00120">nextSequence()</a>, and <a class="el" href="lowdiscrepancysequences_8cpp_source.html#l01048">LowDiscrepancyTest::testSobolSkipping()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a634729475f839566d0c7e5bfc909c5b5">firstDraw_</a>) {
            <span class="comment">// it was precomputed in the constructor</span>
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a634729475f839566d0c7e5bfc909c5b5">firstDraw_</a> = <span class="keyword">false</span>;
            <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>;
        }
        <span class="comment">// increment the counter</span>
        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">sequenceCounter_</a>++;
        <span class="comment">// did we overflow?</span>
     <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">sequenceCounter_</a> != 0, <span class="stringliteral">&quot;period exceeded&quot;</span>);

        <span class="comment">// instead of using the counter n as new unique generating integer</span>
        <span class="comment">// for the n-th draw use the Gray code G(n) as proposed</span>
        <span class="comment">// by Antonov and Saleev</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n = <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">sequenceCounter_</a>;
        <span class="comment">// Find rightmost zero bit of n</span>
        <span class="keywordtype">int</span> j = 0;
        <span class="keywordflow">while</span> (n &amp; 1) { n &gt;&gt;= 1; j++; }
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; k++) {
            <span class="comment">// XOR the appropriate direction number into each component of</span>
            <span class="comment">// the integer sequence to obtain a new Sobol integer for that</span>
            <span class="comment">// component</span>
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>[k] ^= <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][j];
        }
        <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a6243fb058bb4ac51549778c455a6ed2a"></a><!-- doxytag: member="QuantLib::SobolRsg::nextSequence" ref="a6243fb058bb4ac51549778c455a6ed2a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">SobolRsg::sample_type</a>&amp; <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a6243fb058bb4ac51549778c455a6ed2a">QuantLib::SobolRsg::nextSequence</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00120">120</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>References <a class="el" href="sobolrsg_8hpp_source.html#l00132">dimensionality_</a>, <a class="el" href="sobolrsg_8cpp_source.html#l40032">nextInt32Sequence()</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00131">normalizationFactor_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00135">sequence_</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00433">anonymous_namespace{perturbativebarrieroptionengine.cpp}::v()</a>, and <a class="el" href="sample_8hpp_source.html#l00039">QuantLib::Sample&lt; T &gt;::value</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l00789">InterpolationTest::testMultiSpline()</a>, <a class="el" href="riskstats_8cpp_source.html#l00035">RiskStatisticsTest::testResults()</a>, and <a class="el" href="lowdiscrepancysequences_8cpp_source.html#l00177">LowDiscrepancyTest::testSobol()</a>.</p>
<div class="fragment"><pre class="fragment">                                                        {
            <span class="keyword">const</span> std::vector&lt;unsigned long&gt;&amp; <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a> = <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ad599608efe6fa8b4a66292fc0ac394f6">nextInt32Sequence</a>();
            <span class="comment">// normalize to get a double in (0,1)</span>
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; ++k)
                <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ad7d8aa0d8dd78a57d2cdfb63f07040cc">sequence_</a>.<a class="code" href="struct_quant_lib_1_1_sample.html#af7763ce40744e61b1139c4ee85425bb4">value</a>[k] = v[k] * <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a374bb09fd8d54735e56ede5f79ecb356">normalizationFactor_</a>;
            <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ad7d8aa0d8dd78a57d2cdfb63f07040cc">sequence_</a>;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a085f759d23f6141706115cfff9b5f440"></a><!-- doxytag: member="QuantLib::SobolRsg::skipTo" ref="a085f759d23f6141706115cfff9b5f440" args="(unsigned long n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a085f759d23f6141706115cfff9b5f440">QuantLib::SobolRsg::skipTo</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>skip to the n-th sample in the low-discrepancy sequence </p>

<p>Definition at line <a class="el" href="sobolrsg_8cpp_source.html#l40013">40013</a> of file <a class="el" href="sobolrsg_8cpp_source.html">sobolrsg.cpp</a>.</p>

<p>References <a class="el" href="sobolrsg_8hpp_source.html#l00132">dimensionality_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00137">directionIntegers_</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00136">integerSequence_</a>, <a class="el" href="mathconstants_8hpp_source.html#l00042">M_LN2</a>, <a class="el" href="matrices_8cpp_source.html#l00037">anonymous_namespace{matrices.cpp}::N</a>, and <a class="el" href="sobolrsg_8hpp_source.html#l00133">sequenceCounter_</a>.</p>

<p>Referenced by <a class="el" href="lowdiscrepancysequences_8cpp_source.html#l01048">LowDiscrepancyTest::testSobolSkipping()</a>.</p>
<div class="fragment"><pre class="fragment">                                            {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a> = skip+1;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ops = (<span class="keywordtype">unsigned</span> int)(std::log((<span class="keywordtype">double</span>)N)/<a class="code" href="mathconstants_8hpp.html#a92428112a5d24721208748774a4f23e6">M_LN2</a>)+1;

        <span class="comment">// Convert to Gray code</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> G = N ^ (N&gt;&gt;1);
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k&lt;<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">dimensionality_</a>; k++) {
            <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>[k] = 0;
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> index=0; index&lt;ops; index++) {
                <span class="keywordflow">if</span> (G&gt;&gt;index &amp; 1)
                    <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">integerSequence_</a>[k] ^= <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">directionIntegers_</a>[k][index];
            }
        }

        <a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">sequenceCounter_</a> = skip;
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ac0a67a99bbb574ba1762d94852f9dd57"></a><!-- doxytag: member="QuantLib::SobolRsg::bits_" ref="ac0a67a99bbb574ba1762d94852f9dd57" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ac0a67a99bbb574ba1762d94852f9dd57">QuantLib::SobolRsg::bits_</a> = 8*sizeof(unsigned long)<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00130">130</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8cpp_source.html#l39718">SobolRsg()</a>.</p>

</div>
</div>
<a class="anchor" id="abe1cbef49aa096c3fc503303c3dcc85c"></a><!-- doxytag: member="QuantLib::SobolRsg::dimensionality_" ref="abe1cbef49aa096c3fc503303c3dcc85c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#abe1cbef49aa096c3fc503303c3dcc85c">QuantLib::SobolRsg::dimensionality_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00132">132</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8hpp_source.html#l00128">dimension()</a>, <a class="el" href="sobolrsg_8cpp_source.html#l40032">nextInt32Sequence()</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00120">nextSequence()</a>, <a class="el" href="sobolrsg_8cpp_source.html#l40013">skipTo()</a>, and <a class="el" href="sobolrsg_8cpp_source.html#l39718">SobolRsg()</a>.</p>

</div>
</div>
<a class="anchor" id="a72a954373884f6e0c39dd5a32ba3a8ea"></a><!-- doxytag: member="QuantLib::SobolRsg::directionIntegers_" ref="a72a954373884f6e0c39dd5a32ba3a8ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;unsigned long&gt; &gt; <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a72a954373884f6e0c39dd5a32ba3a8ea">QuantLib::SobolRsg::directionIntegers_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00137">137</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8cpp_source.html#l40032">nextInt32Sequence()</a>, <a class="el" href="sobolrsg_8cpp_source.html#l40013">skipTo()</a>, and <a class="el" href="sobolrsg_8cpp_source.html#l39718">SobolRsg()</a>.</p>

</div>
</div>
<a class="anchor" id="a634729475f839566d0c7e5bfc909c5b5"></a><!-- doxytag: member="QuantLib::SobolRsg::firstDraw_" ref="a634729475f839566d0c7e5bfc909c5b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a634729475f839566d0c7e5bfc909c5b5">QuantLib::SobolRsg::firstDraw_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00134">134</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8cpp_source.html#l40032">nextInt32Sequence()</a>.</p>

</div>
</div>
<a class="anchor" id="a89427e6193e783cd0fe0c902365c8a92"></a><!-- doxytag: member="QuantLib::SobolRsg::integerSequence_" ref="a89427e6193e783cd0fe0c902365c8a92" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned long&gt; <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a89427e6193e783cd0fe0c902365c8a92">QuantLib::SobolRsg::integerSequence_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00136">136</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8cpp_source.html#l40032">nextInt32Sequence()</a>, <a class="el" href="sobolrsg_8cpp_source.html#l40013">skipTo()</a>, and <a class="el" href="sobolrsg_8cpp_source.html#l39718">SobolRsg()</a>.</p>

</div>
</div>
<a class="anchor" id="a374bb09fd8d54735e56ede5f79ecb356"></a><!-- doxytag: member="QuantLib::SobolRsg::normalizationFactor_" ref="a374bb09fd8d54735e56ede5f79ecb356" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#a374bb09fd8d54735e56ede5f79ecb356">QuantLib::SobolRsg::normalizationFactor_</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment">
        0.5/(1UL&lt;&lt;(<a class="code" href="class_quant_lib_1_1_sobol_rsg.html#ac0a67a99bbb574ba1762d94852f9dd57">SobolRsg::bits_</a>-1))
</pre></div>
<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00131">131</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8hpp_source.html#l00120">nextSequence()</a>.</p>

</div>
</div>
<a class="anchor" id="ad7d8aa0d8dd78a57d2cdfb63f07040cc"></a><!-- doxytag: member="QuantLib::SobolRsg::sequence_" ref="ad7d8aa0d8dd78a57d2cdfb63f07040cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html#aeb1f097c92ea0ee29444cdf737679831">sample_type</a> <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ad7d8aa0d8dd78a57d2cdfb63f07040cc">QuantLib::SobolRsg::sequence_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00135">135</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8hpp_source.html#l00127">lastSequence()</a>, and <a class="el" href="sobolrsg_8hpp_source.html#l00120">nextSequence()</a>.</p>

</div>
</div>
<a class="anchor" id="ac60ea31c1a96904fc6a37897b0d86170"></a><!-- doxytag: member="QuantLib::SobolRsg::sequenceCounter_" ref="ac60ea31c1a96904fc6a37897b0d86170" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="class_quant_lib_1_1_sobol_rsg.html#ac60ea31c1a96904fc6a37897b0d86170">QuantLib::SobolRsg::sequenceCounter_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sobolrsg_8hpp_source.html#l00133">133</a> of file <a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a>.</p>

<p>Referenced by <a class="el" href="sobolrsg_8cpp_source.html#l40032">nextInt32Sequence()</a>, and <a class="el" href="sobolrsg_8cpp_source.html#l40013">skipTo()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/math/randomnumbers/<a class="el" href="sobolrsg_8hpp_source.html">sobolrsg.hpp</a></li>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/math/randomnumbers/<a class="el" href="sobolrsg_8cpp_source.html">sobolrsg.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_quant_lib.html">QuantLib</a>      </li>
      <li class="navelem"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html">SobolRsg</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:10 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
