<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: InterpolationTest Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_interpolation_test.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">InterpolationTest Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="InterpolationTest" -->
<p><code>#include &lt;<a class="el" href="interpolations_8hpp_source.html">interpolations.hpp</a>&gt;</code></p>

<p><a href="class_interpolation_test-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a61868219ab1c02915ab00fb3e209d7ec">testSplineOnGenericValues</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a2a530be18a2ddbb6a4f6dffa071b32b4">testSimmetricEndConditions</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#aff832fae153b07f79558f87b86772b96">testDerivativeEndConditions</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a7cb70889ca4b5b455d590da30863e673">testNonRestrictiveHymanFilter</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a25eab2c91ae01a5dd723ae177e6cd7f0">testSplineOnRPN15AValues</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#afd2ec96078bb13c363818de7c60aa6e2">testSplineOnGaussianValues</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a814e12a6db53f803e2aaf4634a16d89a">testSplineErrorOnGaussianValues</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#ad4278fa1eca8fe42b54b47a2315c2063">testMultiSpline</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a7800038e4a5d06fc089fd088280b6a7a">testAsFunctor</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#aeba016d1234b5b09665b777ed6f31ecf">testBackwardFlat</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a51c44928cc3561a44269161445dcff72">testForwardFlat</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a3d9d4b7847a8f5296f0461e36e8f96e1">testSabrInterpolation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a25e90375c888bdae90c9ce5b55b8efac">testKernelInterpolation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#a5da136e358d44f991268efda0cbaefc0">testKernelInterpolation2D</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#aa72689e3a2b2f41b39ecb73bfb6ba4de">testBicubicDerivatives</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#ab8b915ca020da49fd9f922957c227726">testRichardsonExtrapolation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <br class="typebreak"/>
boost::unit_test_framework::test_suite *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_interpolation_test.html#aaf0931455e48ae736950dcd14f90e9cb">suite</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="interpolations_8hpp_source.html#l00030">30</a> of file <a class="el" href="interpolations_8hpp_source.html">interpolations.hpp</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aaf0931455e48ae736950dcd14f90e9cb"></a><!-- doxytag: member="InterpolationTest::suite" ref="aaf0931455e48ae736950dcd14f90e9cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_suite * <a class="el" href="class_interpolation_test.html#aaf0931455e48ae736950dcd14f90e9cb">InterpolationTest::suite</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01659">1659</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2utilities_8hpp_source.html#l00061">QUANTLIB_TEST_CASE</a>, <a class="el" href="interpolations_8cpp_source.html#l00897">testAsFunctor()</a>, <a class="el" href="interpolations_8cpp_source.html#l00942">testBackwardFlat()</a>, <a class="el" href="interpolations_8cpp_source.html#l01571">testBicubicDerivatives()</a>, <a class="el" href="interpolations_8cpp_source.html#l00601">testDerivativeEndConditions()</a>, <a class="el" href="interpolations_8cpp_source.html#l01060">testForwardFlat()</a>, <a class="el" href="interpolations_8cpp_source.html#l01331">testKernelInterpolation()</a>, <a class="el" href="interpolations_8cpp_source.html#l01453">testKernelInterpolation2D()</a>, <a class="el" href="interpolations_8cpp_source.html#l00789">testMultiSpline()</a>, <a class="el" href="interpolations_8cpp_source.html#l00726">testNonRestrictiveHymanFilter()</a>, <a class="el" href="interpolations_8cpp_source.html#l01620">testRichardsonExtrapolation()</a>, <a class="el" href="interpolations_8cpp_source.html#l01179">testSabrInterpolation()</a>, <a class="el" href="interpolations_8cpp_source.html#l00566">testSimmetricEndConditions()</a>, <a class="el" href="interpolations_8cpp_source.html#l00205">testSplineErrorOnGaussianValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l00270">testSplineOnGaussianValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l00489">testSplineOnGenericValues()</a>, and <a class="el" href="interpolations_8cpp_source.html#l00339">testSplineOnRPN15AValues()</a>.</p>

<p>Referenced by <a class="el" href="quantlibtestsuite_8cpp_source.html#l00206">init_unit_test_suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                     {
    test_suite* <a class="code" href="class_interpolation_test.html#aaf0931455e48ae736950dcd14f90e9cb">suite</a> = BOOST_TEST_SUITE(<span class="stringliteral">&quot;Interpolation tests&quot;</span>);

    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#a61868219ab1c02915ab00fb3e209d7ec">InterpolationTest::testSplineOnGenericValues</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#a2a530be18a2ddbb6a4f6dffa071b32b4">InterpolationTest::testSimmetricEndConditions</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#aff832fae153b07f79558f87b86772b96">InterpolationTest::testDerivativeEndConditions</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#a7cb70889ca4b5b455d590da30863e673">InterpolationTest::testNonRestrictiveHymanFilter</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#a25eab2c91ae01a5dd723ae177e6cd7f0">InterpolationTest::testSplineOnRPN15AValues</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#afd2ec96078bb13c363818de7c60aa6e2">InterpolationTest::testSplineOnGaussianValues</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                        &amp;<a class="code" href="class_interpolation_test.html#a814e12a6db53f803e2aaf4634a16d89a">InterpolationTest::testSplineErrorOnGaussianValues</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#ad4278fa1eca8fe42b54b47a2315c2063">InterpolationTest::testMultiSpline</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#a7800038e4a5d06fc089fd088280b6a7a">InterpolationTest::testAsFunctor</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#aeba016d1234b5b09665b777ed6f31ecf">InterpolationTest::testBackwardFlat</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#a51c44928cc3561a44269161445dcff72">InterpolationTest::testForwardFlat</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#a3d9d4b7847a8f5296f0461e36e8f96e1">InterpolationTest::testSabrInterpolation</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#a25e90375c888bdae90c9ce5b55b8efac">InterpolationTest::testKernelInterpolation</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                              &amp;<a class="code" href="class_interpolation_test.html#a5da136e358d44f991268efda0cbaefc0">InterpolationTest::testKernelInterpolation2D</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_interpolation_test.html#aa72689e3a2b2f41b39ecb73bfb6ba4de">InterpolationTest::testBicubicDerivatives</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
                            &amp;<a class="code" href="class_interpolation_test.html#ab8b915ca020da49fd9f922957c227726">InterpolationTest::testRichardsonExtrapolation</a>));

    <span class="keywordflow">return</span> <a class="code" href="class_interpolation_test.html#aaf0931455e48ae736950dcd14f90e9cb">suite</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7800038e4a5d06fc089fd088280b6a7a"></a><!-- doxytag: member="InterpolationTest::testAsFunctor" ref="a7800038e4a5d06fc089fd088280b6a7a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a7800038e4a5d06fc089fd088280b6a7a">InterpolationTest::testAsFunctor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00897">897</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00048">BEGIN</a>, <a class="el" href="extrapolation_8hpp_source.html#l00039">QuantLib::Extrapolator::enableExtrapolation()</a>, <a class="el" href="interpolations_8cpp_source.html#l00049">END</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="matrices_8cpp_source.html#l00037">anonymous_namespace{matrices.cpp}::N</a>, <a class="el" href="dataformatters_8hpp_source.html#l00116">QuantLib::io::ordinal()</a>, <a class="el" href="errors_8hpp_source.html#l00062">QL_FAIL</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00047">QL_FIXED</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00048">QL_SCIENTIFIC</a>, <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>, <a class="el" href="interpolation_8hpp_source.html#l00138">QuantLib::Interpolation::update()</a>, and <a class="el" href="kronrodintegral_8cpp_source.html#l00068">QuantLib::x2</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                      {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing use of interpolations as functors...&quot;</span>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x[] = { 0.0, 1.0, 2.0, 3.0, 4.0 };
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y[] = { 5.0, 4.0, 3.0, 2.0, 1.0 };

   <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_linear_interpolation.html" title="Linear interpolation between discrete points">LinearInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(y));
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib.html#a69d53a718e2be6b797f41f174ab1b05e">x2</a>[] = { -2.0, -1.0, 0.0, 1.0, 3.0, 4.0, 5.0, 6.0, 7.0 };
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a> = <a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(x2);
    std::vector&lt;Real&gt; y2(N);
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 1.0e-12;

    <span class="comment">// case 1: extrapolation not allowed</span>
    <span class="keywordflow">try</span> {
        std::transform(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(x2), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(x2), y2.begin(), <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>);
        <span class="keywordflow">throw</span> NotThrown();
    }
    <span class="keywordflow">catch</span> (<a class="code" href="class_quant_lib_1_1_error.html" title="Base error class.">Error</a>&amp;) {
        <span class="comment">// as expected; do nothing</span>
    }
    <span class="keywordflow">catch</span> (NotThrown&amp;) {
        <a class="code" href="errors_8hpp.html#a8efe9cb3e67c8d0585e57b4d53c5d2fe" title="throw an error (possibly with file and line information)">QL_FAIL</a>(<span class="stringliteral">&quot;failed to throw exception when trying to extrapolate&quot;</span>);
    }

    <span class="comment">// case 2: enable extrapolation</span>
    f.<a class="code" href="class_quant_lib_1_1_extrapolator.html#a5f7b5650a44d6c63095bc739470c8bfb" title="enable extrapolation in subsequent calls">enableExtrapolation</a>();
    y2 = std::vector&lt;Real&gt;(<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>);
    std::transform(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(x2), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(x2), y2.begin(), <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = 5.0-x2[i];
        <span class="keywordflow">if</span> (std::fabs(y2[i]-expected) &gt; <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a>)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to reproduce &quot;</span> &lt;&lt; <a class="code" href="group__manips.html#ga9645f8136bf2eabd3bca2955ce5be730" title="outputs naturals as 1st, 2nd, 3rd...">io::ordinal</a>(i+1) &lt;&lt; <span class="stringliteral">&quot; expected datum&quot;</span>
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; y2[i]
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(y2[i]-expected));
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aeba016d1234b5b09665b777ed6f31ecf"></a><!-- doxytag: member="InterpolationTest::testBackwardFlat" ref="aeba016d1234b5b09665b777ed6f31ecf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#aeba016d1234b5b09665b777ed6f31ecf">InterpolationTest::testBackwardFlat</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00942">942</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00048">BEGIN</a>, <a class="el" href="extrapolation_8hpp_source.html#l00039">QuantLib::Extrapolator::enableExtrapolation()</a>, <a class="el" href="interpolations_8cpp_source.html#l00049">END</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="matrices_8cpp_source.html#l00037">anonymous_namespace{matrices.cpp}::N</a>, <a class="el" href="dataformatters_8hpp_source.html#l00116">QuantLib::io::ordinal()</a>, <a class="el" href="interpolation_8hpp_source.html#l00117">QuantLib::Interpolation::primitive()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00047">QL_FIXED</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00048">QL_SCIENTIFIC</a>, <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>, and <a class="el" href="interpolation_8hpp_source.html#l00138">QuantLib::Interpolation::update()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                         {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing backward-flat interpolation...&quot;</span>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x[] = { 0.0, 1.0, 2.0, 3.0, 4.0 };
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y[] = { 5.0, 4.0, 3.0, 2.0, 1.0 };

    <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_backward_flat_interpolation.html" title="Backward-flat interpolation between discrete points.">BackwardFlatInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(y));
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a> = <a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(x);
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 1.0e-12;

    <span class="comment">// at original points</span>
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = x[i];
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y[i];
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to reproduce &quot;</span> &lt;&lt; <a class="code" href="group__manips.html#ga9645f8136bf2eabd3bca2955ce5be730" title="outputs naturals as 1st, 2nd, 3rd...">io::ordinal</a>(i+1) &lt;&lt; <span class="stringliteral">&quot; datum&quot;</span>
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

    <span class="comment">// at middle points</span>
    <span class="keywordflow">for</span> (i=0; i&lt;N-1; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = (x[i]+x[i+1])/2;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y[i+1];
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to interpolate correctly at &quot;</span> &lt;&lt; p
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

    <span class="comment">// outside the original range</span>
    f.<a class="code" href="class_quant_lib_1_1_extrapolator.html#a5f7b5650a44d6c63095bc739470c8bfb" title="enable extrapolation in subsequent calls">enableExtrapolation</a>();

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = x[0] - 0.5;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y[0];
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to extrapolate correctly at &quot;</span> &lt;&lt; p
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));

    p = x[N-1] + 0.5;
    calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
    expected = y[N-1];
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to extrapolate correctly at &quot;</span> &lt;&lt; p
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));

    <span class="comment">// primitive at original points</span>
    calculated = f.<a class="code" href="class_quant_lib_1_1_interpolation.html#aa18072903d4fef0c06e405f98318ecb9">primitive</a>(x[0]);
    expected = 0.0;
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to calculate primitive at &quot;</span> &lt;&lt; x[0]
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sum = 0.0;
    <span class="keywordflow">for</span> (i=1; i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>; i++) {
        sum += (x[i]-x[i-1])*y[i];
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = f.<a class="code" href="class_quant_lib_1_1_interpolation.html#aa18072903d4fef0c06e405f98318ecb9">primitive</a>(x[i]);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = sum;
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to calculate primitive at &quot;</span> &lt;&lt; x[i]
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

    <span class="comment">// primitive at middle points</span>
    sum = 0.0;
    <span class="keywordflow">for</span> (i=0; i&lt;N-1; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = (x[i]+x[i+1])/2;
        sum += (x[i+1]-x[i])*y[i+1]/2;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = f.<a class="code" href="class_quant_lib_1_1_interpolation.html#aa18072903d4fef0c06e405f98318ecb9">primitive</a>(p);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = sum;
        sum += (x[i+1]-x[i])*y[i+1]/2;
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a>)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to calculate primitive at &quot;</span> &lt;&lt; x[i]
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="aa72689e3a2b2f41b39ecb73bfb6ba4de"></a><!-- doxytag: member="InterpolationTest::testBicubicDerivatives" ref="aa72689e3a2b2f41b39ecb73bfb6ba4de" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#aa72689e3a2b2f41b39ecb73bfb6ba4de">InterpolationTest::testBicubicDerivatives</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01571">1571</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                               {
    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing bicubic spline derivatives...&quot;</span>);

    std::vector&lt;Real&gt; x(100), y(100);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; 100; ++i) {
        x[i] = y[i] = i/20.0;
    }

    <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(100, 100);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; 100; ++i)
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; 100; ++j)
            <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>[i][j] = y[i]/10*std::sin(x[j])+std::cos(y[i]);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol=0.005;
    <a class="code" href="class_quant_lib_1_1_bicubic_spline.html" title="bicubic-spline interpolation between discrete points">BicubicSpline</a> spline(x.begin(), x.end(), y.begin(), y.end(), <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>);

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=5; i &lt; 95; i+=10) {
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=5; j &lt; 95; j+=10) {
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> f_x  = spline.derivativeX(x[j],y[i]);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> f_xx = spline.secondDerivativeX(x[j],y[i]);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> f_y  = spline.derivativeY(x[j],y[i]);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> f_yy = spline.secondDerivativeY(x[j],y[i]);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> f_xy = spline.derivativeXY(x[j],y[i]);

            <span class="keywordflow">if</span> (std::fabs(f_x - y[i]/10*std::cos(x[j])) &gt; tol) {
                BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce f_x&quot;</span>);
            }
            <span class="keywordflow">if</span> (std::fabs(f_xx + y[i]/10*std::sin(x[j])) &gt; tol) {
                BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce f_xx&quot;</span>);
            }
            <span class="keywordflow">if</span> (std::fabs(f_y - (std::sin(x[j])/10-std::sin(y[i]))) &gt; tol) {
                BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce f_y&quot;</span>);
            }
            <span class="keywordflow">if</span> (std::fabs(f_yy + std::cos(y[i])) &gt; tol) {
                BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce f_yy&quot;</span>);
            }
            <span class="keywordflow">if</span> (std::fabs(f_xy - std::cos(x[j])/10) &gt; tol) {
                BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce f_xy&quot;</span>);
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aff832fae153b07f79558f87b86772b96"></a><!-- doxytag: member="InterpolationTest::testDerivativeEndConditions" ref="aff832fae153b07f79558f87b86772b96" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#aff832fae153b07f79558f87b86772b96">InterpolationTest::testDerivativeEndConditions</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00601">601</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00095">anonymous_namespace{interpolations.cpp}::check1stDerivativeValue()</a>, <a class="el" href="interpolations_8cpp_source.html#l00112">anonymous_namespace{interpolations.cpp}::check2ndDerivativeValue()</a>, <a class="el" href="interpolations_8cpp_source.html#l00077">anonymous_namespace{interpolations.cpp}::checkValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00135">QuantLib::CubicInterpolation::FirstDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="interpolations_8cpp_source.html#l00069">anonymous_namespace{interpolations.cpp}::parabolic()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00138">QuantLib::CubicInterpolation::SecondDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolations_8cpp_source.html#l00053">anonymous_namespace{interpolations.cpp}::xRange()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                    {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing derivative end-conditions &quot;</span>
                  <span class="stringliteral">&quot;for spline interpolation...&quot;</span>);

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n = 4;

    std::vector&lt;Real&gt; x, y;
    x = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a1e857ea0d005db629f55cc801d27848a">xRange</a>(-2.0, 2.0, n);
    y = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a2977717efa5829177304ec446ff23586">parabolic</a>(x);

    <span class="comment">// Not-a-knot spline</span>
    <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x.begin(), x.end(), y.begin(),
                         CubicInterpolation::Spline, <span class="keyword">false</span>,
                         CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                         CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], 4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -2.0);


    <span class="comment">// Clamped spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">false</span>,
                           CubicInterpolation::FirstDerivative,  4.0,
                           CubicInterpolation::FirstDerivative, -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], 4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -2.0);


    <span class="comment">// SecondDerivative spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">false</span>,
                           CubicInterpolation::SecondDerivative, -2.0,
                           CubicInterpolation::SecondDerivative, -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], 4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -2.0);

    <span class="comment">// MC Not-a-knot spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], 4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;MC Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;MC Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -2.0);


    <span class="comment">// MC Clamped spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::FirstDerivative,  4.0,
                           CubicInterpolation::FirstDerivative, -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], 4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;MC Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;MC Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -2.0);


    <span class="comment">// MC SecondDerivative spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::SecondDerivative, -2.0,
                           CubicInterpolation::SecondDerivative, -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], 4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[0], -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;MC SecondDerivative spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            x[n-1], -2.0);

}
</pre></div>
</div>
</div>
<a class="anchor" id="a51c44928cc3561a44269161445dcff72"></a><!-- doxytag: member="InterpolationTest::testForwardFlat" ref="a51c44928cc3561a44269161445dcff72" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a51c44928cc3561a44269161445dcff72">InterpolationTest::testForwardFlat</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01060">1060</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00048">BEGIN</a>, <a class="el" href="extrapolation_8hpp_source.html#l00039">QuantLib::Extrapolator::enableExtrapolation()</a>, <a class="el" href="interpolations_8cpp_source.html#l00049">END</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="matrices_8cpp_source.html#l00037">anonymous_namespace{matrices.cpp}::N</a>, <a class="el" href="dataformatters_8hpp_source.html#l00116">QuantLib::io::ordinal()</a>, <a class="el" href="interpolation_8hpp_source.html#l00117">QuantLib::Interpolation::primitive()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00047">QL_FIXED</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00048">QL_SCIENTIFIC</a>, <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>, and <a class="el" href="interpolation_8hpp_source.html#l00138">QuantLib::Interpolation::update()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                        {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing forward-flat interpolation...&quot;</span>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x[] = { 0.0, 1.0, 2.0, 3.0, 4.0 };
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y[] = { 5.0, 4.0, 3.0, 2.0, 1.0 };

    <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_forward_flat_interpolation.html" title="Forward-flat interpolation between discrete points.">ForwardFlatInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(y));
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a> = <a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(x);
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 1.0e-12;

    <span class="comment">// at original points</span>
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = x[i];
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y[i];
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to reproduce &quot;</span> &lt;&lt; <a class="code" href="group__manips.html#ga9645f8136bf2eabd3bca2955ce5be730" title="outputs naturals as 1st, 2nd, 3rd...">io::ordinal</a>(i+1) &lt;&lt; <span class="stringliteral">&quot; datum&quot;</span>
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

    <span class="comment">// at middle points</span>
    <span class="keywordflow">for</span> (i=0; i&lt;N-1; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = (x[i]+x[i+1])/2;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y[i];
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to interpolate correctly at &quot;</span> &lt;&lt; p
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

    <span class="comment">// outside the original range</span>
    f.<a class="code" href="class_quant_lib_1_1_extrapolator.html#a5f7b5650a44d6c63095bc739470c8bfb" title="enable extrapolation in subsequent calls">enableExtrapolation</a>();

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = x[0] - 0.5;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y[0];
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to extrapolate correctly at &quot;</span> &lt;&lt; p
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));

    p = x[N-1] + 0.5;
    calculated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(p);
    expected = y[N-1];
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to extrapolate correctly at &quot;</span> &lt;&lt; p
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));

    <span class="comment">// primitive at original points</span>
    calculated = f.<a class="code" href="class_quant_lib_1_1_interpolation.html#aa18072903d4fef0c06e405f98318ecb9">primitive</a>(x[0]);
    expected = 0.0;
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to calculate primitive at &quot;</span> &lt;&lt; x[0]
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sum = 0.0;
    <span class="keywordflow">for</span> (i=1; i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>; i++) {
        sum += (x[i]-x[i-1])*y[i-1];
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = f.<a class="code" href="class_quant_lib_1_1_interpolation.html#aa18072903d4fef0c06e405f98318ecb9">primitive</a>(x[i]);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = sum;
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tolerance)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to calculate primitive at &quot;</span> &lt;&lt; x[i]
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }

    <span class="comment">// primitive at middle points</span>
    sum = 0.0;
    <span class="keywordflow">for</span> (i=0; i&lt;N-1; i++) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> p = (x[i]+x[i+1])/2;
        sum += (x[i+1]-x[i])*y[i]/2;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = f.<a class="code" href="class_quant_lib_1_1_interpolation.html#aa18072903d4fef0c06e405f98318ecb9">primitive</a>(p);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = sum;
        sum += (x[i+1]-x[i])*y[i]/2;
        <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a>)
            BOOST_ERROR(
                <span class="stringliteral">&quot;failed to calculate primitive at &quot;</span> &lt;&lt; p
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a474537ac904cd54ef53b96dbb95548b0">QL_FIXED</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculated-expected));
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a25e90375c888bdae90c9ce5b55b8efac"></a><!-- doxytag: member="InterpolationTest::testKernelInterpolation" ref="a25e90375c888bdae90c9ce5b55b8efac" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a25e90375c888bdae90c9ce5b55b8efac">InterpolationTest::testKernelInterpolation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01331">1331</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00048">QL_SCIENTIFIC</a>, and <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing kernel 1D interpolation...&quot;</span>);

    std::vector&lt;Real&gt; deltaGrid(5); <span class="comment">// x-values, here delta in FX</span>
    deltaGrid[0]=0.10; deltaGrid[1]=0.25; deltaGrid[2]=0.50;
    deltaGrid[3]=0.75; deltaGrid[4]=0.90;

    std::vector&lt;Real&gt; yd1(deltaGrid.size()); <span class="comment">// test y-values 1</span>
    yd1[0]=11.275; yd1[1]=11.125; yd1[2]=11.250;
    yd1[3]=11.825; yd1[4]=12.625;

    std::vector&lt;Real&gt; yd2(deltaGrid.size()); <span class="comment">// test y-values 2</span>
    yd2[0]=16.025; yd2[1]=13.450; yd2[2]=11.350;
    yd2[3]=10.150; yd2[4]=10.075;

    std::vector&lt;Real&gt; yd3(deltaGrid.size()); <span class="comment">// test y-values 3</span>
    yd3[0]=10.3000; yd3[1]=9.6375; yd3[2]=9.2000;
    yd3[3]=9.1125; yd3[4]=9.4000;

    std::vector&lt;std::vector&lt;Real&gt; &gt; yd;
    yd.push_back(yd1);
    yd.push_back(yd2);
    yd.push_back(yd3);

    std::vector&lt;Real&gt; lambdaVec(5);
    lambdaVec[0]=0.05; lambdaVec[1]=0.50; lambdaVec[2]=0.75;
    lambdaVec[3]=1.65; lambdaVec[4]=2.55;

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 2.0e-5;

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedVal;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calcVal;

    <span class="comment">// Check that y-values at knots are exactly the feeded y-values,</span>
    <span class="comment">// irrespective of kernel parameters</span>
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i&lt;lambdaVec.size(); ++i) {
        <a class="code" href="class_quant_lib_1_1_gaussian_kernel.html" title="Gaussian kernel function.">GaussianKernel</a> myKernel(0,lambdaVec[i]);

        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j&lt;yd.size(); ++j) {

            std::vector&lt;Real&gt; currY = yd[j];
            <a class="code" href="class_quant_lib_1_1_kernel_interpolation.html" title="Kernel interpolation between discrete points.">KernelInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(deltaGrid.begin(), deltaGrid.end(),
                                  currY.begin(), myKernel);
            <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();

            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dIt=0; dIt&lt; deltaGrid.size(); ++dIt) {
                expectedVal=currY[dIt];
                calcVal=<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(deltaGrid[dIt]);

                <span class="keywordflow">if</span> (std::fabs(expectedVal-calcVal)&gt;tolerance) {

                    BOOST_ERROR(<span class="stringliteral">&quot;Kernel interpolation failed at x = &quot;</span>
                                &lt;&lt; deltaGrid[dIt]
                                &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                                &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; calcVal
                                &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expectedVal
                                &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                                &lt;&lt; std::fabs(expectedVal-calcVal));
                }
            }
        }
    }

    std::vector&lt;Real&gt; testDeltaGrid(deltaGrid.size());
    testDeltaGrid[0]=0.121; testDeltaGrid[1]=0.279; testDeltaGrid[2]=0.678;
    testDeltaGrid[3]=0.790; testDeltaGrid[4]=0.980;

    <span class="comment">// Gaussian Kernel values for testDeltaGrid with a standard</span>
    <span class="comment">// deviation of 2.05 (the value is arbitrary.)  Source: parrallel</span>
    <span class="comment">// implementation in R, no literature sources found</span>

    std::vector&lt;Real&gt; ytd1(testDeltaGrid.size());
    ytd1[0]=11.23847; ytd1[1]=11.12003; ytd1[2]=11.58932;
    ytd1[3]=11.99168; ytd1[4]=13.29650;

    std::vector&lt;Real&gt; ytd2(testDeltaGrid.size());
    ytd2[0]=15.55922; ytd2[1]=13.11088; ytd2[2]=10.41615;
    ytd2[3]=10.05153; ytd2[4]=10.50741;

    std::vector&lt;Real&gt; ytd3(testDeltaGrid.size());
    ytd3[0]= 10.17473; ytd3[1]= 9.557842; ytd3[2]= 9.09339;
    ytd3[3]= 9.149687; ytd3[4]= 9.779971;

    std::vector&lt;std::vector&lt;Real&gt; &gt; ytd;
    ytd.push_back(ytd1);
    ytd.push_back(ytd2);
    ytd.push_back(ytd3);

    <a class="code" href="class_quant_lib_1_1_gaussian_kernel.html" title="Gaussian kernel function.">GaussianKernel</a> myKernel(0,2.05);

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j&lt; ytd.size(); ++j) {
        std::vector&lt;Real&gt; currY=yd[j];
        std::vector&lt;Real&gt; currTY=ytd[j];

        <span class="comment">// Build interpolation according to original grid + y-values</span>
        <a class="code" href="class_quant_lib_1_1_kernel_interpolation.html" title="Kernel interpolation between discrete points.">KernelInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(deltaGrid.begin(), deltaGrid.end(),
                              currY.begin(), myKernel);
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();

        <span class="comment">// test values at test Grid</span>
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dIt=0; dIt&lt; testDeltaGrid.size(); ++dIt) {

            expectedVal=currTY[dIt];
            <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.enableExtrapolation();<span class="comment">// allow extrapolation</span>

            calcVal=<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(testDeltaGrid[dIt]);
            <span class="keywordflow">if</span> (std::fabs(expectedVal-calcVal)&gt;tolerance) {

                BOOST_ERROR(<span class="stringliteral">&quot;Kernel interpolation failed at x = &quot;</span>
                            &lt;&lt; deltaGrid[dIt]
                            &lt;&lt; <a class="code" href="test-suite_2utilities_8hpp.html#a8aef6dd018d8f7ff76fa37cde97e5067">QL_SCIENTIFIC</a>
                            &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; calcVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expectedVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                            &lt;&lt; std::fabs(expectedVal-calcVal));
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5da136e358d44f991268efda0cbaefc0"></a><!-- doxytag: member="InterpolationTest::testKernelInterpolation2D" ref="a5da136e358d44f991268efda0cbaefc0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a5da136e358d44f991268efda0cbaefc0">InterpolationTest::testKernelInterpolation2D</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01453">1453</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="matrix_8hpp_source.html#l00441">QuantLib::Matrix::columns()</a>, <a class="el" href="interpolations_8cpp_source.html#l00189">anonymous_namespace{interpolations.cpp}::epanechnikovKernel()</a>, <a class="el" href="matrices_8cpp_source.html#l00038">anonymous_namespace{matrices.cpp}::M1</a>, <a class="el" href="matrix_8hpp_source.html#l00437">QuantLib::Matrix::rows()</a>, and <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                 {

    <span class="comment">// No test values known from the literature.</span>
    <span class="comment">// Testing for consistency of input output data</span>
    <span class="comment">// at the nodes</span>

    <span class="keyword">using namespace </span>boost::assign;

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing kernel 2D interpolation...&quot;</span>);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> mean=0.0, var=0.18;
    <a class="code" href="class_quant_lib_1_1_gaussian_kernel.html" title="Gaussian kernel function.">GaussianKernel</a> myKernel(mean,var);

    std::vector&lt;Real&gt; xVec,yVec;
    xVec += 0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00;
    yVec += 1.0,2.0,3.5;

    <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> M(xVec.size(),yVec.size());

    M[0][0]=0.25; M[1][0]=0.24; M[2][0]=0.23; M[3][0]=0.20; M[4][0]=0.19;
    M[5][0]=0.20; M[6][0]=0.21; M[7][0]=0.22; M[8][0]=0.26; M[9][0]=0.29;

    M[0][1]=0.27; M[1][1]=0.26; M[2][1]=0.25; M[3][1]=0.22; M[4][1]=0.21;
    M[5][1]=0.22; M[6][1]=0.23; M[7][1]=0.24; M[8][1]=0.28; M[9][1]=0.31;

    M[0][2]=0.21; M[1][2]=0.22; M[2][2]=0.27; M[3][2]=0.29; M[4][2]=0.24;
    M[5][2]=0.28; M[6][2]=0.25; M[7][2]=0.22; M[8][2]=0.29; M[9][2]=0.30;

    <a class="code" href="class_quant_lib_1_1_kernel_interpolation2_d.html">KernelInterpolation2D</a> kernel2D(xVec.begin(),xVec.end(),
                                   yVec.begin(),yVec.end(),M,myKernel);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calcVal,expectedVal;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 1.0e-10;

    <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0;i&lt;M.rows();++i){
        <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0;j&lt;M.columns();++j){

            calcVal=kernel2D(xVec[i],yVec[j]);
            expectedVal=M[i][j];

            <span class="keywordflow">if</span>(std::fabs(expectedVal-calcVal)&gt;<a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a>){

                BOOST_ERROR(<span class="stringliteral">&quot;2D Kernel interpolation failed at x = &quot;</span> &lt;&lt; xVec[i]
                            &lt;&lt; <span class="stringliteral">&quot;, y = &quot;</span> &lt;&lt; yVec[j]
                            &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; calcVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expectedVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                            &lt;&lt; std::fabs(expectedVal-calcVal));
            }
        }
    }

    <span class="comment">// alternative data set</span>
    std::vector&lt;Real&gt; xVec1,yVec1;
    xVec1+=80.0,90.0,100.0,110.0;
    yVec1+=0.5,0.7,1.0,2.0,3.5,4.5,5.5,6.5;
    <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>(xVec1.size(),yVec1.size());

    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][0]=10.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][0]=12.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][0]=14.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][0]=17.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][1]=12.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][1]=15.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][1]=16.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][1]=16.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][2]=12.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][2]=13.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][2]=13.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][2]=17.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][3]=13.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][3]=15.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][3]=12.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][3]=19.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][4]=14.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][4]=16.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][4]=13.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][4]=12.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][5]=15.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][5]=17.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][5]=14.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][5]=12.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][6]=16.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][6]=13.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][6]=15.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][6]=10.20;
    <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[0][7]=14.25; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[1][7]=14.24;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[2][7]=16.23;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[3][7]=19.20;

    <span class="comment">// test with function pointer</span>
    <a class="code" href="class_quant_lib_1_1_kernel_interpolation2_d.html">KernelInterpolation2D</a> kernel2DEp(xVec1.begin(),xVec1.end(),
                                     yVec1.begin(),yVec1.end(),<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>,
                                     &amp;<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a88644b77ac67472ee809d7afe7902c00">epanechnikovKernel</a>);

    <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0;i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>.<a class="code" href="class_quant_lib_1_1_matrix.html#a1f0966fd78fd88f9c2fcd9b496666d2c">rows</a>();++i){
        <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0;j&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>.<a class="code" href="class_quant_lib_1_1_matrix.html#aa735264000c72110236e4d041ed82951">columns</a>();++j){

            calcVal=kernel2DEp(xVec1[i],yVec1[j]);
            expectedVal=<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[i][j];

            <span class="keywordflow">if</span>(std::fabs(expectedVal-calcVal)&gt;<a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a>){

                BOOST_ERROR(<span class="stringliteral">&quot;2D Epanechnkikov Kernel interpolation failed at x = &quot;</span> &lt;&lt; xVec1[i]
                            &lt;&lt; <span class="stringliteral">&quot;, y = &quot;</span> &lt;&lt; yVec1[j]
                            &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; calcVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expectedVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                            &lt;&lt; std::fabs(expectedVal-calcVal));
            }
        }
    }

    <span class="comment">// test updating mechanism by changing initial variables</span>
    xVec1.clear();yVec1.clear();

    xVec1+=60.0,95.0,105.0,135.0;
    yVec1+=12.5,13.7,15.0,19.0,26.5,27.5,29.2,36.5;

    kernel2DEp.update();

    <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0;i&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>.<a class="code" href="class_quant_lib_1_1_matrix.html#a1f0966fd78fd88f9c2fcd9b496666d2c">rows</a>();++i){
        <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0;j&lt;<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>.<a class="code" href="class_quant_lib_1_1_matrix.html#aa735264000c72110236e4d041ed82951">columns</a>();++j){

            calcVal=kernel2DEp(xVec1[i],yVec1[j]);
            expectedVal=<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#a75af7ea49ac8ea635c327efa80ea472e">M1</a>[i][j];

            <span class="keywordflow">if</span>(std::fabs(expectedVal-calcVal)&gt;<a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a>){

                BOOST_ERROR(<span class="stringliteral">&quot;2D Epanechnkikov Kernel updated interpolation failed at x = &quot;</span> &lt;&lt; xVec1[i]
                            &lt;&lt; <span class="stringliteral">&quot;, y = &quot;</span> &lt;&lt; yVec1[j]
                            &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; calcVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expectedVal
                            &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                            &lt;&lt; std::fabs(expectedVal-calcVal));
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad4278fa1eca8fe42b54b47a2315c2063"></a><!-- doxytag: member="InterpolationTest::testMultiSpline" ref="ad4278fa1eca8fe42b54b47a2315c2063" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#ad4278fa1eca8fe42b54b47a2315c2063">InterpolationTest::testMultiSpline</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00789">789</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00183">anonymous_namespace{interpolations.cpp}::multif()</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00120">QuantLib::SobolRsg::nextSequence()</a>, <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>, <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00433">anonymous_namespace{perturbativebarrieroptionengine.cpp}::v()</a>, and <a class="el" href="sample_8hpp_source.html#l00039">QuantLib::Sample&lt; T &gt;::value</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                        {
    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing N-dimensional cubic spline...&quot;</span>);

    std::vector&lt;Size&gt; dim(5);
    dim[0] = 6; dim[1] = 5; dim[2] = 5; dim[3] = 6; dim[4] = 4;

    std::vector&lt;Real&gt; args(5), offsets(5);
    offsets[0] = 1.005; offsets[1] = 14.0; offsets[2] = 33.005;
    offsets[3] = 35.025; offsets[4] = 19.025;

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> &amp;s = args[0] = offsets[0],
         &amp;<a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = args[1] = offsets[1],
         &amp;u = args[2] = offsets[2],
         &amp;<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a> = args[3] = offsets[3],
         &amp;w = args[4] = offsets[4];

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i, j, k, l, m;

    <a class="code" href="namespace_quant_lib.html#a8ac32a4652e23e52b13e33dae6085bfe">SplineGrid</a> grid(5);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> r = 0.15;

    <span class="keywordflow">for</span> (i = 0; i &lt; 5; ++i) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> temp = offsets[i];
        <span class="keywordflow">for</span> (j = 0; j &lt; dim[i]; temp += r, ++j)
            grid[i].push_back(temp);
    }

    r = 0.01;

    <a class="code" href="struct_quant_lib_1_1detail_1_1_data_table_3_01_real_01_4.html">MultiCubicSpline&lt;5&gt;::data_table</a> y5(dim);

    <span class="keywordflow">for</span> (i = 0; i &lt; dim[0]; ++i)
        <span class="keywordflow">for</span> (j = 0; j &lt; dim[1]; ++j)
            <span class="keywordflow">for</span> (k = 0; k &lt; dim[2]; ++k)
                <span class="keywordflow">for</span> (l = 0; l &lt; dim[3]; ++l)
                    <span class="keywordflow">for</span> (m = 0; m &lt; dim[4]; ++m)
                        y5[i][j][k][l][m] =
                            <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a9c8d76b6cb995c70d05652a8225d60d6">multif</a>(grid[0][i], grid[1][j], grid[2][k],
                                   grid[3][l], grid[4][m]);

    <a class="code" href="class_quant_lib_1_1_multi_cubic_spline.html" title="N-dimensional cubic spline interpolation between discrete points.">MultiCubicSpline&lt;5&gt;</a> cs(grid, y5);
    <span class="comment">/* it would fail with</span>
<span class="comment">    for (i = 0; i &lt; dim[0]; ++i)</span>
<span class="comment">        for (j = 0; j &lt; dim[1]; ++j)</span>
<span class="comment">            for (k = 0; k &lt; dim[2]; ++k)</span>
<span class="comment">                for (l = 0; l &lt; dim[3]; ++l)</span>
<span class="comment">                    for (m = 0; m &lt; dim[4]; ++m) {</span>
<span class="comment">    */</span>
    <span class="keywordflow">for</span> (i = 1; i &lt; dim[0]-1; ++i)
        <span class="keywordflow">for</span> (j = 1; j &lt; dim[1]-1; ++j)
            <span class="keywordflow">for</span> (k = 1; k &lt; dim[2]-1; ++k)
                <span class="keywordflow">for</span> (l = 1; l &lt; dim[3]-1; ++l)
                    <span class="keywordflow">for</span> (m = 1; m &lt; dim[4]-1; ++m) {
                        s = grid[0][i];
                        t = grid[1][j];
                        u = grid[2][k];
                        v = grid[3][l];
                        w = grid[4][m];
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> interpolated = cs(args);
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = y5[i][j][k][l][m];
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> error = std::fabs(interpolated-expected);
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 1e-16;
                        <span class="keywordflow">if</span> (error &gt; tolerance) {
                            BOOST_ERROR(
                                <span class="stringliteral">&quot;\n  At (&quot;</span>
                                &lt;&lt; s &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; u &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>
                                            &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot;):&quot;</span>
                                &lt;&lt; <span class="stringliteral">&quot;\n    interpolated: &quot;</span> &lt;&lt; interpolated
                                &lt;&lt; <span class="stringliteral">&quot;\n    actual value: &quot;</span> &lt;&lt; expected
                                &lt;&lt; <span class="stringliteral">&quot;\n       error: &quot;</span> &lt;&lt; error
                                &lt;&lt; <span class="stringliteral">&quot;\n    tolerance: &quot;</span> &lt;&lt; tolerance);
                        }
                    }


    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed = 42;
    <a class="code" href="class_quant_lib_1_1_sobol_rsg.html" title="Sobol low-discrepancy sequence generator.">SobolRsg</a> rsg(5, seed);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tolerance = 1.7e-4;
    <span class="comment">// actually tested up to 2^21-1=2097151 Sobol draws</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; 1023; ++i) {
        <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; next = rsg.nextSequence().value;
        s = grid[0].front() + next[0]*(grid[0].back()-grid[0].front());
        t = grid[1].front() + next[1]*(grid[1].back()-grid[1].front());
        u = grid[2].front() + next[2]*(grid[2].back()-grid[2].front());
        v = grid[3].front() + next[3]*(grid[3].back()-grid[3].front());
        w = grid[4].front() + next[4]*(grid[4].back()-grid[4].front());
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> interpolated = cs(args), expected = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a9c8d76b6cb995c70d05652a8225d60d6">multif</a>(s, t, u, v, w);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> error = std::fabs(interpolated-expected);
        <span class="keywordflow">if</span> (error &gt; tolerance) {
            BOOST_ERROR(
                <span class="stringliteral">&quot;\n  At (&quot;</span>
                &lt;&lt; s &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; u &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot;):&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n    interpolated: &quot;</span> &lt;&lt; interpolated
                &lt;&lt; <span class="stringliteral">&quot;\n    actual value: &quot;</span> &lt;&lt; expected
                &lt;&lt; <span class="stringliteral">&quot;\n    error:        &quot;</span> &lt;&lt; error
                &lt;&lt; <span class="stringliteral">&quot;\n    tolerance:    &quot;</span> &lt;&lt; tolerance);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7cb70889ca4b5b455d590da30863e673"></a><!-- doxytag: member="InterpolationTest::testNonRestrictiveHymanFilter" ref="a7cb70889ca4b5b455d590da30863e673" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a7cb70889ca4b5b455d590da30863e673">InterpolationTest::testNonRestrictiveHymanFilter</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00726">726</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00135">QuantLib::CubicInterpolation::FirstDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="interpolations_8cpp_source.html#l00069">anonymous_namespace{interpolations.cpp}::parabolic()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00138">QuantLib::CubicInterpolation::SecondDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolations_8cpp_source.html#l00053">anonymous_namespace{interpolations.cpp}::xRange()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                      {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing non-restrictive Hyman filter...&quot;</span>);

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n = 4;

    std::vector&lt;Real&gt; x, y;
    x = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a1e857ea0d005db629f55cc801d27848a">xRange</a>(-2.0, 2.0, n);
    y = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a2977717efa5829177304ec446ff23586">parabolic</a>(x);
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> zero=0.0, interpolated, expected=0.0;

    <span class="comment">// MC Not-a-knot spline</span>
    <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x.begin(), x.end(), y.begin(),
                         CubicInterpolation::Spline, <span class="keyword">true</span>,
                         CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                         CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(zero);
    <span class="keywordflow">if</span> (std::fabs(interpolated-expected)&gt;1e-15) {
        BOOST_ERROR(<span class="stringliteral">&quot;MC not-a-knot spline&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot; interpolation failed at x = &quot;</span> &lt;&lt; zero
                    &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expected
                    &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                    &lt;&lt; std::fabs(interpolated-expected));
    }


    <span class="comment">// MC Clamped spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::FirstDerivative,  4.0,
                           CubicInterpolation::FirstDerivative, -4.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(zero);
    <span class="keywordflow">if</span> (std::fabs(interpolated-expected)&gt;1e-15) {
        BOOST_ERROR(<span class="stringliteral">&quot;MC clamped spline&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot; interpolation failed at x = &quot;</span> &lt;&lt; zero
                    &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expected
                    &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                    &lt;&lt; std::fabs(interpolated-expected));
    }


    <span class="comment">// MC SecondDerivative spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::SecondDerivative, -2.0,
                           CubicInterpolation::SecondDerivative, -2.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(zero);
    <span class="keywordflow">if</span> (std::fabs(interpolated-expected)&gt;1e-15) {
        BOOST_ERROR(<span class="stringliteral">&quot;MC SecondDerivative spline&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot; interpolation failed at x = &quot;</span> &lt;&lt; zero
                    &lt;&lt; <span class="stringliteral">&quot;\n    interpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\n    expected value:     &quot;</span> &lt;&lt; expected
                    &lt;&lt; <span class="stringliteral">&quot;\n    error:              &quot;</span>
                    &lt;&lt; std::fabs(interpolated-expected));
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="ab8b915ca020da49fd9f922957c227726"></a><!-- doxytag: member="InterpolationTest::testRichardsonExtrapolation" ref="ab8b915ca020da49fd9f922957c227726" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#ab8b915ca020da49fd9f922957c227726">InterpolationTest::testRichardsonExtrapolation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01620">1620</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                    {
    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing Richardson Extrapolation...&quot;</span>);

    <span class="comment">/* example taken from</span>
<span class="comment">     * http://www.ipvs.uni-stuttgart.de/abteilungen/bv/lehre/</span>
<span class="comment">     *      lehrveranstaltungen/vorlesungen/WS0910/</span>
<span class="comment">     *      NSG_termine/dateien/Richardson.pdf</span>
<span class="comment">     */</span>

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> stepSize = 0.1;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> orderOfConvergence = 1.0;
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_richardson_extrapolation.html" title="Richardson Extrapolation.">RichardsonExtrapolation</a> extrap(<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>, stepSize, orderOfConvergence);


    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol = 0.00002;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = 2.71285;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> scalingFactor = 2.0;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = extrap(scalingFactor);

    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tol) {
        BOOST_ERROR(<span class="stringliteral">&quot;failed to reproduce Richardson extrapolation&quot;</span>);
    }

    calculated = extrap();
    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tol) {
        BOOST_ERROR(<span class="stringliteral">&quot;failed to reproduce Richardson extrapolation&quot;</span>);
    }

    expected = 2.721376;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> scalingFactor2 = 4.0;
    calculated = extrap(scalingFactor, scalingFactor2);

    <span class="keywordflow">if</span> (std::fabs(expected-calculated) &gt; tol) {
        BOOST_ERROR(<span class="stringliteral">&quot;failed to reproduce Richardson extrapolation&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3d9d4b7847a8f5296f0461e36e8f96e1"></a><!-- doxytag: member="InterpolationTest::testSabrInterpolation" ref="a3d9d4b7847a8f5296f0461e36e8f96e1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a3d9d4b7847a8f5296f0461e36e8f96e1">InterpolationTest::testSabrInterpolation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l01179">1179</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="sabr_8cpp_source.html#l00083">QuantLib::sabrVolatility()</a>, <a class="el" href="test-suite_2gaussianquadratures_8cpp_source.html#l00032">anonymous_namespace{gaussianquadratures.cpp}::tolerance</a>, <a class="el" href="interpolation_8hpp_source.html#l00138">QuantLib::Interpolation::update()</a>, and <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00135">anonymous_namespace{marketmodel.cpp}::volatilities</a>.</p>

<p>Referenced by <a class="el" href="quantlibbenchmark_8cpp_source.html#l00222">init_unit_test_suite()</a>, and <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                             {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing Sabr interpolation...&quot;</span>);

    <span class="comment">// Test SABR function against input volatilities</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02gaussianquadratures_8cpp_03.html#a0f4d3028fdc8cebd7d9c568c16754cab">tolerance</a> = 2.0e-13;
    std::vector&lt;Real&gt; strikes(31);
    std::vector&lt;Real&gt; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>(31);
    <span class="comment">// input strikes</span>
    strikes[0] = 0.03 ; strikes[1] = 0.032 ; strikes[2] = 0.034 ;
    strikes[3] = 0.036 ; strikes[4] = 0.038 ; strikes[5] = 0.04 ;
    strikes[6] = 0.042 ; strikes[7] = 0.044 ; strikes[8] = 0.046 ;
    strikes[9] = 0.048 ; strikes[10] = 0.05 ; strikes[11] = 0.052 ;
    strikes[12] = 0.054 ; strikes[13] = 0.056 ; strikes[14] = 0.058 ;
    strikes[15] = 0.06 ; strikes[16] = 0.062 ; strikes[17] = 0.064 ;
    strikes[18] = 0.066 ; strikes[19] = 0.068 ; strikes[20] = 0.07 ;
    strikes[21] = 0.072 ; strikes[22] = 0.074 ; strikes[23] = 0.076 ;
    strikes[24] = 0.078 ; strikes[25] = 0.08 ; strikes[26] = 0.082 ;
    strikes[27] = 0.084 ; strikes[28] = 0.086 ; strikes[29] = 0.088;
    strikes[30] = 0.09;
    <span class="comment">// input volatilities</span>
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[0] = 1.16725837321531 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[1] = 1.15226075991385 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[2] = 1.13829711098834 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[3] = 1.12524190877505 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[4] = 1.11299079244474 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[5] = 1.10145609357162 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[6] = 1.09056348513411 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[7] = 1.08024942745106 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[8] = 1.07045919457758 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[9] = 1.06114533019077 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[10] = 1.05226642581503 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[11] = 1.04378614411707 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[12] = 1.03567243073732 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[13] = 1.0278968727451 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[14] = 1.02043417226345 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[15] = 1.01326171139321 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[16] = 1.00635919013311 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[17] = 0.999708323124949 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[18] = 0.993292584155381 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[19] = 0.987096989695393 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[20] = 0.98110791455717 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[21] = 0.975312934134512 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[22] = 0.969700688771689 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[23] = 0.964260766651027;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[24] = 0.958983602256592 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[25] = 0.953860388001395 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[26] = 0.948882997029509 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[27] = 0.944043915545469 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[28] = 0.939336183299237 ; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[29] = 0.934753341079515 ;
    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[30] = 0.930289384251337;

    <a class="code" href="class_time.html">Time</a> expiry = 1.0;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> forward = 0.039;
    <span class="comment">// input SABR coefficients (corresponding to the vols above)</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> initialAlpha = 0.3;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> initialBeta = 0.6;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> initialNu = 0.02;
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> initialRho = 0.01;
    <span class="comment">// calculate SABR vols and compare with input vols</span>
    <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i&lt; strikes.size(); i++){
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculatedVol = <a class="code" href="namespace_quant_lib.html#ab45dc9962b122b5e3600cce6afed7a44">sabrVolatility</a>(strikes[i], forward, expiry,
                                            initialAlpha, initialBeta,
                                            initialNu, initialRho);
        <span class="keywordflow">if</span> (std::fabs(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[i]-calculatedVol) &gt; tolerance)
        BOOST_ERROR(
            <span class="stringliteral">&quot;failed to calculate Sabr function at strike &quot;</span> &lt;&lt; strikes[i]
            &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[i]
            &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculatedVol
            &lt;&lt; <span class="stringliteral">&quot;\n    error:      &quot;</span> &lt;&lt; std::fabs(calculatedVol-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>[i]));
    }

    <span class="comment">// Test SABR calibration against input parameters</span>
    <span class="comment">// Initial null guesses (uses default values)</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alphaGuess = <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>();
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> betaGuess = <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>();
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> nuGuess = <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>();
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> rhoGuess = <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>();

    <span class="keyword">const</span> <span class="keywordtype">bool</span> vegaWeighted[]= {<span class="keyword">true</span>, <span class="keyword">false</span>};
    <span class="keyword">const</span> <span class="keywordtype">bool</span> isAlphaFixed[]= {<span class="keyword">true</span>, <span class="keyword">false</span>};
    <span class="keyword">const</span> <span class="keywordtype">bool</span> isBetaFixed[]= {<span class="keyword">true</span>, <span class="keyword">false</span>};
    <span class="keyword">const</span> <span class="keywordtype">bool</span> isNuFixed[]= {<span class="keyword">true</span>, <span class="keyword">false</span>};
    <span class="keyword">const</span> <span class="keywordtype">bool</span> isRhoFixed[]= {<span class="keyword">true</span>, <span class="keyword">false</span>};

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calibrationTolerance = 5.0e-8;
    <span class="comment">// initialize optimization methods</span>
    std::vector&lt;boost::shared_ptr&lt;OptimizationMethod&gt; &gt; methods_;
    methods_.push_back( boost::shared_ptr&lt;OptimizationMethod&gt;(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_simplex.html" title="Multi-dimensional simplex class.">Simplex</a>(0.01)));
    methods_.push_back( boost::shared_ptr&lt;OptimizationMethod&gt;(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_levenberg_marquardt.html" title="Levenberg-Marquardt optimization method.">LevenbergMarquardt</a>(1e-8, 1e-8, 1e-8)));
    <span class="comment">// Initialize end criteria</span>
    boost::shared_ptr&lt;EndCriteria&gt; endCriteria(<span class="keyword">new</span>
                  <a class="code" href="class_quant_lib_1_1_end_criteria.html" title="Criteria to end optimization process:">EndCriteria</a>(100000, 100, 1e-8, 1e-8, 1e-8));
    <span class="comment">// Test looping over all possibilities</span>
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j&lt;methods_.size(); ++j) {
      <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i&lt;<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(vegaWeighted); ++i) {
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k_a=0; k_a&lt;<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(isAlphaFixed); ++k_a) {
          <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k_b=0; k_b&lt;<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(isBetaFixed); ++k_b) {
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k_n=0; k_n&lt;<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(isNuFixed); ++k_n) {
              <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k_r=0; k_r&lt;<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(isRhoFixed); ++k_r) {
                <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html" title="SABR smile interpolation between discrete volatility points.">SABRInterpolation</a> sabrInterpolation(strikes.begin(), strikes.end(),
                                                    <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a1bdbbd21f242eccd6cdf86cac0be7277">volatilities</a>.begin(), expiry, forward,
                                                    alphaGuess, betaGuess, nuGuess, rhoGuess,
                                                    isAlphaFixed[k_a], isBetaFixed[k_b],
                                                    isNuFixed[k_n], isRhoFixed[k_r],
                                                    vegaWeighted[i],
                                                    endCriteria, methods_[j]);
                sabrInterpolation.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();

                <span class="comment">// Recover SABR calibration parameters</span>
                <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;
                <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calibratedAlpha = sabrInterpolation.alpha();
                <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calibratedBeta = sabrInterpolation.beta();
                <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calibratedNu = sabrInterpolation.nu();
                <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calibratedRho = sabrInterpolation.rho();
                <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> error;

                <span class="comment">// compare results: alpha</span>
                error = std::fabs(initialAlpha-calibratedAlpha);
                <span class="keywordflow">if</span> (error &gt; calibrationTolerance) {
                    BOOST_ERROR(<span class="stringliteral">&quot;\nfailed to calibrate alpha Sabr parameter:&quot;</span> &lt;&lt;
                                <span class="stringliteral">&quot;\n    expected:        &quot;</span> &lt;&lt; initialAlpha &lt;&lt;
                                <span class="stringliteral">&quot;\n    calibrated:      &quot;</span> &lt;&lt; calibratedAlpha &lt;&lt;
                                <span class="stringliteral">&quot;\n    error:           &quot;</span> &lt;&lt; error);
                    failed = <span class="keyword">true</span>;
                }
                <span class="comment">// Beta</span>
                error = std::fabs(initialBeta-calibratedBeta);
                <span class="keywordflow">if</span> (error &gt; calibrationTolerance) {
                    BOOST_ERROR(<span class="stringliteral">&quot;\nfailed to calibrate beta Sabr parameter:&quot;</span> &lt;&lt;
                                <span class="stringliteral">&quot;\n    expected:        &quot;</span> &lt;&lt; initialBeta &lt;&lt;
                                <span class="stringliteral">&quot;\n    calibrated:      &quot;</span> &lt;&lt; calibratedBeta &lt;&lt;
                                <span class="stringliteral">&quot;\n    error:           &quot;</span> &lt;&lt; error);
                    failed = <span class="keyword">true</span>;
                }
                <span class="comment">// Nu</span>
                error = std::fabs(initialNu-calibratedNu);
                <span class="keywordflow">if</span> (error &gt; calibrationTolerance) {
                    BOOST_ERROR(<span class="stringliteral">&quot;\nfailed to calibrate nu Sabr parameter:&quot;</span> &lt;&lt;
                                <span class="stringliteral">&quot;\n    expected:        &quot;</span> &lt;&lt; initialNu &lt;&lt;
                                <span class="stringliteral">&quot;\n    calibrated:      &quot;</span> &lt;&lt; calibratedNu &lt;&lt;
                                <span class="stringliteral">&quot;\n    error:           &quot;</span> &lt;&lt; error);
                    failed = <span class="keyword">true</span>;
                }
                <span class="comment">// Rho</span>
                error = std::fabs(initialRho-calibratedRho);
                <span class="keywordflow">if</span> (error &gt; calibrationTolerance) {
                    BOOST_ERROR(<span class="stringliteral">&quot;\nfailed to calibrate rho Sabr parameter:&quot;</span> &lt;&lt;
                                <span class="stringliteral">&quot;\n    expected:        &quot;</span> &lt;&lt; initialRho &lt;&lt;
                                <span class="stringliteral">&quot;\n    calibrated:      &quot;</span> &lt;&lt; calibratedRho &lt;&lt;
                                <span class="stringliteral">&quot;\n    error:           &quot;</span> &lt;&lt; error);
                    failed = <span class="keyword">true</span>;
                }

                <span class="keywordflow">if</span> (failed)
                    BOOST_FAIL(<span class="stringliteral">&quot;\nSabr calibration failure:&quot;</span> &lt;&lt;
                               <span class="stringliteral">&quot;\n    isAlphaFixed:    &quot;</span> &lt;&lt; isAlphaFixed[k_a] &lt;&lt;
                               <span class="stringliteral">&quot;\n    isBetaFixed:     &quot;</span> &lt;&lt; isBetaFixed[k_b] &lt;&lt;
                               <span class="stringliteral">&quot;\n    isNuFixed:       &quot;</span> &lt;&lt; isNuFixed[k_n] &lt;&lt;
                               <span class="stringliteral">&quot;\n    isRhoFixed:      &quot;</span> &lt;&lt; isRhoFixed[k_r] &lt;&lt;
                               <span class="stringliteral">&quot;\n    vegaWeighted[i]: &quot;</span> &lt;&lt; vegaWeighted[i]);

              }
            }
          }
        }
      }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a530be18a2ddbb6a4f6dffa071b32b4"></a><!-- doxytag: member="InterpolationTest::testSimmetricEndConditions" ref="a2a530be18a2ddbb6a4f6dffa071b32b4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a2a530be18a2ddbb6a4f6dffa071b32b4">InterpolationTest::testSimmetricEndConditions</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00566">566</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00129">anonymous_namespace{interpolations.cpp}::checkNotAKnotCondition()</a>, <a class="el" href="pseudosqrt_8cpp_source.html#l00034">QuantLib::anonymous_namespace{pseudosqrt.cpp}::checkSymmetry()</a>, <a class="el" href="interpolations_8cpp_source.html#l00077">anonymous_namespace{interpolations.cpp}::checkValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="distributions_8cpp_source.html#l00036">anonymous_namespace{distributions.cpp}::gaussian()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolations_8cpp_source.html#l00053">anonymous_namespace{interpolations.cpp}::xRange()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                   {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing symmetry of spline interpolation &quot;</span>
                  <span class="stringliteral">&quot;end-conditions...&quot;</span>);

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n = 9;

    std::vector&lt;Real&gt; x, y;
    x = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a1e857ea0d005db629f55cc801d27848a">xRange</a>(-1.8, 1.8, n);
    y = <a class="code" href="namespaceanonymous__namespace_02distributions_8cpp_03.html#a7b78be1f2c07560ac41723eba16a8948">gaussian</a>(x);

    <span class="comment">// Not-a-knot spline</span>
    <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x.begin(), x.end(), y.begin(),
                         CubicInterpolation::Spline, <span class="keyword">false</span>,
                         CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                         CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a9d017d50d3646d700db8a8b82ce5da70">checkNotAKnotCondition</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>);
    <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02pseudosqrt_8cpp_03.html#a78ce7ea90b44a6f38436ee46a2cb3119">checkSymmetry</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>, x[0]);


    <span class="comment">// MC not-a-knot spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                x.begin(), x.end(), y.begin());
    <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02pseudosqrt_8cpp_03.html#a78ce7ea90b44a6f38436ee46a2cb3119">checkSymmetry</a>(<span class="stringliteral">&quot;MC not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>, x[0]);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a814e12a6db53f803e2aaf4634a16d89a"></a><!-- doxytag: member="InterpolationTest::testSplineErrorOnGaussianValues" ref="a814e12a6db53f803e2aaf4634a16d89a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a814e12a6db53f803e2aaf4634a16d89a">InterpolationTest::testSplineErrorOnGaussianValues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00205">205</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="distributions_8cpp_source.html#l00036">anonymous_namespace{distributions.cpp}::gaussian()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="interpolations_8cpp_source.html#l00179">anonymous_namespace{interpolations.cpp}::make_error_function()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolations_8cpp_source.html#l00053">anonymous_namespace{interpolations.cpp}::xRange()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                        {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing spline approximation on Gaussian data sets...&quot;</span>);

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> points[]                = {      5,      9,     17,     33 };

    <span class="comment">// complete spline data from the original 1983 Hyman paper</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tabulatedErrors[]     = { 3.5e-2, 2.0e-3, 4.0e-5, 1.8e-6 };
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> toleranceOnTabErr[]   = { 0.1e-2, 0.1e-3, 0.1e-5, 0.1e-6 };

    <span class="comment">// (complete) MC spline data from the original 1983 Hyman paper</span>
    <span class="comment">// NB: with the improved Hyman filter from the Dougherty, Edelman, and</span>
    <span class="comment">//     Hyman 1989 paper the n=17 nonmonotonicity is not filtered anymore</span>
    <span class="comment">//     so the error agrees with the non MC method.</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tabulatedMCErrors[]   = { 1.7e-2, 2.0e-3, 4.0e-5, 1.8e-6 };
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> toleranceOnTabMCErr[] = { 0.1e-2, 0.1e-3, 0.1e-5, 0.1e-6 };

    <a class="code" href="class_quant_lib_1_1_simpson_integral.html" title="Integral of a one-dimensional function.">SimpsonIntegral</a> integral(1e-12, 10000);
    std::vector&lt;Real&gt; x, y;

    <span class="comment">// still unexplained scale factor needed to obtain the numerical</span>
    <span class="comment">// results from the paper</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> scaleFactor = 1.9;

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i&lt;<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(points); i++) {
        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n = points[i];
        std::vector&lt;Real&gt; x = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a1e857ea0d005db629f55cc801d27848a">xRange</a>(-1.7, 1.9, n);
        std::vector&lt;Real&gt; y = <a class="code" href="namespaceanonymous__namespace_02distributions_8cpp_03.html#a7b78be1f2c07560ac41723eba16a8948">gaussian</a>(x);

        <span class="comment">// Not-a-knot</span>
        <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x.begin(), x.end(), y.begin(),
                             CubicInterpolation::Spline, <span class="keyword">false</span>,
                             CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                             CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> result = std::sqrt(integral(<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#af9cdace34b9c1784985dff435495f599">make_error_function</a>(<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>), -1.7, 1.9));
        result /= scaleFactor;
        <span class="keywordflow">if</span> (std::fabs(result-tabulatedErrors[i]) &gt; toleranceOnTabErr[i])
            BOOST_ERROR(<span class="stringliteral">&quot;Not-a-knot spline interpolation &quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;\n    sample points:      &quot;</span> &lt;&lt; n
                        &lt;&lt; <span class="stringliteral">&quot;\n    norm of difference: &quot;</span> &lt;&lt; result
                        &lt;&lt; <span class="stringliteral">&quot;\n    it should be:       &quot;</span> &lt;&lt; tabulatedErrors[i]);

        <span class="comment">// MC not-a-knot</span>
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                               CubicInterpolation::Spline, <span class="keyword">true</span>,
                               CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                               CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
        result = std::sqrt(integral(<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#af9cdace34b9c1784985dff435495f599">make_error_function</a>(<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>), -1.7, 1.9));
        result /= scaleFactor;
        <span class="keywordflow">if</span> (std::fabs(result-tabulatedMCErrors[i]) &gt; toleranceOnTabMCErr[i])
            BOOST_ERROR(<span class="stringliteral">&quot;MC Not-a-knot spline interpolation &quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;\n    sample points:      &quot;</span> &lt;&lt; n
                        &lt;&lt; <span class="stringliteral">&quot;\n    norm of difference: &quot;</span> &lt;&lt; result
                        &lt;&lt; <span class="stringliteral">&quot;\n    it should be:       &quot;</span>
                        &lt;&lt; tabulatedMCErrors[i]);
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="afd2ec96078bb13c363818de7c60aa6e2"></a><!-- doxytag: member="InterpolationTest::testSplineOnGaussianValues" ref="afd2ec96078bb13c363818de7c60aa6e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#afd2ec96078bb13c363818de7c60aa6e2">InterpolationTest::testSplineOnGaussianValues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00270">270</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00129">anonymous_namespace{interpolations.cpp}::checkNotAKnotCondition()</a>, <a class="el" href="interpolations_8cpp_source.html#l00077">anonymous_namespace{interpolations.cpp}::checkValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="distributions_8cpp_source.html#l00036">anonymous_namespace{distributions.cpp}::gaussian()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolations_8cpp_source.html#l00053">anonymous_namespace{interpolations.cpp}::xRange()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                   {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing spline interpolation on a Gaussian data set...&quot;</span>);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> interpolated, interpolated2;
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n = 5;

    std::vector&lt;Real&gt; x(n), y(n);
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x1_bad=-1.7, x2_bad=1.7;

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> start = -1.9, j=0; j&lt;2; start+=0.2, j++) {
        x = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a1e857ea0d005db629f55cc801d27848a">xRange</a>(start, start+3.6, n);
        y = <a class="code" href="namespaceanonymous__namespace_02distributions_8cpp_03.html#a7b78be1f2c07560ac41723eba16a8948">gaussian</a>(x);

        <span class="comment">// Not-a-knot spline</span>
        <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x.begin(), x.end(), y.begin(),
                             CubicInterpolation::Spline, <span class="keyword">false</span>,
                             CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                             CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                    x.begin(), x.end(), y.begin());
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a9d017d50d3646d700db8a8b82ce5da70">checkNotAKnotCondition</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>);
        <span class="comment">// bad performance</span>
        interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x1_bad);
        interpolated2= <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x2_bad);
        <span class="keywordflow">if</span> (interpolated&gt;0.0 &amp;&amp; interpolated2&gt;0.0 ) {
            BOOST_ERROR(<span class="stringliteral">&quot;Not-a-knot spline interpolation &quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;bad performance unverified&quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;\nat x = &quot;</span> &lt;&lt; x1_bad
                        &lt;&lt; <span class="stringliteral">&quot; interpolated value: &quot;</span> &lt;&lt; interpolated
                        &lt;&lt; <span class="stringliteral">&quot;\nat x = &quot;</span> &lt;&lt; x2_bad
                        &lt;&lt; <span class="stringliteral">&quot; interpolated value: &quot;</span> &lt;&lt; interpolated
                        &lt;&lt; <span class="stringliteral">&quot;\n at least one of them was expected to be &lt; 0.0&quot;</span>);
        }

        <span class="comment">// MC not-a-knot spline</span>
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(x.begin(), x.end(), y.begin(),
                               CubicInterpolation::Spline, <span class="keyword">true</span>,
                               CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                               CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
        <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                    x.begin(), x.end(), y.begin());
        <span class="comment">// good performance</span>
        interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x1_bad);
        <span class="keywordflow">if</span> (interpolated&lt;0.0) {
            BOOST_ERROR(<span class="stringliteral">&quot;MC not-a-knot spline interpolation &quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;good performance unverified\n&quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x1_bad
                        &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                        &lt;&lt; <span class="stringliteral">&quot;\nexpected value &gt; 0.0&quot;</span>);
        }
        interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x2_bad);
        <span class="keywordflow">if</span> (interpolated&lt;0.0) {
            BOOST_ERROR(<span class="stringliteral">&quot;MC not-a-knot spline interpolation &quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;good performance unverified\n&quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x2_bad
                        &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                        &lt;&lt; <span class="stringliteral">&quot;\nexpected value &gt; 0.0&quot;</span>);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a61868219ab1c02915ab00fb3e209d7ec"></a><!-- doxytag: member="InterpolationTest::testSplineOnGenericValues" ref="a61868219ab1c02915ab00fb3e209d7ec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a61868219ab1c02915ab00fb3e209d7ec">InterpolationTest::testSplineOnGenericValues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00489">489</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00048">BEGIN</a>, <a class="el" href="interpolations_8cpp_source.html#l00095">anonymous_namespace{interpolations.cpp}::check1stDerivativeValue()</a>, <a class="el" href="interpolations_8cpp_source.html#l00129">anonymous_namespace{interpolations.cpp}::checkNotAKnotCondition()</a>, <a class="el" href="interpolations_8cpp_source.html#l00077">anonymous_namespace{interpolations.cpp}::checkValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l00049">END</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00135">QuantLib::CubicInterpolation::FirstDerivative</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="interpolation_8hpp_source.html#l00125">QuantLib::Interpolation::secondDerivative()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00138">QuantLib::CubicInterpolation::SecondDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolation_8hpp_source.html#l00138">QuantLib::Interpolation::update()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                  {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing spline interpolation on generic values...&quot;</span>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> generic_x[] = { 0.0, 1.0, 3.0, 4.0 };
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> generic_y[] = { 0.0, 0.0, 2.0, 2.0 };
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> generic_natural_y2[] = { 0.0, 1.5, -1.5, 0.0 };

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> interpolated, error;
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i, n = <a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(generic_x);
    std::vector&lt;Real&gt; x35(3);

    <span class="comment">// Natural spline</span>
    <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x),
                         <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_y),
                         CubicInterpolation::Spline, <span class="keyword">false</span>,
                         CubicInterpolation::SecondDerivative,
                         generic_natural_y2[0],
                         CubicInterpolation::SecondDerivative,
                         generic_natural_y2[n-1]);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Natural spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_y));
    <span class="comment">// cached second derivative</span>
    <span class="keywordflow">for</span> (i=0; i&lt;n; i++) {
        interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.secondDerivative(generic_x[i]);
        error = interpolated - generic_natural_y2[i];
        <span class="keywordflow">if</span> (std::fabs(error)&gt;3e-16) {
            BOOST_ERROR(<span class="stringliteral">&quot;Natural spline interpolation &quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;second derivative failed at x=&quot;</span> &lt;&lt; generic_x[i]
                        &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                        &lt;&lt; <span class="stringliteral">&quot;\nexpected value:     &quot;</span> &lt;&lt; generic_natural_y2[i]
                        &lt;&lt; <span class="stringliteral">&quot;\nerror:              &quot;</span> &lt;&lt; error);
        }
    }
    x35[1] = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(3.5);


    <span class="comment">// Clamped spline</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y1a = 0.0, y1b = 0.0;
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_y),
                    CubicInterpolation::Spline, <span class="keyword">false</span>,
                    CubicInterpolation::FirstDerivative, y1a,
                    CubicInterpolation::FirstDerivative, y1b);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_y));
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            *<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), 0.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                            *(<a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x)-1), 0.0);
    x35[0] = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(3.5);


    <span class="comment">// Not-a-knot spline</span>
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_y),
                           CubicInterpolation::Spline, <span class="keyword">false</span>,
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>.update();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(generic_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(generic_y));
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a9d017d50d3646d700db8a8b82ce5da70">checkNotAKnotCondition</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>);

    x35[2] = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(3.5);

    <span class="keywordflow">if</span> (x35[0]&gt;x35[1] || x35[1]&gt;x35[2]) {
        BOOST_ERROR(<span class="stringliteral">&quot;Spline interpolation failure&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;\nat x = &quot;</span> &lt;&lt; 3.5
                    &lt;&lt; <span class="stringliteral">&quot;\nclamped spline    &quot;</span> &lt;&lt; x35[0]
                    &lt;&lt; <span class="stringliteral">&quot;\nnatural spline    &quot;</span> &lt;&lt; x35[1]
                    &lt;&lt; <span class="stringliteral">&quot;\nnot-a-knot spline &quot;</span> &lt;&lt; x35[2]
                    &lt;&lt; <span class="stringliteral">&quot;\nvalues should be in increasing order&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a25eab2c91ae01a5dd723ae177e6cd7f0"></a><!-- doxytag: member="InterpolationTest::testSplineOnRPN15AValues" ref="a25eab2c91ae01a5dd723ae177e6cd7f0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_interpolation_test.html#a25eab2c91ae01a5dd723ae177e6cd7f0">InterpolationTest::testSplineOnRPN15AValues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpolations_8cpp_source.html#l00339">339</a> of file <a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a>.</p>

<p>References <a class="el" href="interpolations_8cpp_source.html#l00048">BEGIN</a>, <a class="el" href="interpolations_8cpp_source.html#l00095">anonymous_namespace{interpolations.cpp}::check1stDerivativeValue()</a>, <a class="el" href="interpolations_8cpp_source.html#l00112">anonymous_namespace{interpolations.cpp}::check2ndDerivativeValue()</a>, <a class="el" href="interpolations_8cpp_source.html#l00129">anonymous_namespace{interpolations.cpp}::checkNotAKnotCondition()</a>, <a class="el" href="interpolations_8cpp_source.html#l00077">anonymous_namespace{interpolations.cpp}::checkValues()</a>, <a class="el" href="interpolations_8cpp_source.html#l00049">END</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00135">QuantLib::CubicInterpolation::FirstDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00132">QuantLib::CubicInterpolation::NotAKnot</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00138">QuantLib::CubicInterpolation::SecondDerivative</a>, <a class="el" href="cubicinterpolation_8hpp_source.html#l00107">QuantLib::CubicInterpolation::Spline</a>, and <a class="el" href="interpolation_8hpp_source.html#l00138">QuantLib::Interpolation::update()</a>.</p>

<p>Referenced by <a class="el" href="interpolations_8cpp_source.html#l01659">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                 {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing spline interpolation on RPN15A data set...&quot;</span>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> RPN15A_x[] = {
        7.99,       8.09,       8.19,      8.7,
        9.2,     10.0,     12.0,     15.0,     20.0
    };
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> RPN15A_y[] = {
        0.0, 2.76429e-5, 4.37498e-5, 0.169183,
        0.469428, 0.943740, 0.998636, 0.999919, 0.999994
    };

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> interpolated;

    <span class="comment">// Natural spline</span>
    <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(
                                    <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x),
                                    <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y),
                                    CubicInterpolation::Spline, <span class="keyword">false</span>,
                                    CubicInterpolation::SecondDerivative, 0.0,
                                    CubicInterpolation::SecondDerivative, 0.0);
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Natural spline&quot;</span>, f,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y));
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;Natural spline&quot;</span>, f,
                            *<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), 0.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a6e77caeeafaeefb3833335caa59b5536">check2ndDerivativeValue</a>(<span class="stringliteral">&quot;Natural spline&quot;</span>, f,
                            *(<a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x)-1), 0.0);
    <span class="comment">// poor performance</span>
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x_bad = 11.0;
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x_bad);
    <span class="keywordflow">if</span> (interpolated&lt;1.0) {
        BOOST_ERROR(<span class="stringliteral">&quot;Natural spline interpolation &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;poor performance unverified\n&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x_bad
                    &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\nexpected value &gt; 1.0&quot;</span>);
    }


    <span class="comment">// Clamped spline</span>
    f = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y),
                           CubicInterpolation::Spline, <span class="keyword">false</span>,
                           CubicInterpolation::FirstDerivative, 0.0,
                           CubicInterpolation::FirstDerivative, 0.0);
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, f,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y));
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, f,
                            *<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), 0.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;Clamped spline&quot;</span>, f,
                            *(<a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x)-1), 0.0);
    <span class="comment">// poor performance</span>
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x_bad);
    <span class="keywordflow">if</span> (interpolated&lt;1.0) {
        BOOST_ERROR(<span class="stringliteral">&quot;Clamped spline interpolation &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;poor performance unverified\n&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x_bad
                    &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\nexpected value &gt; 1.0&quot;</span>);
    }


    <span class="comment">// Not-a-knot spline</span>
    f = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y),
                           CubicInterpolation::Spline, <span class="keyword">false</span>,
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, f,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y));
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a9d017d50d3646d700db8a8b82ce5da70">checkNotAKnotCondition</a>(<span class="stringliteral">&quot;Not-a-knot spline&quot;</span>, f);
    <span class="comment">// poor performance</span>
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x_bad);
    <span class="keywordflow">if</span> (interpolated&lt;1.0) {
        BOOST_ERROR(<span class="stringliteral">&quot;Not-a-knot spline interpolation &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;poor performance unverified\n&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x_bad
                    &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\nexpected value &gt; 1.0&quot;</span>);
    }


    <span class="comment">// MC natural spline values</span>
    f = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x),
                           <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::SecondDerivative, 0.0,
                           CubicInterpolation::SecondDerivative, 0.0);
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC natural spline&quot;</span>, f,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y));
    <span class="comment">// good performance</span>
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x_bad);
    <span class="keywordflow">if</span> (interpolated&gt;1.0) {
        BOOST_ERROR(<span class="stringliteral">&quot;MC natural spline interpolation &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;good performance unverified\n&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x_bad
                    &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\nexpected value &lt; 1.0&quot;</span>);
    }


    <span class="comment">// MC clamped spline values</span>
    f = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::FirstDerivative, 0.0,
                           CubicInterpolation::FirstDerivative, 0.0);
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC clamped spline&quot;</span>, f,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y));
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC clamped spline&quot;</span>, f,
                            *<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), 0.0);
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#acbf5e6c4fb24de01ce14f752fbfc9153">check1stDerivativeValue</a>(<span class="stringliteral">&quot;MC clamped spline&quot;</span>, f,
                            *(<a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x)-1), 0.0);
    <span class="comment">// good performance</span>
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x_bad);
    <span class="keywordflow">if</span> (interpolated&gt;1.0) {
        BOOST_ERROR(<span class="stringliteral">&quot;MC clamped spline interpolation &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;good performance unverified\n&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x_bad
                    &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\nexpected value &lt; 1.0&quot;</span>);
    }


    <span class="comment">// MC not-a-knot spline values</span>
    f = <a class="code" href="class_quant_lib_1_1_cubic_interpolation.html" title="Cubic interpolation between discrete points.">CubicInterpolation</a>(<a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y),
                           CubicInterpolation::Spline, <span class="keyword">true</span>,
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(),
                           CubicInterpolation::NotAKnot, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>());
    f.<a class="code" href="class_quant_lib_1_1_interpolation.html#a56cfc87cb5966ee36d72e5ffc7b1ff5c">update</a>();
    <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#aa63f01cf5fe996780806ad3e5ca62d21">checkValues</a>(<span class="stringliteral">&quot;MC not-a-knot spline&quot;</span>, f,
                <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a1d956e978fc8ee422f26c7638760a698">END</a>(RPN15A_x), <a class="code" href="interpolations_8cpp.html#a3aeaa7742fafba1057dac3154b5a487a">BEGIN</a>(RPN15A_y));
    <span class="comment">// good performance</span>
    interpolated = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(x_bad);
    <span class="keywordflow">if</span> (interpolated&gt;1.0) {
        BOOST_ERROR(<span class="stringliteral">&quot;MC clamped spline interpolation &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;good performance unverified\n&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;at x = &quot;</span> &lt;&lt; x_bad
                    &lt;&lt; <span class="stringliteral">&quot;\ninterpolated value: &quot;</span> &lt;&lt; interpolated
                    &lt;&lt; <span class="stringliteral">&quot;\nexpected value &lt; 1.0&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/test-suite/<a class="el" href="interpolations_8hpp_source.html">interpolations.hpp</a></li>
<li>/home/deriversatile/QuantLib/QuantLibQt/test-suite/<a class="el" href="interpolations_8cpp_source.html">interpolations.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_interpolation_test.html">InterpolationTest</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:01 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
