<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: /home/deriversatile/QuantLib/QuantLibQt/ql/experimental/math/zigguratrng.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('zigguratrng_8cpp.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">zigguratrng.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="zigguratrng_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment"> Copyright (C) 2010 Kakhkhor Abdijalilov</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment"> This file is part of QuantLib, a free-software/open-source library</span>
<a name="l00007"></a>00007 <span class="comment"> for financial quantitative analysts and developers - http://quantlib.org/</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment"> QuantLib is free software: you can redistribute it and/or modify it</span>
<a name="l00010"></a>00010 <span class="comment"> under the terms of the QuantLib license.  You should have received a</span>
<a name="l00011"></a>00011 <span class="comment"> copy of the license along with this program; if not, please email</span>
<a name="l00012"></a>00012 <span class="comment"> &lt;quantlib-dev@lists.sf.net&gt;. The license is also available online at</span>
<a name="l00013"></a>00013 <span class="comment"> &lt;http://quantlib.org/license.shtml&gt;.</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00016"></a>00016 <span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00017"></a>00017 <span class="comment"> FOR A PARTICULAR PURPOSE.  See the license for more details.</span>
<a name="l00018"></a>00018 <span class="comment">*/</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="code" href="zigguratrng_8hpp.html" title="Ziggurat random-number generator.">ql/experimental/math/zigguratrng.hpp</a>&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;<a class="code" href="normaldistribution_8hpp.html" title="normal, cumulative and inverse cumulative distributions">ql/math/distributions/normaldistribution.hpp</a>&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">namespace </span>QuantLib {
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html">00026</a>     <span class="keyword">namespace </span>{
<a name="l00027"></a>00027 
<a name="l00028"></a>00028         <span class="comment">// tail probability</span>
<a name="l00029"></a><a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a74c74f7a62fb0c655d32eb1d2a456a51">00029</a>         <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a74c74f7a62fb0c655d32eb1d2a456a51">p_</a> = 2.880541027242713E-004;
<a name="l00030"></a><a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a39cc4fa02231bc5344990424a5b174c9">00030</a>         <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a39cc4fa02231bc5344990424a5b174c9">q_</a> = 1.0 - <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a74c74f7a62fb0c655d32eb1d2a456a51">p_</a>;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032         <span class="comment">/* The tabulated values were calculated following Marsaglia</span>
<a name="l00033"></a>00033 <span class="comment">           and Tsang (2000). */</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035         <span class="comment">// values of exp(-0.5*x*x)</span>
<a name="l00036"></a><a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#afdc6e9dda1a20804c81a14ff21cdaaa8">00036</a>         <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#afdc6e9dda1a20804c81a14ff21cdaaa8">f_</a> [128] = {
<a name="l00037"></a>00037             1.000000000000000E+000, 9.635996931557717E-001,
<a name="l00038"></a>00038             9.362826817083744E-001, 9.130436479920410E-001,
<a name="l00039"></a>00039             8.922816508023054E-001, 8.732430489268560E-001,
<a name="l00040"></a>00040             8.555006078850665E-001, 8.387836053106493E-001,
<a name="l00041"></a>00041             8.229072113952640E-001, 8.077382946961230E-001,
<a name="l00042"></a>00042             7.931770117838610E-001, 7.791460859417049E-001,
<a name="l00043"></a>00043             7.655841739092376E-001, 7.524415591857053E-001,
<a name="l00044"></a>00044             7.396772436833397E-001, 7.272569183545073E-001,
<a name="l00045"></a>00045             7.151515074204785E-001, 7.033360990258188E-001,
<a name="l00046"></a>00046             6.917891434460373E-001, 6.804918410064157E-001,
<a name="l00047"></a>00047             6.694276673577075E-001, 6.585820000586550E-001,
<a name="l00048"></a>00048             6.479418211185520E-001, 6.374954773431460E-001,
<a name="l00049"></a>00049             6.272324852578157E-001, 6.171433708265636E-001,
<a name="l00050"></a>00050             6.072195366326060E-001, 5.974531509518134E-001,
<a name="l00051"></a>00051             5.878370544418217E-001, 5.783646811267034E-001,
<a name="l00052"></a>00052             5.690299910747226E-001, 5.598274127106959E-001,
<a name="l00053"></a>00053             5.507517931210564E-001, 5.417983550317252E-001,
<a name="l00054"></a>00054             5.329626593899887E-001, 5.242405726789938E-001,
<a name="l00055"></a>00055             5.156282382498731E-001, 5.071220510813057E-001,
<a name="l00056"></a>00056             4.987186354765854E-001, 4.904148252893227E-001,
<a name="l00057"></a>00057             4.822076463348397E-001, 4.740943006982505E-001,
<a name="l00058"></a>00058             4.660721526945719E-001, 4.581387162728729E-001,
<a name="l00059"></a>00059             4.502916436869279E-001, 4.425287152802475E-001,
<a name="l00060"></a>00060             4.348478302546628E-001, 4.272469983095633E-001,
<a name="l00061"></a>00061             4.197243320540391E-001, 4.122780401070255E-001,
<a name="l00062"></a>00062             4.049064208114891E-001, 3.976078564980433E-001,
<a name="l00063"></a>00063             3.903808082413902E-001, 3.832238110598844E-001,
<a name="l00064"></a>00064             3.761354695144552E-001, 3.691144536682758E-001,
<a name="l00065"></a>00065             3.621594953730338E-001, 3.552693848515477E-001,
<a name="l00066"></a>00066             3.484429675498729E-001, 3.416791412350141E-001,
<a name="l00067"></a>00067             3.349768533169716E-001, 3.283350983761528E-001,
<a name="l00068"></a>00068             3.217529158792090E-001, 3.152293880681579E-001,
<a name="l00069"></a>00069             3.087636380092523E-001, 3.023548277894802E-001,
<a name="l00070"></a>00070             2.960021568498564E-001, 2.897048604458110E-001,
<a name="l00071"></a>00071             2.834622082260129E-001, 2.772735029218981E-001,
<a name="l00072"></a>00072             2.711380791410257E-001, 2.650553022581624E-001,
<a name="l00073"></a>00073             2.590245673987112E-001, 2.530452985097663E-001,
<a name="l00074"></a>00074             2.471169475146971E-001, 2.412389935477517E-001,
<a name="l00075"></a>00075             2.354109422657280E-001, 2.296323252343031E-001,
<a name="l00076"></a>00076             2.239026993871343E-001, 2.182216465563709E-001,
<a name="l00077"></a>00077             2.125887730737364E-001, 2.070037094418741E-001,
<a name="l00078"></a>00078             2.014661100762035E-001, 1.959756531181106E-001,
<a name="l00079"></a>00079             1.905320403209139E-001, 1.851349970107136E-001,
<a name="l00080"></a>00080             1.797842721249623E-001, 1.744796383324025E-001,
<a name="l00081"></a>00081             1.692208922389250E-001, 1.640078546849280E-001,
<a name="l00082"></a>00082             1.588403711409353E-001, 1.537183122095867E-001,
<a name="l00083"></a>00083             1.486415742436971E-001, 1.436100800919331E-001,
<a name="l00084"></a>00084             1.386237799858510E-001, 1.336826525846477E-001,
<a name="l00085"></a>00085             1.287867061971040E-001, 1.239359802039816E-001,
<a name="l00086"></a>00086             1.191305467087186E-001, 1.143705124498883E-001,
<a name="l00087"></a>00087             1.096560210158178E-001, 1.049872554103546E-001,
<a name="l00088"></a>00088             1.003644410295456E-001, 9.578784912257826E-002,
<a name="l00089"></a>00089             9.125780082763474E-002, 8.677467189554304E-002,
<a name="l00090"></a>00090             8.233889824295743E-002, 7.795098251465470E-002,
<a name="l00091"></a>00091             7.361150188475492E-002, 6.932111739418027E-002,
<a name="l00092"></a>00092             6.508058521363191E-002, 6.089077034856640E-002,
<a name="l00093"></a>00093             5.675266348153862E-002, 5.266740190350321E-002,
<a name="l00094"></a>00094             4.863629586028410E-002, 4.466086220087247E-002,
<a name="l00095"></a>00095             4.074286807479065E-002, 3.688438878696881E-002,
<a name="l00096"></a>00096             3.308788614650520E-002, 2.935631744025387E-002,
<a name="l00097"></a>00097             2.569329193614964E-002, 2.210330461611161E-002,
<a name="l00098"></a>00098             1.859210273716583E-002, 1.516729801067205E-002,
<a name="l00099"></a>00099             1.183947865798232E-002, 8.624484412930473E-003,
<a name="l00100"></a>00100             5.548995220816476E-003, 2.669629083902507E-003
<a name="l00101"></a>00101         };
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         <span class="comment">// acceptance thresholds 2^24*x[i]/x[i+1]. k_[0] is special</span>
<a name="l00104"></a><a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a6ffdceb692ed665e9d5e5a6ebbd775ef">00104</a>         <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a6ffdceb692ed665e9d5e5a6ebbd775ef">k_</a>[128] = {
<a name="l00105"></a>00105             15555141,        0, 12590647, 14272656,
<a name="l00106"></a>00106             14988942, 15384587, 15635012, 15807564,
<a name="l00107"></a>00107             15933580, 16029597, 16105158, 16166150,
<a name="l00108"></a>00108             16216402, 16258511, 16294298, 16325081,
<a name="l00109"></a>00109             16351834, 16375294, 16396029, 16414482,
<a name="l00110"></a>00110             16431005, 16445883, 16459346, 16471581,
<a name="l00111"></a>00111             16482747, 16492974, 16502372, 16511034,
<a name="l00112"></a>00112             16519042, 16526462, 16533356, 16539772,
<a name="l00113"></a>00113             16545758, 16551351, 16556587, 16561496,
<a name="l00114"></a>00114             16566104, 16570437, 16574515, 16578357,
<a name="l00115"></a>00115             16581980, 16585401, 16588633, 16591688,
<a name="l00116"></a>00116             16594579, 16597314, 16599905, 16602358,
<a name="l00117"></a>00117             16604682, 16606885, 16608972, 16610949,
<a name="l00118"></a>00118             16612822, 16614597, 16616276, 16617865,
<a name="l00119"></a>00119             16619367, 16620786, 16622125, 16623387,
<a name="l00120"></a>00120             16624575, 16625690, 16626735, 16627713,
<a name="l00121"></a>00121             16628624, 16629470, 16630253, 16630974,
<a name="l00122"></a>00122             16631634, 16632233, 16632773, 16633254,
<a name="l00123"></a>00123             16633677, 16634041, 16634346, 16634593,
<a name="l00124"></a>00124             16634781, 16634910, 16634979, 16634987,
<a name="l00125"></a>00125             16634934, 16634817, 16634637, 16634390,
<a name="l00126"></a>00126             16634075, 16633689, 16633231, 16632698,
<a name="l00127"></a>00127             16632085, 16631390, 16630609, 16629737,
<a name="l00128"></a>00128             16628768, 16627698, 16626520, 16625226,
<a name="l00129"></a>00129             16623808, 16622257, 16620563, 16618714,
<a name="l00130"></a>00130             16616696, 16614494, 16612091, 16609465,
<a name="l00131"></a>00131             16606593, 16603449, 16599999, 16596206,
<a name="l00132"></a>00132             16592025, 16587402, 16582273, 16576559,
<a name="l00133"></a>00133             16570163, 16562965, 16554812, 16545511,
<a name="l00134"></a>00134             16534809, 16522368, 16507733, 16490265,
<a name="l00135"></a>00135             16469045, 16442690, 16409026, 16364394,
<a name="l00136"></a>00136             16302111, 16208408, 16049219, 15707338
<a name="l00137"></a>00137         };
<a name="l00138"></a>00138 
<a name="l00139"></a>00139         <span class="comment">// values of 2^{-24}*x[i]. w_[0] is special.</span>
<a name="l00140"></a><a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a88ecd2c3ab92b7de8d2711b0d62753ab">00140</a>         <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a88ecd2c3ab92b7de8d2711b0d62753ab">w_</a>[128] = {
<a name="l00141"></a>00141             2.213171867573477E-007, 1.623158840564778E-008,
<a name="l00142"></a>00142             2.162882274558596E-008, 2.542424120326624E-008,
<a name="l00143"></a>00143             2.845751269184242E-008, 3.103351823837397E-008,
<a name="l00144"></a>00144             3.330064883086164E-008, 3.534334554922425E-008,
<a name="l00145"></a>00145             3.721467240506913E-008, 3.895036212891571E-008,
<a name="l00146"></a>00146             4.057573787247544E-008, 4.210946627340346E-008,
<a name="l00147"></a>00147             4.356574479471913E-008, 4.495565083232566E-008,
<a name="l00148"></a>00148             4.628801273561392E-008, 4.756999377168848E-008,
<a name="l00149"></a>00149             4.880749623079987E-008, 5.000544871575862E-008,
<a name="l00150"></a>00150             5.116801519263080E-008, 5.229875022755345E-008,
<a name="l00151"></a>00151             5.340071633852936E-008, 5.447657412343023E-008,
<a name="l00152"></a>00152             5.552865246542405E-008, 5.655900391923845E-008,
<a name="l00153"></a>00153             5.756944891143612E-008, 5.856161138431779E-008,
<a name="l00154"></a>00154             5.953694781545649E-008, 6.049677105184184E-008,
<a name="l00155"></a>00155             6.144227004387700E-008, 6.237452630714050E-008,
<a name="l00156"></a>00156             6.329452775023089E-008, 6.420318036567782E-008,
<a name="l00157"></a>00157             6.510131817439508E-008, 6.598971173307500E-008,
<a name="l00158"></a>00158             6.686907545162751E-008, 6.774007391947947E-008,
<a name="l00159"></a>00159             6.860332740181531E-008, 6.945941663712532E-008,
<a name="l00160"></a>00160             7.030888704386109E-008, 7.115225242518010E-008,
<a name="l00161"></a>00161             7.198999824564194E-008, 7.282258454149729E-008,
<a name="l00162"></a>00162             7.365044851627824E-008, 7.447400686528278E-008,
<a name="l00163"></a>00163             7.529365786588351E-008, 7.610978326509584E-008,
<a name="l00164"></a>00164             7.692274999129007E-008, 7.773291171314836E-008,
<a name="l00165"></a>00165             7.854061026581177E-008, 7.934617696152180E-008,
<a name="l00166"></a>00166             8.014993379984568E-008, 8.095219459071287E-008,
<a name="l00167"></a>00167             8.175326600192373E-008, 8.255344854147119E-008,
<a name="l00168"></a>00168             8.335303748390705E-008, 8.415232374905104E-008,
<a name="l00169"></a>00169             8.495159474056128E-008, 8.575113515123489E-008,
<a name="l00170"></a>00170             8.655122774137352E-008, 8.735215409611426E-008,
<a name="l00171"></a>00171             8.815419536728245E-008, 8.895763300505963E-008,
<a name="l00172"></a>00172             8.976274948457178E-008, 9.056982903238356E-008,
<a name="l00173"></a>00173             9.137915835783214E-008, 9.219102739414587E-008,
<a name="l00174"></a>00174             9.300573005436895E-008, 9.382356500725440E-008,
<a name="l00175"></a>00175             9.464483647849558E-008, 9.546985508294559E-008,
<a name="l00176"></a>00176             9.629893869382930E-008, 9.713241335539087E-008,
<a name="l00177"></a>00177             9.797061424595009E-008, 9.881388669897357E-008,
<a name="l00178"></a>00178             9.966258729051657E-008, 1.005170850022725E-007,
<a name="l00179"></a>00179             1.013777624705017E-007, 1.022450173323223E-007,
<a name="l00180"></a>00180             1.031192636822607E-007, 1.040009336536155E-007,
<a name="l00181"></a>00181             1.048904791411299E-007, 1.057883736837368E-007,
<a name="l00182"></a>00182             1.066951145288121E-007, 1.076112249025135E-007,
<a name="l00183"></a>00183             1.085372565144899E-007, 1.094737923296323E-007,
<a name="l00184"></a>00184             1.104214496447496E-007, 1.113808835142578E-007,
<a name="l00185"></a>00185             1.123527905763905E-007, 1.133379133403490E-007,
<a name="l00186"></a>00186             1.143370450055439E-007, 1.153510348970830E-007,
<a name="l00187"></a>00187             1.163807946174674E-007, 1.174273050337859E-007,
<a name="l00188"></a>00188             1.184916242434419E-007, 1.195748966907839E-007,
<a name="l00189"></a>00189             1.206783636434635E-007, 1.218033752829236E-007,
<a name="l00190"></a>00190             1.229514047207811E-007, 1.241240643255547E-007,
<a name="l00191"></a>00191             1.253231248369812E-007, 1.265505378645533E-007,
<a name="l00192"></a>00192             1.278084625218070E-007, 1.290992971506620E-007,
<a name="l00193"></a>00193             1.304257173581136E-007, 1.317907219454484E-007,
<a name="l00194"></a>00194             1.331976887933646E-007, 1.346504434266883E-007,
<a name="l00195"></a>00195             1.361533438964878E-007, 1.377113869008423E-007,
<a name="l00196"></a>00196             1.393303418955523E-007, 1.410169225999109E-007,
<a name="l00197"></a>00197             1.427790092234294E-007, 1.446259406525023E-007,
<a name="l00198"></a>00198             1.465689049606532E-007, 1.486214710528821E-007,
<a name="l00199"></a>00199             1.508003278008381E-007, 1.531263366890930E-007,
<a name="l00200"></a>00200             1.556260733859904E-007, 1.583341605221148E-007,
<a name="l00201"></a>00201             1.612969382476045E-007, 1.645785196056458E-007,
<a name="l00202"></a>00202             1.682713836756925E-007, 1.725163463961286E-007,
<a name="l00203"></a>00203             1.775441320326934E-007, 1.837747608550914E-007,
<a name="l00204"></a>00204             1.921108355867039E-007, 2.051961336074264E-007
<a name="l00205"></a>00205         };
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#a40b17909c0d0f22f55533db772671496">00209</a>     <a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#a40b17909c0d0f22f55533db772671496">ZigguratRng::ZigguratRng</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed)
<a name="l00210"></a>00210     : mt32_(seed) {}
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#ad09314c76424038be76fa3644f310199">00212</a>     <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#ad09314c76424038be76fa3644f310199">ZigguratRng::nextGaussian</a>()<span class="keyword"> const </span>{
<a name="l00213"></a>00213         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>[2] = {-1, 1};
<a name="l00214"></a>00214         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i, j;
<a name="l00215"></a>00215         <span class="keywordtype">int</span> <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>;
<a name="l00216"></a>00216         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="keywordflow">do</span> {
<a name="l00219"></a>00219             j = <a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#ae462c48ae1409f073df4ee4861ffb114">mt32_</a>.<a class="code" href="class_quant_lib_1_1_mersenne_twister_uniform_rng.html#a00af67fc87705cd011b0c9b98e1d04ae" title="return a random integer in the [0,0xffffffff]-interval">nextInt32</a>(); <span class="comment">// generate 32 bits of randomness</span>
<a name="l00220"></a>00220             f = j &amp; 1; <span class="comment">// 1 bit to choose a tails</span>
<a name="l00221"></a>00221             j &gt;&gt;= 1;
<a name="l00222"></a>00222             i = j &amp; 0x7f; <span class="comment">// 7 bits to choose a strip</span>
<a name="l00223"></a>00223             j &gt;&gt;= 7; <span class="comment">// the last 24 bits for accepttion/rejection</span>
<a name="l00224"></a>00224             x = (c[<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>]*<span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(j))*<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a88ecd2c3ab92b7de8d2711b0d62753ab">w_</a>[i]; <span class="comment">// x is uniform</span>
<a name="l00225"></a>00225                                                    <span class="comment">// within the i-th strip</span>
<a name="l00226"></a>00226             <span class="keywordflow">if</span> (j &lt; <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a6ffdceb692ed665e9d5e5a6ebbd775ef">k_</a>[i]) <span class="comment">// if true, accept x</span>
<a name="l00227"></a>00227                 <span class="keywordflow">break</span>;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229             <span class="comment">// handle rejections</span>
<a name="l00230"></a>00230             <span class="keywordflow">if</span> (i!=0) { <span class="comment">// upper strips</span>
<a name="l00231"></a>00231                 <span class="keywordflow">if</span> ((<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#afdc6e9dda1a20804c81a14ff21cdaaa8">f_</a>[i-1]-<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#afdc6e9dda1a20804c81a14ff21cdaaa8">f_</a>[i])*<a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#ae462c48ae1409f073df4ee4861ffb114">mt32_</a>.<a class="code" href="class_quant_lib_1_1_mersenne_twister_uniform_rng.html#a2284445cd16a0ec75996854db05b8a56" title="return a random number in the (0.0, 1.0)-interval">nextReal</a>() + <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#afdc6e9dda1a20804c81a14ff21cdaaa8">f_</a>[i] &lt; exp(-0.5*x*x))
<a name="l00232"></a>00232                     <span class="keywordflow">break</span>;
<a name="l00233"></a>00233             } <span class="keywordflow">else</span> { <span class="comment">// base strip, sample from the tail</span>
<a name="l00234"></a>00234                 x = c[<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>]*<a class="code" href="class_quant_lib_1_1_inverse_cumulative_normal.html#a33237133c66f2eabd8d8cfa79b846717">InverseCumulativeNormal::standard_value</a>(
<a name="l00235"></a>00235                                                       <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a74c74f7a62fb0c655d32eb1d2a456a51">p_</a>*<a class="code" href="class_quant_lib_1_1_ziggurat_rng.html#ae462c48ae1409f073df4ee4861ffb114">mt32_</a>.<a class="code" href="class_quant_lib_1_1_mersenne_twister_uniform_rng.html#a2284445cd16a0ec75996854db05b8a56" title="return a random number in the (0.0, 1.0)-interval">nextReal</a>()+<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02zigguratrng_8cpp_03.html#a39cc4fa02231bc5344990424a5b174c9">q_</a>);
<a name="l00236"></a>00236                 <span class="keywordflow">break</span>;
<a name="l00237"></a>00237             }
<a name="l00238"></a>00238         } <span class="keywordflow">while</span> (<span class="keyword">true</span>);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         <span class="keywordflow">return</span> x;
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="zigguratrng_8cpp.html">zigguratrng.cpp</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:50:43 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
