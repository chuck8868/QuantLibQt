<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: QuantLib::SymmetricSchurDecomposition Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_quant_lib_1_1_symmetric_schur_decomposition.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">QuantLib::SymmetricSchurDecomposition Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="QuantLib::SymmetricSchurDecomposition" -->
<p>symmetric threshold Jacobi algorithm.  
 <a href="class_quant_lib_1_1_symmetric_schur_decomposition.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for QuantLib::SymmetricSchurDecomposition:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_lib_1_1_symmetric_schur_decomposition__coll__graph.png" border="0" usemap="#_quant_lib_1_1_symmetric_schur_decomposition_coll__map" alt="Collaboration graph"/></div>
<map name="_quant_lib_1_1_symmetric_schur_decomposition_coll__map" id="_quant_lib_1_1_symmetric_schur_decomposition_coll__map">
<area shape="rect" id="node2" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra." alt="" coords="5,286,187,1429"/><area shape="rect" id="node8" href="class_quant_lib_1_1_array.html" title="1&#45;D array used in linear algebra." alt="" coords="211,173,323,1541"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_quant_lib_1_1_symmetric_schur_decomposition-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a82516228a1888e11fee4f8de65e8cca7">SymmetricSchurDecomposition</a> (const <a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_quant_lib_1_1_array.html">Array</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a3b727aa28129d098059cfde6b911a4ab">eigenvalues</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a26c9ba9a7130355cf5afd52ce47d570f">eigenvectors</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a6fc2d510e8727549922204d0e1e247a9">jacobiRotate_</a> (<a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;m, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> rot, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> dil, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> j1, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> k1, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> j2, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> k2) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This routines implements the Jacobi, a.k.a. Givens, rotation.  <a href="#a6fc2d510e8727549922204d0e1e247a9"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_quant_lib_1_1_array.html">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>symmetric threshold Jacobi algorithm. </p>
<p>Given a real symmetric matrix <a class="el" href="class_s.html">S</a>, the Schur decomposition finds the eigenvalues and eigenvectors of <a class="el" href="class_s.html">S</a>. If D is the diagonal matrix formed by the eigenvalues and U the unitarian matrix of the eigenvectors we can write the Schur decomposition as </p>
<p class="formulaDsp">
\[ S = U \cdot D \cdot U^T \, ,\]
</p>
<p> where \( \cdot \) is the standard matrix product and \( ^T \) is the transpose operator. This class implements the Schur decomposition using the symmetric threshold Jacobi algorithm. For details on the different Jacobi transfomations see "Matrix computation," second edition, by Golub and Van Loan, The Johns Hopkins University Press</p>
<dl class="test"><dt><b><a class="el" href="test.html#_test000049">Test:</a></b></dt><dd>the correctness of the returned values is tested by checking their properties. </dd></dl>

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00050">50</a> of file <a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a82516228a1888e11fee4f8de65e8cca7"></a><!-- doxytag: member="QuantLib::SymmetricSchurDecomposition::SymmetricSchurDecomposition" ref="a82516228a1888e11fee4f8de65e8cca7" args="(const Matrix &amp;s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a82516228a1888e11fee4f8de65e8cca7">QuantLib::SymmetricSchurDecomposition::SymmetricSchurDecomposition</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="pre"><dt><b>Precondition:</b></dt><dd>s must be symmetric </dd></dl>

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8cpp_source.html#l00026">26</a> of file <a class="el" href="symmetricschurdecomposition_8cpp_source.html">symmetricschurdecomposition.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::b</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00429">QuantLib::Array::begin()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00138">anonymous_namespace{marketmodel.cpp}::beta</a>, <a class="el" href="matrix_8hpp_source.html#l00352">QuantLib::Matrix::column_begin()</a>, <a class="el" href="matrix_8hpp_source.html#l00371">QuantLib::Matrix::column_end()</a>, <a class="el" href="matrix_8hpp_source.html#l00441">QuantLib::Matrix::columns()</a>, <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00057">diagonal_</a>, <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00058">eigenVectors_</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00437">QuantLib::Array::end()</a>, <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00067">jacobiRotate_()</a>, <a class="el" href="errors_8hpp_source.html#l00098">QL_ENSURE</a>, <a class="el" href="errors_8hpp_source.html#l00086">QL_REQUIRE</a>, <a class="el" href="matrix_8hpp_source.html#l00437">QuantLib::Matrix::rows()</a>, and <a class="el" href="ql_2cashflows_2cashflows_8cpp_source.html#l00537">QuantLib::anonymous_namespace{cashflows.cpp}::sign()</a>.</p>
<div class="fragment"><pre class="fragment">    : <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>(s.rows()), <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>(s.rows(), s.columns(), 0.0) {

        <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(s.rows() &gt; 0 &amp;&amp; s.columns() &gt; 0, <span class="stringliteral">&quot;null matrix given&quot;</span>);
        <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(s.rows()==s.columns(), <span class="stringliteral">&quot;input matrix must be square&quot;</span>);

        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> size = s.rows();
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> q=0; q&lt;size; q++) {
            <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>[q] = s[q][q];
            <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>[q][q] = 1.0;
        }
        Matrix ss = s;

        std::vector&lt;Real&gt; tmpDiag(<a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>.<a class="code" href="class_quant_lib_1_1_array.html#a9574cfad318a9c5de4ba0011b6fbe525">begin</a>(), <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>.<a class="code" href="class_quant_lib_1_1_array.html#a204a3642b2ce04c6f919cba2158b4af6">end</a>());
        std::vector&lt;Real&gt; tmpAccumulate(size, 0.0);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> threshold, epsPrec = 1e-15;
        <span class="keywordtype">bool</span> keeplooping = <span class="keyword">true</span>;
        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> maxIterations = 100, ite = 1;
        <span class="keywordflow">do</span> {
            <span class="comment">//main loop</span>
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sum = 0;
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>=0; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>&lt;size-1; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>++) {
                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+1; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>&lt;size; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>++) {
                    sum += std::fabs(ss[<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>][<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>]);
                }
            }

            <span class="keywordflow">if</span> (sum==0) {
                keeplooping = <span class="keyword">false</span>;
            } <span class="keywordflow">else</span> {
                <span class="comment">/* To speed up computation a threshold is introduced to</span>
<span class="comment">                   make sure it is worthy to perform the Jacobi rotation</span>
<span class="comment">                */</span>
                <span class="keywordflow">if</span> (ite&lt;5) threshold = 0.2*sum/(size*size);
                <span class="keywordflow">else</span>       threshold = 0.0;

                <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j, k, l;
                <span class="keywordflow">for</span> (j=0; j&lt;size-1; j++) {
                    <span class="keywordflow">for</span> (k=j+1; k&lt;size; k++) {
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sine, rho, cosin, heig, tang, <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a75f63a468538f062319982a22c52c2c4">beta</a>;
                        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> smll = std::fabs(ss[j][k]);
                        <span class="keywordflow">if</span>(ite&gt; 5 &amp;&amp;
                           smll&lt;epsPrec*std::fabs(<a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>[j]) &amp;&amp;
                           smll&lt;epsPrec*std::fabs(<a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>[k])) {
                                ss[j][k] = 0;
                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::fabs(ss[j][k])&gt;threshold) {
                            heig = <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>[k]-<a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>[j];
                            <span class="keywordflow">if</span> (smll&lt;epsPrec*std::fabs(heig)) {
                                tang = ss[j][k]/heig;
                            } <span class="keywordflow">else</span> {
                                beta = 0.5*heig/ss[j][k];
                                tang = 1.0/(std::fabs(beta)+
                                    std::sqrt(1+beta*beta));
                                <span class="keywordflow">if</span> (beta&lt;0)
                                    tang = -tang;
                            }
                            cosin = 1/std::sqrt(1+tang*tang);
                            sine = tang*cosin;
                            rho = sine/(1+cosin);
                            heig = tang*ss[j][k];
                            tmpAccumulate[j] -= heig;
                            tmpAccumulate[k] += heig;
                            diagonal_[j] -= heig;
                            diagonal_[k] += heig;
                            ss[j][k] = 0.0;
                            <span class="keywordflow">for</span> (l=0; l+1&lt;=j; l++)
                                <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a6fc2d510e8727549922204d0e1e247a9" title="This routines implements the Jacobi, a.k.a. Givens, rotation.">jacobiRotate_</a>(ss, rho, sine, l, j, l, k);
                            <span class="keywordflow">for</span> (l=j+1; l&lt;=k-1; l++)
                                <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a6fc2d510e8727549922204d0e1e247a9" title="This routines implements the Jacobi, a.k.a. Givens, rotation.">jacobiRotate_</a>(ss, rho, sine, j, l, l, k);
                            <span class="keywordflow">for</span> (l=k+1; l&lt;size; l++)
                                <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a6fc2d510e8727549922204d0e1e247a9" title="This routines implements the Jacobi, a.k.a. Givens, rotation.">jacobiRotate_</a>(ss, rho, sine, j, l, k, l);
                            <span class="keywordflow">for</span> (l=0;   l&lt;size; l++)
                                <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a6fc2d510e8727549922204d0e1e247a9" title="This routines implements the Jacobi, a.k.a. Givens, rotation.">jacobiRotate_</a>(<a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>,
                                                  rho, sine, l, j, l, k);
                        }
                    }
                }
                <span class="keywordflow">for</span> (k=0; k&lt;size; k++) {
                    tmpDiag[k] += tmpAccumulate[k];
                    diagonal_[k] = tmpDiag[k];
                    tmpAccumulate[k] = 0.0;
                }
            }
        } <span class="keywordflow">while</span> (++ite&lt;=maxIterations &amp;&amp; keeplooping);

        <a class="code" href="errors_8hpp.html#a394b39aa396098345f86d243f207f7af" title="throw an error if the given post-condition is not verified">QL_ENSURE</a>(ite&lt;=maxIterations,
                  <span class="stringliteral">&quot;Too many iterations (&quot;</span> &lt;&lt; maxIterations &lt;&lt; <span class="stringliteral">&quot;) reached&quot;</span>);


        <span class="comment">// sort (eigenvalues, eigenvectors)</span>
        std::vector&lt;std::pair&lt;Real, std::vector&lt;Real&gt; &gt; &gt; temp(size);
        std::vector&lt;Real&gt; eigenVector(size);
        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> row, col;
        <span class="keywordflow">for</span> (col=0; col&lt;size; col++) {
            std::copy(<a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>.<a class="code" href="class_quant_lib_1_1_matrix.html#aeedf4622d7bce3b71ea3feaa3365facd">column_begin</a>(col),
                      <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>.<a class="code" href="class_quant_lib_1_1_matrix.html#aab8c2fdd1a9aa369ad499daf34a4d1a7">column_end</a>(col), eigenVector.begin());
            temp[col] = std::pair&lt;Real, std::vector&lt;Real&gt; &gt;(
                diagonal_[col], eigenVector);
        }
        std::sort(temp.begin(), temp.end(),
            std::greater&lt;std::pair&lt;Real, std::vector&lt;Real&gt; &gt; &gt;());
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> maxEv = temp[0].first;
        <span class="keywordflow">for</span> (col=0; col&lt;size; col++) {
            <span class="comment">// check for round-off errors</span>
            diagonal_[col] =
                (std::fabs(temp[col].first/maxEv)&lt;1e-16 ? 0.0 :
                                                          temp[col].first);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02cashflows_8cpp_03.html#a1866624bb48c72f44e299cf523c6da74">sign</a> = 1.0;
            <span class="keywordflow">if</span> (temp[col].second[0]&lt;0.0)
                sign = -1.0;
            <span class="keywordflow">for</span> (row=0; row&lt;size; row++) {
                <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>[row][col] = sign * temp[col].second[row];
            }
        }
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a3b727aa28129d098059cfde6b911a4ab"></a><!-- doxytag: member="QuantLib::SymmetricSchurDecomposition::eigenvalues" ref="a3b727aa28129d098059cfde6b911a4ab" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_quant_lib_1_1_array.html">Array</a>&amp; <a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a3b727aa28129d098059cfde6b911a4ab">QuantLib::SymmetricSchurDecomposition::eigenvalues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00054">54</a> of file <a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>.</p>

<p>References <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00057">diagonal_</a>.</p>

<p>Referenced by <a class="el" href="factorreduction_8cpp_source.html#l00027">QuantLib::factorReduction()</a>, <a class="el" href="pseudosqrt_8cpp_source.html#l00295">QuantLib::anonymous_namespace{pseudosqrt.cpp}::projectToPositiveSemidefiniteMatrix()</a>, <a class="el" href="pseudosqrt_8cpp_source.html#l00433">QuantLib::rankReducedSqrt()</a>, and <a class="el" href="matrices_8cpp_source.html#l00101">MatricesTest::testEigenvectors()</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">diagonal_</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a26c9ba9a7130355cf5afd52ce47d570f"></a><!-- doxytag: member="QuantLib::SymmetricSchurDecomposition::eigenvectors" ref="a26c9ba9a7130355cf5afd52ce47d570f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a>&amp; <a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a26c9ba9a7130355cf5afd52ce47d570f">QuantLib::SymmetricSchurDecomposition::eigenvectors</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00055">55</a> of file <a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>.</p>

<p>References <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00058">eigenVectors_</a>.</p>

<p>Referenced by <a class="el" href="pseudosqrt_8cpp_source.html#l00295">QuantLib::anonymous_namespace{pseudosqrt.cpp}::projectToPositiveSemidefiniteMatrix()</a>, <a class="el" href="pseudosqrt_8cpp_source.html#l00433">QuantLib::rankReducedSqrt()</a>, and <a class="el" href="matrices_8cpp_source.html#l00101">MatricesTest::testEigenvectors()</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">eigenVectors_</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a6fc2d510e8727549922204d0e1e247a9"></a><!-- doxytag: member="QuantLib::SymmetricSchurDecomposition::jacobiRotate_" ref="a6fc2d510e8727549922204d0e1e247a9" args="(Matrix &amp;m, Real rot, Real dil, Size j1, Size k1, Size j2, Size k2) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a6fc2d510e8727549922204d0e1e247a9">QuantLib::SymmetricSchurDecomposition::jacobiRotate_</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>j1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>k1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>j2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>k2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This routines implements the Jacobi, a.k.a. Givens, rotation. </p>

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00067">67</a> of file <a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>.</p>

<p>References <a class="el" href="kronrodintegral_8cpp_source.html#l00050">QuantLib::x1</a>, and <a class="el" href="kronrodintegral_8cpp_source.html#l00068">QuantLib::x2</a>.</p>

<p>Referenced by <a class="el" href="symmetricschurdecomposition_8cpp_source.html#l00026">SymmetricSchurDecomposition()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                       {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespace_quant_lib.html#ac5497abeb868c17a2880edf81c8bec12">x1</a>, <a class="code" href="namespace_quant_lib.html#a69d53a718e2be6b797f41f174ab1b05e">x2</a>;
        x1 = m[j1][k1];
        x2 = m[j2][k2];
        m[j1][k1] = x1 - dil*(x2 + x1*rot);
        m[j2][k2] = x2 + dil*(x1 - x2*rot);
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a172aea7089d878272224c46f50a05197"></a><!-- doxytag: member="QuantLib::SymmetricSchurDecomposition::diagonal_" ref="a172aea7089d878272224c46f50a05197" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_array.html">Array</a> <a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#a172aea7089d878272224c46f50a05197">QuantLib::SymmetricSchurDecomposition::diagonal_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00057">57</a> of file <a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>.</p>

<p>Referenced by <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00054">eigenvalues()</a>, and <a class="el" href="symmetricschurdecomposition_8cpp_source.html#l00026">SymmetricSchurDecomposition()</a>.</p>

</div>
</div>
<a class="anchor" id="ad7a867557c25fb96186544468b2e4574"></a><!-- doxytag: member="QuantLib::SymmetricSchurDecomposition::eigenVectors_" ref="ad7a867557c25fb96186544468b2e4574" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> <a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html#ad7a867557c25fb96186544468b2e4574">QuantLib::SymmetricSchurDecomposition::eigenVectors_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00058">58</a> of file <a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a>.</p>

<p>Referenced by <a class="el" href="symmetricschurdecomposition_8hpp_source.html#l00055">eigenvectors()</a>, and <a class="el" href="symmetricschurdecomposition_8cpp_source.html#l00026">SymmetricSchurDecomposition()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/math/matrixutilities/<a class="el" href="symmetricschurdecomposition_8hpp_source.html">symmetricschurdecomposition.hpp</a></li>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/math/matrixutilities/<a class="el" href="symmetricschurdecomposition_8cpp_source.html">symmetricschurdecomposition.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_quant_lib.html">QuantLib</a>      </li>
      <li class="navelem"><a class="el" href="class_quant_lib_1_1_symmetric_schur_decomposition.html">SymmetricSchurDecomposition</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:09 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
