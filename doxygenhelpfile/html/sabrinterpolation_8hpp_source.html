<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: /home/deriversatile/QuantLib/QuantLibQt/ql/math/interpolations/sabrinterpolation.hpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('sabrinterpolation_8hpp.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">sabrinterpolation.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="sabrinterpolation_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment"> Copyright (C) 2006 Ferdinando Ametrano</span>
<a name="l00005"></a>00005 <span class="comment"> Copyright (C) 2007 Marco Bianchetti</span>
<a name="l00006"></a>00006 <span class="comment"> Copyright (C) 2007 François du Vignaud</span>
<a name="l00007"></a>00007 <span class="comment"> Copyright (C) 2007 Giorgio Facchinetti</span>
<a name="l00008"></a>00008 <span class="comment"> Copyright (C) 2006 Mario Pucci</span>
<a name="l00009"></a>00009 <span class="comment"> Copyright (C) 2006 StatPro Italia srl</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment"> This file is part of QuantLib, a free-software/open-source library</span>
<a name="l00012"></a>00012 <span class="comment"> for financial quantitative analysts and developers - http://quantlib.org/</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment"> QuantLib is free software: you can redistribute it and/or modify it</span>
<a name="l00015"></a>00015 <span class="comment"> under the terms of the QuantLib license.  You should have received a</span>
<a name="l00016"></a>00016 <span class="comment"> copy of the license along with this program; if not, please email</span>
<a name="l00017"></a>00017 <span class="comment"> &lt;quantlib-dev@lists.sf.net&gt;. The license is also available online at</span>
<a name="l00018"></a>00018 <span class="comment"> &lt;http://quantlib.org/license.shtml&gt;.</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00021"></a>00021 <span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00022"></a>00022 <span class="comment"> FOR A PARTICULAR PURPOSE.  See the license for more details.</span>
<a name="l00023"></a>00023 <span class="comment">*/</span>
<a name="l00024"></a>00024 
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef quantlib_sabr_interpolation_hpp</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define quantlib_sabr_interpolation_hpp</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="interpolation_8hpp.html" title="base class for 1-D interpolations">ql/math/interpolation.hpp</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="method_8hpp.html" title="Abstract optimization method class.">ql/math/optimization/method.hpp</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="simplex_8hpp.html" title="Simplex optimization method.">ql/math/optimization/simplex.hpp</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="levenbergmarquardt_8hpp.html" title="Levenberg-Marquardt optimization method.">ql/math/optimization/levenbergmarquardt.hpp</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="blackformula_8hpp.html" title="Black formula.">ql/pricingengines/blackformula.hpp</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="null_8hpp.html" title="null values">ql/utilities/null.hpp</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="dataformatters_8hpp.html" title="output manipulators">ql/utilities/dataformatters.hpp</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="sabr_8hpp.html" title="SABR functions.">ql/termstructures/volatility/sabr.hpp</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="projectedcostfunction_8hpp.html" title="Cost function utility.">ql/math/optimization/projectedcostfunction.hpp</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="constraint_8hpp.html" title="Abstract constraint class.">ql/math/optimization/constraint.hpp</a>&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="keyword">namespace </span>QuantLib {
<a name="l00044"></a>00044 
<a name="l00045"></a>00045     <span class="keyword">namespace </span>detail {
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html">00047</a>         <span class="keyword">class </span><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html">SABRCoeffHolder</a> {
<a name="l00048"></a>00048           <span class="keyword">public</span>:
<a name="l00049"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae9ff0a2c569f360a5aca3094a8e01109">00049</a>             <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae9ff0a2c569f360a5aca3094a8e01109">SABRCoeffHolder</a>(<a class="code" href="namespace_quant_lib.html#a4f78b18a4dd1a979eb78b4e1e8ac1503" title="continuous quantity with 1-year units">Time</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>,
<a name="l00050"></a>00050                             <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&amp; forward,
<a name="l00051"></a>00051                             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alpha,
<a name="l00052"></a>00052                             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a75f63a468538f062319982a22c52c2c4">beta</a>,
<a name="l00053"></a>00053                             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> nu,
<a name="l00054"></a>00054                             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> rho,
<a name="l00055"></a>00055                             <span class="keywordtype">bool</span> alphaIsFixed,
<a name="l00056"></a>00056                             <span class="keywordtype">bool</span> betaIsFixed,
<a name="l00057"></a>00057                             <span class="keywordtype">bool</span> nuIsFixed,
<a name="l00058"></a>00058                             <span class="keywordtype">bool</span> rhoIsFixed)
<a name="l00059"></a>00059             : <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3e2a07b69a5c304cae35801590ec7852">t_</a>(t), <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae13514008e8ffffd36b5b932197acd41">forward_</a>(forward),
<a name="l00060"></a>00060               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a>(alpha), <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>(beta), <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>(nu), <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>(rho),
<a name="l00061"></a>00061               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad726ecf3f555dbab0ba7a408644f2a89">alphaIsFixed_</a>(false),
<a name="l00062"></a>00062               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3d9bab12b0f9c11ec20cf6497e6cc6ad">betaIsFixed_</a>(false),
<a name="l00063"></a>00063               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a8d9e8a46d51c555dc96d4752e9ef72d9">nuIsFixed_</a>(false),
<a name="l00064"></a>00064               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae575965ca8d4262c225e264080e25c98">rhoIsFixed_</a>(false),
<a name="l00065"></a>00065               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>(std::vector&lt;<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&gt;()),
<a name="l00066"></a>00066               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a278a75e4aec148d7e0c0f41f6dccc5f7">error_</a>(<a class="code" href="class_quant_lib_1_1_null.html">Null</a>&lt;<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&gt;()),
<a name="l00067"></a>00067               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad61ce12dee40dc4a5f9e651142198d82">maxError_</a>(<a class="code" href="class_quant_lib_1_1_null.html">Null</a>&lt;<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&gt;()),
<a name="l00068"></a>00068               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a43f3b4afde1d497ca7ab3657e4358b72">SABREndCriteria_</a>(<a class="code" href="class_quant_lib_1_1_end_criteria.html" title="Criteria to end optimization process:">EndCriteria</a>::None)
<a name="l00069"></a>00069             {
<a name="l00070"></a>00070                 <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(t&gt;0.0, <span class="stringliteral">&quot;expiry time must be positive: &quot;</span>
<a name="l00071"></a>00071                                   &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; not allowed&quot;</span>);
<a name="l00072"></a>00072                 <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a> != <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>())
<a name="l00073"></a>00073                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad726ecf3f555dbab0ba7a408644f2a89">alphaIsFixed_</a> = alphaIsFixed;
<a name="l00074"></a>00074                 <span class="keywordflow">else</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a> = std::sqrt(0.2);
<a name="l00075"></a>00075                 <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a> != <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>())
<a name="l00076"></a>00076                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3d9bab12b0f9c11ec20cf6497e6cc6ad">betaIsFixed_</a> = betaIsFixed;
<a name="l00077"></a>00077                 <span class="keywordflow">else</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a> = 0.5;
<a name="l00078"></a>00078                 <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a> != <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>())
<a name="l00079"></a>00079                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a8d9e8a46d51c555dc96d4752e9ef72d9">nuIsFixed_</a> = nuIsFixed;
<a name="l00080"></a>00080                 <span class="keywordflow">else</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a> = std::sqrt(0.4);
<a name="l00081"></a>00081                 <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a> != <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>())
<a name="l00082"></a>00082                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae575965ca8d4262c225e264080e25c98">rhoIsFixed_</a> = rhoIsFixed;
<a name="l00083"></a>00083                 <span class="keywordflow">else</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a> = 0.0;
<a name="l00084"></a>00084                 <a class="code" href="namespace_quant_lib.html#a0308d79448b4ccb60e0319227fe73aec">validateSabrParameters</a>(<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>);
<a name="l00085"></a>00085             }
<a name="l00086"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a4ddb4311ae904ae230270585f2b8a4e6">00086</a>             <span class="keyword">virtual</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a4ddb4311ae904ae230270585f2b8a4e6">~SABRCoeffHolder</a>() {}
<a name="l00087"></a>00087 
<a name="l00089"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3e2a07b69a5c304cae35801590ec7852">00089</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3e2a07b69a5c304cae35801590ec7852">t_</a>;
<a name="l00091"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae13514008e8ffffd36b5b932197acd41">00091</a>             <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&amp; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae13514008e8ffffd36b5b932197acd41">forward_</a>;
<a name="l00093"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">00093</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>;
<a name="l00094"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae575965ca8d4262c225e264080e25c98">00094</a>             <span class="keywordtype">bool</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad726ecf3f555dbab0ba7a408644f2a89">alphaIsFixed_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3d9bab12b0f9c11ec20cf6497e6cc6ad">betaIsFixed_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a8d9e8a46d51c555dc96d4752e9ef72d9">nuIsFixed_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae575965ca8d4262c225e264080e25c98">rhoIsFixed_</a>;
<a name="l00095"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">00095</a>             std::vector&lt;Real&gt; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>;
<a name="l00097"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad61ce12dee40dc4a5f9e651142198d82">00097</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a278a75e4aec148d7e0c0f41f6dccc5f7">error_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad61ce12dee40dc4a5f9e651142198d82">maxError_</a>;
<a name="l00098"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a43f3b4afde1d497ca7ab3657e4358b72">00098</a>             <a class="code" href="class_quant_lib_1_1_end_criteria.html#aa338799214a20227a4d11a4219b66a66">EndCriteria::Type</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a43f3b4afde1d497ca7ab3657e4358b72">SABREndCriteria_</a>;
<a name="l00099"></a>00099         };
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <span class="keyword">template</span> &lt;<span class="keyword">class</span> I1, <span class="keyword">class</span> I2&gt;
<a name="l00102"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html">00102</a>         <span class="keyword">class </span><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html">SABRInterpolationImpl</a> : <span class="keyword">public</span> <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a>::templateImpl&lt;I1,I2&gt;,
<a name="l00103"></a>00103                                       <span class="keyword">public</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html">SABRCoeffHolder</a> {
<a name="l00104"></a>00104           <span class="keyword">public</span>:
<a name="l00105"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac171e6dceb63a58729cd986fdd1bdac5">00105</a>             <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac171e6dceb63a58729cd986fdd1bdac5">SABRInterpolationImpl</a>(
<a name="l00106"></a>00106                 <span class="keyword">const</span> I1&amp; xBegin, <span class="keyword">const</span> I1&amp; xEnd,
<a name="l00107"></a>00107                 <span class="keyword">const</span> I2&amp; yBegin,
<a name="l00108"></a>00108                 <a class="code" href="namespace_quant_lib.html#a4f78b18a4dd1a979eb78b4e1e8ac1503" title="continuous quantity with 1-year units">Time</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>,
<a name="l00109"></a>00109                 <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&amp; forward,
<a name="l00110"></a>00110                 <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alpha, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a75f63a468538f062319982a22c52c2c4">beta</a>, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> nu, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> rho,
<a name="l00111"></a>00111                 <span class="keywordtype">bool</span> alphaIsFixed,
<a name="l00112"></a>00112                 <span class="keywordtype">bool</span> betaIsFixed,
<a name="l00113"></a>00113                 <span class="keywordtype">bool</span> nuIsFixed,
<a name="l00114"></a>00114                 <span class="keywordtype">bool</span> rhoIsFixed,
<a name="l00115"></a>00115                 <span class="keywordtype">bool</span> vegaWeighted,
<a name="l00116"></a>00116                 <span class="keyword">const</span> boost::shared_ptr&lt;EndCriteria&gt;&amp; endCriteria,
<a name="l00117"></a>00117                 <span class="keyword">const</span> boost::shared_ptr&lt;OptimizationMethod&gt;&amp; optMethod)
<a name="l00118"></a>00118             : <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a>::<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a084256d989d9265b81d7a56e6f7e3991">templateImpl</a>&lt;I1,I2&gt;(xBegin, xEnd, yBegin),
<a name="l00119"></a>00119               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html">SABRCoeffHolder</a>(t, forward, alpha, beta, nu, rho,
<a name="l00120"></a>00120                               alphaIsFixed,betaIsFixed,nuIsFixed,rhoIsFixed),
<a name="l00121"></a>00121               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af1101da92345197b2d196ff8568a739a">endCriteria_</a>(endCriteria), <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af5cdd5bceb2271aa21de718332f8ab1b">optMethod_</a>(optMethod),
<a name="l00122"></a>00122               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">forward_</a>(forward),
<a name="l00123"></a>00123               <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2222c07982de83ba49f66c55f823644f">vegaWeighted_</a>(vegaWeighted)
<a name="l00124"></a>00124             {
<a name="l00125"></a>00125                 <span class="comment">// if no optimization method or endCriteria is provided, we provide one</span>
<a name="l00126"></a>00126                 <span class="keywordflow">if</span> (!<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af5cdd5bceb2271aa21de718332f8ab1b">optMethod_</a>)
<a name="l00127"></a>00127                     <span class="comment">//optMethod_ = boost::shared_ptr&lt;OptimizationMethod&gt;(new</span>
<a name="l00128"></a>00128                     <span class="comment">//    LevenbergMarquardt(1e-8, 1e-8, 1e-8));</span>
<a name="l00129"></a>00129                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af5cdd5bceb2271aa21de718332f8ab1b">optMethod_</a> = boost::shared_ptr&lt;OptimizationMethod&gt;(<span class="keyword">new</span>
<a name="l00130"></a>00130                         <a class="code" href="class_quant_lib_1_1_simplex.html" title="Multi-dimensional simplex class.">Simplex</a>(0.01));
<a name="l00131"></a>00131                 <span class="keywordflow">if</span> (!<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af1101da92345197b2d196ff8568a739a">endCriteria_</a>) {
<a name="l00132"></a>00132                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af1101da92345197b2d196ff8568a739a">endCriteria_</a> = boost::shared_ptr&lt;EndCriteria&gt;(<span class="keyword">new</span>
<a name="l00133"></a>00133                         <a class="code" href="class_quant_lib_1_1_end_criteria.html" title="Criteria to end optimization process:">EndCriteria</a>(60000, 100, 1e-8, 1e-8, 1e-8));
<a name="l00134"></a>00134                 }
<a name="l00135"></a>00135                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a> = std::vector&lt;Real&gt;(xEnd-xBegin, 1.0/(xEnd-xBegin));
<a name="l00136"></a>00136             }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#acf69096949d15a43f4083147b1a00ff0">00138</a>             <span class="keywordtype">void</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#acf69096949d15a43f4083147b1a00ff0">update</a>() {
<a name="l00139"></a>00139                 <span class="comment">// forward_ might have changed</span>
<a name="l00140"></a>00140                 <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">forward_</a>&gt;0.0, <span class="stringliteral">&quot;at the money forward rate must be &quot;</span>
<a name="l00141"></a>00141                            <span class="stringliteral">&quot;positive: &quot;</span> &lt;&lt; <a class="code" href="group__manips.html#gac9152aad6a69c41f5d30bb1dcb9b2236" title="output rates and spreads as percentages">io::rate</a>(<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">forward_</a>) &lt;&lt; <span class="stringliteral">&quot; not allowed&quot;</span>);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143                 <span class="comment">// we should also check that y contains positive values only</span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145                 <span class="comment">// we must update weights if it is vegaWeighted</span>
<a name="l00146"></a>00146                 <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2222c07982de83ba49f66c55f823644f">vegaWeighted_</a>) {
<a name="l00147"></a>00147                     std::vector&lt;Real&gt;::const_iterator x = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a4224a56b414e92505e5b1e2b83282d80">xBegin_</a>;
<a name="l00148"></a>00148                     std::vector&lt;Real&gt;::const_iterator y = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#adef37d429d0186d836878f1cc9ae3c71">yBegin_</a>;
<a name="l00149"></a>00149                     <span class="comment">//std::vector&lt;Real&gt;::iterator w = weights_.begin();</span>
<a name="l00150"></a>00150                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.clear();
<a name="l00151"></a>00151                     <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> weightsSum = 0.0;
<a name="l00152"></a>00152                     <span class="keywordflow">for</span> ( ; x!=this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#ae31c6c02580a0b25b0e9c64fad90604a">xEnd_</a>; ++x, ++y) {
<a name="l00153"></a>00153                         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> stdDev = std::sqrt((*y)*(*y)*<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3e2a07b69a5c304cae35801590ec7852">t_</a>);
<a name="l00154"></a>00154                         <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.push_back(
<a name="l00155"></a>00155                             <a class="code" href="namespace_quant_lib.html#a401f828a9f0412b197b1f7351438c25c">blackFormulaStdDevDerivative</a>(*x, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">forward_</a>, stdDev));
<a name="l00156"></a>00156                         weightsSum += <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.back();
<a name="l00157"></a>00157                     }
<a name="l00158"></a>00158                     <span class="comment">// weight normalization</span>
<a name="l00159"></a>00159                     std::vector&lt;Real&gt;::iterator w = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.begin();
<a name="l00160"></a>00160                     <span class="keywordflow">for</span> ( ; w!=<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.end(); ++w)
<a name="l00161"></a>00161                         *w /= weightsSum;
<a name="l00162"></a>00162                 }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164                 <span class="comment">// there is nothing to optimize</span>
<a name="l00165"></a>00165                 <span class="keywordflow">if</span> (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad726ecf3f555dbab0ba7a408644f2a89">alphaIsFixed_</a> &amp;&amp; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3d9bab12b0f9c11ec20cf6497e6cc6ad">betaIsFixed_</a> &amp;&amp; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a8d9e8a46d51c555dc96d4752e9ef72d9">nuIsFixed_</a> &amp;&amp; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae575965ca8d4262c225e264080e25c98">rhoIsFixed_</a>) {
<a name="l00166"></a>00166                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a278a75e4aec148d7e0c0f41f6dccc5f7">error_</a> = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a7c5bb21e3edf6be9e57c2fd6a6d9016f">interpolationError</a>();
<a name="l00167"></a>00167                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad61ce12dee40dc4a5f9e651142198d82">maxError_</a> = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ab7d480c33e026019314a15e3f84321dd">interpolationMaxError</a>();
<a name="l00168"></a>00168                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a43f3b4afde1d497ca7ab3657e4358b72">SABREndCriteria_</a> = <a class="code" href="class_quant_lib_1_1_end_criteria.html#aa338799214a20227a4d11a4219b66a66af41a6f8c565cac2ac627e6eaca4047b3">EndCriteria::None</a>;
<a name="l00169"></a>00169                     <span class="keywordflow">return</span>;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171                 } <span class="keywordflow">else</span> {
<a name="l00172"></a>00172 
<a name="l00173"></a>00173                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html">SABRError</a> costFunction(<span class="keyword">this</span>);
<a name="l00174"></a>00174                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">transformation_</a> = boost::shared_ptr&lt;ParametersTransformation&gt;(<span class="keyword">new</span>
<a name="l00175"></a>00175                         <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html">SabrParametersTransformation</a>);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177                     <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> guess(4);
<a name="l00178"></a>00178                     guess[0] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a>;
<a name="l00179"></a>00179                     guess[1] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>;
<a name="l00180"></a>00180                     guess[2] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>;
<a name="l00181"></a>00181                     guess[3] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>;
<a name="l00182"></a>00182 
<a name="l00183"></a>00183                     std::vector&lt;bool&gt; parameterAreFixed(4);
<a name="l00184"></a>00184                     parameterAreFixed[0] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad726ecf3f555dbab0ba7a408644f2a89">alphaIsFixed_</a>;
<a name="l00185"></a>00185                     parameterAreFixed[1] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3d9bab12b0f9c11ec20cf6497e6cc6ad">betaIsFixed_</a>;
<a name="l00186"></a>00186                     parameterAreFixed[2] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a8d9e8a46d51c555dc96d4752e9ef72d9">nuIsFixed_</a>;
<a name="l00187"></a>00187                     parameterAreFixed[3] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ae575965ca8d4262c225e264080e25c98">rhoIsFixed_</a>;
<a name="l00188"></a>00188 
<a name="l00189"></a>00189                     <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> inversedTransformatedGuess(<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">transformation_</a>-&gt;inverse(guess));
<a name="l00190"></a>00190 
<a name="l00191"></a>00191                     <a class="code" href="class_quant_lib_1_1_projected_cost_function.html" title="Parameterized cost function.">ProjectedCostFunction</a> constrainedSABRError(costFunction,
<a name="l00192"></a>00192                                     inversedTransformatedGuess, parameterAreFixed);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194                     <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> projectedGuess
<a name="l00195"></a>00195                         (constrainedSABRError.project(inversedTransformatedGuess));
<a name="l00196"></a>00196 
<a name="l00197"></a>00197                     <a class="code" href="class_quant_lib_1_1_no_constraint.html" title="No constraint.">NoConstraint</a> constraint;
<a name="l00198"></a>00198                     <a class="code" href="class_quant_lib_1_1_problem.html" title="Constrained optimization problem.">Problem</a> problem(constrainedSABRError, constraint, projectedGuess);
<a name="l00199"></a>00199                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a43f3b4afde1d497ca7ab3657e4358b72">SABREndCriteria_</a> = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af5cdd5bceb2271aa21de718332f8ab1b">optMethod_</a>-&gt;minimize(problem, *<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af1101da92345197b2d196ff8568a739a">endCriteria_</a>);
<a name="l00200"></a>00200                     <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> projectedResult(problem.<a class="code" href="class_quant_lib_1_1_problem.html#a8f0b5db1fab7445b84530058f71015ac" title="current value of the local minimum">currentValue</a>());
<a name="l00201"></a>00201                     <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> transfResult(constrainedSABRError.include(projectedResult));
<a name="l00202"></a>00202 
<a name="l00203"></a>00203                     <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> result = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">transformation_</a>-&gt;direct(transfResult);
<a name="l00204"></a>00204                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a> = result[0];
<a name="l00205"></a>00205                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>  = result[1];
<a name="l00206"></a>00206                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>    = result[2];
<a name="l00207"></a>00207                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>   = result[3];
<a name="l00208"></a>00208 
<a name="l00209"></a>00209                 }
<a name="l00210"></a>00210                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a278a75e4aec148d7e0c0f41f6dccc5f7">error_</a> = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a7c5bb21e3edf6be9e57c2fd6a6d9016f">interpolationError</a>();
<a name="l00211"></a>00211                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad61ce12dee40dc4a5f9e651142198d82">maxError_</a> = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ab7d480c33e026019314a15e3f84321dd">interpolationMaxError</a>();
<a name="l00212"></a>00212 
<a name="l00213"></a>00213             }
<a name="l00214"></a>00214 
<a name="l00215"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aed47de6c410fc4a9101fb195f11e0873">00215</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aed47de6c410fc4a9101fb195f11e0873">value</a>(<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x)<span class="keyword"> const </span>{
<a name="l00216"></a>00216                 <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(x&gt;0.0, <span class="stringliteral">&quot;strike must be positive: &quot;</span> &lt;&lt;
<a name="l00217"></a>00217                                   <a class="code" href="group__manips.html#gac9152aad6a69c41f5d30bb1dcb9b2236" title="output rates and spreads as percentages">io::rate</a>(x) &lt;&lt; <span class="stringliteral">&quot; not allowed&quot;</span>);
<a name="l00218"></a>00218                 <span class="keywordflow">return</span> <a class="code" href="namespace_quant_lib.html#ab45dc9962b122b5e3600cce6afed7a44">sabrVolatility</a>(x, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">forward_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a3e2a07b69a5c304cae35801590ec7852">t_</a>,
<a name="l00219"></a>00219                                       <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>);
<a name="l00220"></a>00220             }
<a name="l00221"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a9256af6eac99ff0125689f48f3582e6d">00221</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a9256af6eac99ff0125689f48f3582e6d">primitive</a>(<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>)<span class="keyword"> const </span>{
<a name="l00222"></a>00222                 <a class="code" href="errors_8hpp.html#a8efe9cb3e67c8d0585e57b4d53c5d2fe" title="throw an error (possibly with file and line information)">QL_FAIL</a>(<span class="stringliteral">&quot;SABR primitive not implemented&quot;</span>);
<a name="l00223"></a>00223             }
<a name="l00224"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ad4c29fd6d63a942cfdc0363d1f8acbd4">00224</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ad4c29fd6d63a942cfdc0363d1f8acbd4">derivative</a>(<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>)<span class="keyword"> const </span>{
<a name="l00225"></a>00225                 <a class="code" href="errors_8hpp.html#a8efe9cb3e67c8d0585e57b4d53c5d2fe" title="throw an error (possibly with file and line information)">QL_FAIL</a>(<span class="stringliteral">&quot;SABR derivative not implemented&quot;</span>);
<a name="l00226"></a>00226             }
<a name="l00227"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a7f8ec78688c04a0f8357efd0e526ecac">00227</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a7f8ec78688c04a0f8357efd0e526ecac">secondDerivative</a>(<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>)<span class="keyword"> const </span>{
<a name="l00228"></a>00228                 <a class="code" href="errors_8hpp.html#a8efe9cb3e67c8d0585e57b4d53c5d2fe" title="throw an error (possibly with file and line information)">QL_FAIL</a>(<span class="stringliteral">&quot;SABR secondDerivative not implemented&quot;</span>);
<a name="l00229"></a>00229             }
<a name="l00230"></a>00230             <span class="comment">// calculate total squared weighted difference (L2 norm)</span>
<a name="l00231"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2178ddba555e3ffd765ea8621f52ca18">00231</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2178ddba555e3ffd765ea8621f52ca18">interpolationSquaredError</a>()<span class="keyword"> const </span>{
<a name="l00232"></a>00232                 <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> error, totalError = 0.0;
<a name="l00233"></a>00233                 std::vector&lt;Real&gt;::const_iterator x = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a4224a56b414e92505e5b1e2b83282d80">xBegin_</a>;
<a name="l00234"></a>00234                 std::vector&lt;Real&gt;::const_iterator y = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#adef37d429d0186d836878f1cc9ae3c71">yBegin_</a>;
<a name="l00235"></a>00235                 std::vector&lt;Real&gt;::const_iterator w = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.begin();
<a name="l00236"></a>00236                 <span class="keywordflow">for</span> (; x != this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#ae31c6c02580a0b25b0e9c64fad90604a">xEnd_</a>; ++x, ++y, ++w) {
<a name="l00237"></a>00237                     error = (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aed47de6c410fc4a9101fb195f11e0873">value</a>(*x) - *y);
<a name="l00238"></a>00238                     totalError += error*error * (*w);
<a name="l00239"></a>00239                 }
<a name="l00240"></a>00240                 <span class="keywordflow">return</span> totalError;
<a name="l00241"></a>00241             }
<a name="l00242"></a>00242             <span class="comment">// calculate weighted differences</span>
<a name="l00243"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a076082d1cffdf7fe1f7e390f1ab53ceb">00243</a>             <a class="code" href="class_quant_lib_1_1_disposable.html" title="generic disposable object with move semantics">Disposable&lt;Array&gt;</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a076082d1cffdf7fe1f7e390f1ab53ceb">interpolationErrors</a>(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp;)<span class="keyword"> const </span>{
<a name="l00244"></a>00244                 <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="class_dividend_vanilla_option_1_1results.html">results</a>(this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#ae31c6c02580a0b25b0e9c64fad90604a">xEnd_</a> - this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a4224a56b414e92505e5b1e2b83282d80">xBegin_</a>);
<a name="l00245"></a>00245                 std::vector&lt;Real&gt;::const_iterator x = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a4224a56b414e92505e5b1e2b83282d80">xBegin_</a>;
<a name="l00246"></a>00246                 <a class="code" href="class_quant_lib_1_1_array.html#afaec53b95e4bb9bbd3a199ba40bdeae7">Array::iterator</a> r = results.<a class="code" href="class_quant_lib_1_1_array.html#a9574cfad318a9c5de4ba0011b6fbe525">begin</a>();
<a name="l00247"></a>00247                 std::vector&lt;Real&gt;::const_iterator y = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#adef37d429d0186d836878f1cc9ae3c71">yBegin_</a>;
<a name="l00248"></a>00248                 std::vector&lt;Real&gt;::const_iterator w = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#ad548f742c0f82e55b4a9b1f93e894b35">weights_</a>.begin();
<a name="l00249"></a>00249                 <span class="keywordflow">for</span> (; x != this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#ae31c6c02580a0b25b0e9c64fad90604a">xEnd_</a>; ++x, ++r, ++w, ++y) {
<a name="l00250"></a>00250                     *r = (<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aed47de6c410fc4a9101fb195f11e0873">value</a>(*x) - *y)* std::sqrt(*w);
<a name="l00251"></a>00251                 }
<a name="l00252"></a>00252                 <span class="keywordflow">return</span> results;
<a name="l00253"></a>00253             }
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a7c5bb21e3edf6be9e57c2fd6a6d9016f">00255</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a7c5bb21e3edf6be9e57c2fd6a6d9016f">interpolationError</a>()<span class="keyword"> const </span>{
<a name="l00256"></a>00256                 <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#ae31c6c02580a0b25b0e9c64fad90604a">xEnd_</a>-this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a4224a56b414e92505e5b1e2b83282d80">xBegin_</a>;
<a name="l00257"></a>00257                 <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> squaredError = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2178ddba555e3ffd765ea8621f52ca18">interpolationSquaredError</a>();
<a name="l00258"></a>00258                 <span class="keywordflow">return</span> std::sqrt(n*squaredError/(n-1));
<a name="l00259"></a>00259             }
<a name="l00260"></a>00260 
<a name="l00261"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ab7d480c33e026019314a15e3f84321dd">00261</a>             <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ab7d480c33e026019314a15e3f84321dd">interpolationMaxError</a>()<span class="keyword"> const </span>{
<a name="l00262"></a>00262                 <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> error, maxError = <a class="code" href="group__limit_macros.html#ga8a6736b7bfef354a1fc507317d49117a">QL_MIN_REAL</a>;
<a name="l00263"></a>00263                 I1 i = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#a4224a56b414e92505e5b1e2b83282d80">xBegin_</a>;
<a name="l00264"></a>00264                 I2 j = this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#adef37d429d0186d836878f1cc9ae3c71">yBegin_</a>;
<a name="l00265"></a>00265                 <span class="keywordflow">for</span> (; i != this-&gt;<a class="code" href="class_quant_lib_1_1_interpolation_1_1template_impl.html#ae31c6c02580a0b25b0e9c64fad90604a">xEnd_</a>; ++i, ++j) {
<a name="l00266"></a>00266                     error = std::fabs(<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aed47de6c410fc4a9101fb195f11e0873">value</a>(*i) - *j);
<a name="l00267"></a>00267                     maxError = std::max(maxError, error);
<a name="l00268"></a>00268                 }
<a name="l00269"></a>00269                 <span class="keywordflow">return</span> maxError;
<a name="l00270"></a>00270             }
<a name="l00271"></a>00271           <span class="keyword">private</span>:
<a name="l00272"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html">00272</a>             <span class="keyword">class </span><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html">SabrParametersTransformation</a> :
<a name="l00273"></a>00273                   <span class="keyword">public</span> <a class="code" href="class_quant_lib_1_1_parameters_transformation.html">ParametersTransformation</a> {
<a name="l00274"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">00274</a>                      <span class="keyword">mutable</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>;
<a name="l00275"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#ac563790dac2a1fafcafab66d4b2d355f">00275</a>                      <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a78e60b9bf2b19a42f888d258217d9773">eps1_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#ac563790dac2a1fafcafab66d4b2d355f">eps2_</a>, <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#af0fdc7029a2a6ec352951f29b375e61c">dilationFactor_</a> ;
<a name="l00276"></a>00276              <span class="keyword">public</span>:
<a name="l00277"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#abc48147a5e5f7b598595d112b69f3d43">00277</a>                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#abc48147a5e5f7b598595d112b69f3d43">SabrParametersTransformation</a>() : <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>(<a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(4)),
<a name="l00278"></a>00278                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a78e60b9bf2b19a42f888d258217d9773">eps1_</a>(.0000001),
<a name="l00279"></a>00279                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#ac563790dac2a1fafcafab66d4b2d355f">eps2_</a>(.9999),
<a name="l00280"></a>00280                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#af0fdc7029a2a6ec352951f29b375e61c">dilationFactor_</a>(0.001){
<a name="l00281"></a>00281                 }
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a73dc4c410573ca2c28831de1fa504529">00283</a>                 <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a73dc4c410573ca2c28831de1fa504529">direct</a>(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp; x)<span class="keyword"> const </span>{
<a name="l00284"></a>00284                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[0] = x[0]*x[0] + <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a78e60b9bf2b19a42f888d258217d9773">eps1_</a>;
<a name="l00285"></a>00285                     <span class="comment">//y_[1] = std::atan(dilationFactor_*x[1])/M_PI + 0.5;</span>
<a name="l00286"></a>00286                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[1] = std::exp(-(x[1]*x[1]));
<a name="l00287"></a>00287                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[2] = x[2]*x[2] + <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a78e60b9bf2b19a42f888d258217d9773">eps1_</a>;
<a name="l00288"></a>00288                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[3] = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#ac563790dac2a1fafcafab66d4b2d355f">eps2_</a> * std::sin(x[3]);
<a name="l00289"></a>00289                     <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>;
<a name="l00290"></a>00290                 }
<a name="l00291"></a>00291 
<a name="l00292"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a22ff7ffa7047120881b760a418bc0d5b">00292</a>                 <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a22ff7ffa7047120881b760a418bc0d5b">inverse</a>(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp; x)<span class="keyword"> const </span>{
<a name="l00293"></a>00293                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[0] = std::sqrt(x[0] - <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a78e60b9bf2b19a42f888d258217d9773">eps1_</a>);
<a name="l00294"></a>00294                     <span class="comment">//y_[1] = std::tan(M_PI*(x[1] - 0.5))/dilationFactor_;</span>
<a name="l00295"></a>00295                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[1] = std::sqrt(-std::log(x[1]));
<a name="l00296"></a>00296                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[2] = std::sqrt(x[2] - <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a78e60b9bf2b19a42f888d258217d9773">eps1_</a>);
<a name="l00297"></a>00297                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>[3] = std::asin(x[3]/<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#ac563790dac2a1fafcafab66d4b2d355f">eps2_</a>);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299                     <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_sabr_parameters_transformation.html#a1ec7e88c04e572a1a1cb31245b72a8f7">y_</a>;
<a name="l00300"></a>00300                 }
<a name="l00301"></a>00301             };
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html">00303</a>             <span class="keyword">class </span><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html">SABRError</a> : <span class="keyword">public</span> <a class="code" href="class_quant_lib_1_1_cost_function.html" title="Cost function abstract class for optimization problem.">CostFunction</a> {
<a name="l00304"></a>00304               <span class="keyword">public</span>:
<a name="l00305"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a46e9d43c37cb12dbfb3bf1d77c08ff1f">00305</a>                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a46e9d43c37cb12dbfb3bf1d77c08ff1f">SABRError</a>(<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html">SABRInterpolationImpl</a>* sabr)
<a name="l00306"></a>00306                 : <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>(sabr) {}
<a name="l00307"></a>00307 
<a name="l00308"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a7c5c87b300d83188f7e7b68cb5209293">00308</a>                 <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a7c5c87b300d83188f7e7b68cb5209293" title="method to overload to compute the cost function value in x">value</a>(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp; x)<span class="keyword"> const </span>{
<a name="l00309"></a>00309                     <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> y = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">transformation_</a>-&gt;direct(x);
<a name="l00310"></a>00310                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a> = y[0];
<a name="l00311"></a>00311                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>  = y[1];
<a name="l00312"></a>00312                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>    = y[2];
<a name="l00313"></a>00313                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>   = y[3];
<a name="l00314"></a>00314                     <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2178ddba555e3ffd765ea8621f52ca18">interpolationSquaredError</a>();
<a name="l00315"></a>00315                 }
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#ab85841b9e32a32c69a489cacdfe2670c">00317</a>                 <a class="code" href="class_quant_lib_1_1_disposable.html" title="generic disposable object with move semantics">Disposable&lt;Array&gt;</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#ab85841b9e32a32c69a489cacdfe2670c" title="method to overload to compute the cost function values in x">values</a>(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp; x)<span class="keyword"> const</span>{
<a name="l00318"></a>00318                     <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> y = <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">transformation_</a>-&gt;direct(x);
<a name="l00319"></a>00319                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#adad0e9459efa2ff74b238fd02bbf5577">alpha_</a> = y[0];
<a name="l00320"></a>00320                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a132ced86eec67b02a28b765070c74079">beta_</a>  = y[1];
<a name="l00321"></a>00321                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a77b2c6c49e9b5a503af7b93ade171080">nu_</a>    = y[2];
<a name="l00322"></a>00322                     <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html#a89c5c11b09858cdbe25ffae7fbe77f60">rho_</a>   = y[3];
<a name="l00323"></a>00323                     <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>-&gt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a076082d1cffdf7fe1f7e390f1ab53ceb">interpolationErrors</a>(x);
<a name="l00324"></a>00324                 }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326               <span class="keyword">private</span>:
<a name="l00327"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">00327</a>                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html">SABRInterpolationImpl</a>* <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl_1_1_s_a_b_r_error.html#a9426388a493d7cd8d2c3114fd2ffb696">sabr_</a>;
<a name="l00328"></a>00328             };
<a name="l00329"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af1101da92345197b2d196ff8568a739a">00329</a>             boost::shared_ptr&lt;EndCriteria&gt; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af1101da92345197b2d196ff8568a739a">endCriteria_</a>;
<a name="l00330"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af5cdd5bceb2271aa21de718332f8ab1b">00330</a>             boost::shared_ptr&lt;OptimizationMethod&gt; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#af5cdd5bceb2271aa21de718332f8ab1b">optMethod_</a>;
<a name="l00331"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">00331</a>             <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&amp; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ac334c13cfbe11e68e8dd505c217798b0">forward_</a>;
<a name="l00332"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2222c07982de83ba49f66c55f823644f">00332</a>             <span class="keywordtype">bool</span> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#a2222c07982de83ba49f66c55f823644f">vegaWeighted_</a>;
<a name="l00333"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">00333</a>             boost::shared_ptr&lt;ParametersTransformation&gt; <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#aa9065570970b1af1bafa6f9e4ac649ae">transformation_</a>;
<a name="l00334"></a><a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ad64ee7b1ee0465ab768f867b2b3a05bf">00334</a>             <a class="code" href="class_quant_lib_1_1_no_constraint.html" title="No constraint.">NoConstraint</a> <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html#ad64ee7b1ee0465ab768f867b2b3a05bf">constraint_</a>;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         };
<a name="l00337"></a>00337 
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339 
<a name="l00341"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html">00341</a>     <span class="keyword">class </span><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html" title="SABR smile interpolation between discrete volatility points.">SABRInterpolation</a> : <span class="keyword">public</span> <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a> {
<a name="l00342"></a>00342       <span class="keyword">public</span>:
<a name="l00343"></a>00343         <span class="keyword">template</span> &lt;<span class="keyword">class</span> I1, <span class="keyword">class</span> I2&gt;
<a name="l00344"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a6dba465d8008fbc829c1246b4f5b7533">00344</a>         <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a6dba465d8008fbc829c1246b4f5b7533">SABRInterpolation</a>(<span class="keyword">const</span> I1&amp; xBegin,  <span class="comment">// x = strikes</span>
<a name="l00345"></a>00345                           <span class="keyword">const</span> I1&amp; xEnd,
<a name="l00346"></a>00346                           <span class="keyword">const</span> I2&amp; yBegin,  <span class="comment">// y = volatilities</span>
<a name="l00347"></a>00347                           <a class="code" href="namespace_quant_lib.html#a4f78b18a4dd1a979eb78b4e1e8ac1503" title="continuous quantity with 1-year units">Time</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>,            <span class="comment">// option expiry</span>
<a name="l00348"></a>00348                           <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>&amp; <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ac74d74d65966976c509dc50d67f1d287">forward</a>,
<a name="l00349"></a>00349                           <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#adea7e8079b289cb48b3fd58692b2f8d8">alpha</a>,
<a name="l00350"></a>00350                           <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ab58d59e2916d839d941ac2c81f63f11c">beta</a>,
<a name="l00351"></a>00351                           <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a2f1ab1b5511be11b3e93460f0e690d62">nu</a>,
<a name="l00352"></a>00352                           <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ae88d4c98be176cc538b1e43743e249bf">rho</a>,
<a name="l00353"></a>00353                           <span class="keywordtype">bool</span> alphaIsFixed,
<a name="l00354"></a>00354                           <span class="keywordtype">bool</span> betaIsFixed,
<a name="l00355"></a>00355                           <span class="keywordtype">bool</span> nuIsFixed,
<a name="l00356"></a>00356                           <span class="keywordtype">bool</span> rhoIsFixed,
<a name="l00357"></a>00357                           <span class="keywordtype">bool</span> vegaWeighted = <span class="keyword">true</span>,
<a name="l00358"></a>00358                           <span class="keyword">const</span> boost::shared_ptr&lt;EndCriteria&gt;&amp; <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a183ca265c4fa2c3d2ae7a9dfd0265994">endCriteria</a>
<a name="l00359"></a>00359                                   = boost::shared_ptr&lt;EndCriteria&gt;(),
<a name="l00360"></a>00360                           <span class="keyword">const</span> boost::shared_ptr&lt;OptimizationMethod&gt;&amp; optMethod
<a name="l00361"></a>00361                                   = boost::shared_ptr&lt;OptimizationMethod&gt;()) {
<a name="l00362"></a>00362 
<a name="l00363"></a>00363             <a class="code" href="class_quant_lib_1_1_interpolation.html#aaa2a4f9359a61e86b6dbbb304881c41c">impl_</a> = boost::shared_ptr&lt;Interpolation::Impl&gt;(<span class="keyword">new</span>
<a name="l00364"></a>00364                 <a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_interpolation_impl.html">detail::SABRInterpolationImpl&lt;I1,I2&gt;</a>(xBegin, xEnd, yBegin,
<a name="l00365"></a>00365                                                      <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ac74d74d65966976c509dc50d67f1d287">forward</a>,
<a name="l00366"></a>00366                                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#adea7e8079b289cb48b3fd58692b2f8d8">alpha</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ab58d59e2916d839d941ac2c81f63f11c">beta</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a2f1ab1b5511be11b3e93460f0e690d62">nu</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ae88d4c98be176cc538b1e43743e249bf">rho</a>,
<a name="l00367"></a>00367                                                      alphaIsFixed, betaIsFixed,
<a name="l00368"></a>00368                                                      nuIsFixed, rhoIsFixed,
<a name="l00369"></a>00369                                                      vegaWeighted,
<a name="l00370"></a>00370                                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a183ca265c4fa2c3d2ae7a9dfd0265994">endCriteria</a>,
<a name="l00371"></a>00371                                                      optMethod));
<a name="l00372"></a>00372             <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a> =
<a name="l00373"></a>00373                 boost::dynamic_pointer_cast&lt;<a class="code" href="class_quant_lib_1_1detail_1_1_s_a_b_r_coeff_holder.html">detail::SABRCoeffHolder</a>&gt;(
<a name="l00374"></a>00374                                                                        <a class="code" href="class_quant_lib_1_1_interpolation.html#aaa2a4f9359a61e86b6dbbb304881c41c">impl_</a>);
<a name="l00375"></a>00375         }
<a name="l00376"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a863e72708379689a4760f9bf154eb352">00376</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a863e72708379689a4760f9bf154eb352">expiry</a>()<span class="keyword">  const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;t_; }
<a name="l00377"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ac74d74d65966976c509dc50d67f1d287">00377</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ac74d74d65966976c509dc50d67f1d287">forward</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;forward_; }
<a name="l00378"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#adea7e8079b289cb48b3fd58692b2f8d8">00378</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#adea7e8079b289cb48b3fd58692b2f8d8">alpha</a>()<span class="keyword">   const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;alpha_; }
<a name="l00379"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ab58d59e2916d839d941ac2c81f63f11c">00379</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ab58d59e2916d839d941ac2c81f63f11c">beta</a>()<span class="keyword">    const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;beta_; }
<a name="l00380"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a2f1ab1b5511be11b3e93460f0e690d62">00380</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a2f1ab1b5511be11b3e93460f0e690d62">nu</a>()<span class="keyword">      const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;nu_; }
<a name="l00381"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ae88d4c98be176cc538b1e43743e249bf">00381</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ae88d4c98be176cc538b1e43743e249bf">rho</a>()<span class="keyword">     const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;rho_; }
<a name="l00382"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ab8d225f26ca822de149e7668509ac90c">00382</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#ab8d225f26ca822de149e7668509ac90c">rmsError</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;error_; }
<a name="l00383"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a784bd5fe2156bc4270db67fd6cfd868e">00383</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a784bd5fe2156bc4270db67fd6cfd868e">maxError</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;maxError_; }
<a name="l00384"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#abb2582ce3b0b96f2be2ab3ac3c258edd">00384</a>         <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#abb2582ce3b0b96f2be2ab3ac3c258edd">interpolationWeights</a>()<span class="keyword"> const </span>{
<a name="l00385"></a>00385             <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;weights_; }
<a name="l00386"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a183ca265c4fa2c3d2ae7a9dfd0265994">00386</a>         <a class="code" href="class_quant_lib_1_1_end_criteria.html#aa338799214a20227a4d11a4219b66a66">EndCriteria::Type</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#a183ca265c4fa2c3d2ae7a9dfd0265994">endCriteria</a>(){ <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>-&gt;SABREndCriteria_; }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388       <span class="keyword">private</span>:
<a name="l00389"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">00389</a>         boost::shared_ptr&lt;detail::SABRCoeffHolder&gt; <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html#aa586f83e9bbff6426d63d59b22d14de2">coeffs_</a>;
<a name="l00390"></a>00390     };
<a name="l00391"></a>00391 
<a name="l00393"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html">00393</a>     <span class="keyword">class </span><a class="code" href="class_quant_lib_1_1_s_a_b_r.html" title="SABR interpolation factory and traits">SABR</a> {
<a name="l00394"></a>00394       <span class="keyword">public</span>:
<a name="l00395"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#aea605efe2938c3e2684bd73b7a10fe14">00395</a>         <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#aea605efe2938c3e2684bd73b7a10fe14">SABR</a>(<a class="code" href="namespace_quant_lib.html#a4f78b18a4dd1a979eb78b4e1e8ac1503" title="continuous quantity with 1-year units">Time</a> t, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> forward,
<a name="l00396"></a>00396              <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alpha, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> beta, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> nu, <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> rho,
<a name="l00397"></a>00397              <span class="keywordtype">bool</span> alphaIsFixed, <span class="keywordtype">bool</span> betaIsFixed,
<a name="l00398"></a>00398              <span class="keywordtype">bool</span> nuIsFixed, <span class="keywordtype">bool</span> rhoIsFixed,
<a name="l00399"></a>00399              <span class="keywordtype">bool</span> vegaWeighted = <span class="keyword">false</span>,
<a name="l00400"></a>00400              <span class="keyword">const</span> boost::shared_ptr&lt;EndCriteria&gt; endCriteria
<a name="l00401"></a>00401                  = boost::shared_ptr&lt;EndCriteria&gt;(),
<a name="l00402"></a>00402              <span class="keyword">const</span> boost::shared_ptr&lt;OptimizationMethod&gt; optMethod
<a name="l00403"></a>00403                  = boost::shared_ptr&lt;OptimizationMethod&gt;())
<a name="l00404"></a>00404         : <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afe7e30ff0f191a758cc2aaefbde988eb">t_</a>(t), <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#abd8ed8c00ac4885319e0bbdb1c40d143">forward_</a>(forward),
<a name="l00405"></a>00405           <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1b2103a5810fea90fa232eb7e43dbda6">alpha_</a>(alpha), <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a5ae69a8d85d0e1324f69fd1cd1e53bfc">beta_</a>(beta), <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a5003c999f1a549ab873b0aa5e7ec97ca">nu_</a>(nu), <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ad72189c2f3eafc8ce83eee5950851edb">rho_</a>(rho),
<a name="l00406"></a>00406           <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afc34d4b377c7b8413ddc63c99e926bdd">alphaIsFixed_</a>(alphaIsFixed), <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#af2a0a3d2522186a670db28315c821797">betaIsFixed_</a>(betaIsFixed),
<a name="l00407"></a>00407           <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3e10344418e6eb6ab642aad6b10e05a3">nuIsFixed_</a>(nuIsFixed), <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ab4a9d694eba302cc791069b737646732">rhoIsFixed_</a>(rhoIsFixed),
<a name="l00408"></a>00408           <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#acbf40ede05c72f7c47a7a5b3a7b001ca">vegaWeighted_</a>(vegaWeighted),
<a name="l00409"></a>00409           <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3f7e1f503ce8a07553d9c29244068f7f">endCriteria_</a>(endCriteria),
<a name="l00410"></a>00410           <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1f48f0269c49b41608866ea537da673b">optMethod_</a>(optMethod) {}
<a name="l00411"></a>00411         <span class="keyword">template</span> &lt;<span class="keyword">class</span> I1, <span class="keyword">class</span> I2&gt;
<a name="l00412"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#aac31ed180a28a1458aaa4235658678c9">00412</a>         <a class="code" href="class_quant_lib_1_1_interpolation.html" title="base class for 1-D interpolations.">Interpolation</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#aac31ed180a28a1458aaa4235658678c9">interpolate</a>(<span class="keyword">const</span> I1&amp; xBegin, <span class="keyword">const</span> I1&amp; xEnd,
<a name="l00413"></a>00413                                   <span class="keyword">const</span> I2&amp; yBegin)<span class="keyword"> const </span>{
<a name="l00414"></a>00414             <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r_interpolation.html" title="SABR smile interpolation between discrete volatility points.">SABRInterpolation</a>(xBegin, xEnd, yBegin,
<a name="l00415"></a>00415                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afe7e30ff0f191a758cc2aaefbde988eb">t_</a>,  <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#abd8ed8c00ac4885319e0bbdb1c40d143">forward_</a>,
<a name="l00416"></a>00416                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1b2103a5810fea90fa232eb7e43dbda6">alpha_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a5ae69a8d85d0e1324f69fd1cd1e53bfc">beta_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a5003c999f1a549ab873b0aa5e7ec97ca">nu_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ad72189c2f3eafc8ce83eee5950851edb">rho_</a>,
<a name="l00417"></a>00417                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afc34d4b377c7b8413ddc63c99e926bdd">alphaIsFixed_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#af2a0a3d2522186a670db28315c821797">betaIsFixed_</a>,
<a name="l00418"></a>00418                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3e10344418e6eb6ab642aad6b10e05a3">nuIsFixed_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ab4a9d694eba302cc791069b737646732">rhoIsFixed_</a>,
<a name="l00419"></a>00419                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#acbf40ede05c72f7c47a7a5b3a7b001ca">vegaWeighted_</a>,
<a name="l00420"></a>00420                                      <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3f7e1f503ce8a07553d9c29244068f7f">endCriteria_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1f48f0269c49b41608866ea537da673b">optMethod_</a>);
<a name="l00421"></a>00421         }
<a name="l00422"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a69938625dacf3f5019c1c4e9b15d5bc0">00422</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a69938625dacf3f5019c1c4e9b15d5bc0">global</a> = <span class="keyword">true</span>;
<a name="l00423"></a>00423       <span class="keyword">private</span>:
<a name="l00424"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afe7e30ff0f191a758cc2aaefbde988eb">00424</a>         <a class="code" href="namespace_quant_lib.html#a4f78b18a4dd1a979eb78b4e1e8ac1503" title="continuous quantity with 1-year units">Time</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afe7e30ff0f191a758cc2aaefbde988eb">t_</a>;
<a name="l00425"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#abd8ed8c00ac4885319e0bbdb1c40d143">00425</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#abd8ed8c00ac4885319e0bbdb1c40d143">forward_</a>;
<a name="l00426"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ad72189c2f3eafc8ce83eee5950851edb">00426</a>         <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1b2103a5810fea90fa232eb7e43dbda6">alpha_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a5ae69a8d85d0e1324f69fd1cd1e53bfc">beta_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a5003c999f1a549ab873b0aa5e7ec97ca">nu_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ad72189c2f3eafc8ce83eee5950851edb">rho_</a>;
<a name="l00427"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ab4a9d694eba302cc791069b737646732">00427</a>         <span class="keywordtype">bool</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#afc34d4b377c7b8413ddc63c99e926bdd">alphaIsFixed_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#af2a0a3d2522186a670db28315c821797">betaIsFixed_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3e10344418e6eb6ab642aad6b10e05a3">nuIsFixed_</a>, <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#ab4a9d694eba302cc791069b737646732">rhoIsFixed_</a>;
<a name="l00428"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#acbf40ede05c72f7c47a7a5b3a7b001ca">00428</a>         <span class="keywordtype">bool</span> <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#acbf40ede05c72f7c47a7a5b3a7b001ca">vegaWeighted_</a>;
<a name="l00429"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3f7e1f503ce8a07553d9c29244068f7f">00429</a>         <span class="keyword">const</span> boost::shared_ptr&lt;EndCriteria&gt; <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a3f7e1f503ce8a07553d9c29244068f7f">endCriteria_</a>;
<a name="l00430"></a><a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1f48f0269c49b41608866ea537da673b">00430</a>         <span class="keyword">const</span> boost::shared_ptr&lt;OptimizationMethod&gt; <a class="code" href="class_quant_lib_1_1_s_a_b_r.html#a1f48f0269c49b41608866ea537da673b">optMethod_</a>;
<a name="l00431"></a>00431     };
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="sabrinterpolation_8hpp.html">sabrinterpolation.hpp</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:50:45 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
