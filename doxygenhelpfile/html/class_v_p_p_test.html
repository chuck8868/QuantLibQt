<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: VPPTest Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_v_p_p_test.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">VPPTest Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="VPPTest" -->
<p><code>#include &lt;<a class="el" href="vpp_8hpp_source.html">vpp.hpp</a>&gt;</code></p>

<p><a href="class_v_p_p_test-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_v_p_p_test.html#a6743aa1c0b5737efd530490c00c21f7b">testGemanRoncoroniProcess</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_v_p_p_test.html#a2a60244af07b8df80ad18c96dccd47f4">testSimpleExtOUStorageEngine</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_v_p_p_test.html#ab70027f7cdef86e27e1a6783304d8f96">testKlugeExtOUSpreadOption</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_v_p_p_test.html#a61796a971c03a1e7109a91505d4a466a">testVPPIntrinsicValue</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_v_p_p_test.html#a44dd1d94973358b8b0d5c3103d2b687a">testVPPPricing</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <br class="typebreak"/>
boost::unit_test_framework::test_suite *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_v_p_p_test.html#a09d3d29e115de9bcfb67fce1f7a9f6d0">suite</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="vpp_8hpp_source.html#l00028">28</a> of file <a class="el" href="vpp_8hpp_source.html">vpp.hpp</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a09d3d29e115de9bcfb67fce1f7a9f6d0"></a><!-- doxytag: member="VPPTest::suite" ref="a09d3d29e115de9bcfb67fce1f7a9f6d0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_suite * <a class="el" href="class_v_p_p_test.html#a09d3d29e115de9bcfb67fce1f7a9f6d0">VPPTest::suite</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="vpp_8cpp_source.html#l00891">891</a> of file <a class="el" href="vpp_8cpp_source.html">vpp.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2utilities_8hpp_source.html#l00061">QUANTLIB_TEST_CASE</a>, <a class="el" href="vpp_8cpp_source.html#l00080">testGemanRoncoroniProcess()</a>, <a class="el" href="vpp_8cpp_source.html#l00253">testKlugeExtOUSpreadOption()</a>, <a class="el" href="vpp_8cpp_source.html#l00205">testSimpleExtOUStorageEngine()</a>, <a class="el" href="vpp_8cpp_source.html#l00411">testVPPIntrinsicValue()</a>, and <a class="el" href="vpp_8cpp_source.html#l00549">testVPPPricing()</a>.</p>

<p>Referenced by <a class="el" href="quantlibtestsuite_8cpp_source.html#l00206">init_unit_test_suite()</a>.</p>
<div class="fragment"><pre class="fragment">                           {
    test_suite* <a class="code" href="class_v_p_p_test.html#a09d3d29e115de9bcfb67fce1f7a9f6d0">suite</a> = BOOST_TEST_SUITE(<span class="stringliteral">&quot;VPP Test&quot;</span>);
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_v_p_p_test.html#a6743aa1c0b5737efd530490c00c21f7b">VPPTest::testGemanRoncoroniProcess</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_v_p_p_test.html#a2a60244af07b8df80ad18c96dccd47f4">VPPTest::testSimpleExtOUStorageEngine</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_v_p_p_test.html#ab70027f7cdef86e27e1a6783304d8f96">VPPTest::testKlugeExtOUSpreadOption</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_v_p_p_test.html#a61796a971c03a1e7109a91505d4a466a">VPPTest::testVPPIntrinsicValue</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_v_p_p_test.html#a44dd1d94973358b8b0d5c3103d2b687a">VPPTest::testVPPPricing</a>));

    <span class="keywordflow">return</span> <a class="code" href="class_v_p_p_test.html#a09d3d29e115de9bcfb67fce1f7a9f6d0">suite</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6743aa1c0b5737efd530490c00c21f7b"></a><!-- doxytag: member="VPPTest::testGemanRoncoroniProcess" ref="a6743aa1c0b5737efd530490c00c21f7b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_v_p_p_test.html#a6743aa1c0b5737efd530490c00c21f7b">VPPTest::testGemanRoncoroniProcess</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="vpp_8cpp_source.html#l00080">80</a> of file <a class="el" href="vpp_8cpp_source.html">vpp.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::b</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00138">anonymous_namespace{marketmodel.cpp}::beta</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::d</a>, <a class="el" href="date_8hpp_source.html#l00056">QuantLib::December</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="ql_2math_2randomnumbers_2rngtraits_8hpp_source.html#l00052">QuantLib::GenericPseudoRandom&lt; URNG, IC &gt;::make_sequence_generator()</a>, <a class="el" href="multipathgenerator_8hpp_source.html#l00092">QuantLib::MultiPathGenerator&lt; GSG &gt;::next()</a>, <a class="el" href="timegrid_8hpp_source.html#l00158">QuantLib::TimeGrid::size()</a>, <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>, and <a class="el" href="extendedornsteinuhlenbeckprocess_8hpp_source.html#l00045">QuantLib::ExtendedOrnsteinUhlenbeckProcess::Trapezodial</a>.</p>

<p>Referenced by <a class="el" href="vpp_8cpp_source.html#l00891">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                        {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing Geman Roncoroni process...&quot;</span>);

    <span class="comment">/* Example induced by H. Geman, A. Roncoroni,</span>
<span class="comment">       &quot;Understanding the Fine Structure of Electricity Prices&quot;,</span>
<span class="comment">       http://papers.ssrn.com/sol3/papers.cfm?abstract_id=638322</span>
<span class="comment">       Results are verified against the authors MatLab-Code.</span>
<span class="comment">       http://semeq.unipmn.it/files/Ch19_spark_spread.zip</span>
<span class="comment">    */</span>

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> today = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(18, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4ad4988bf6760edb92c088bb47d4b61dc5">December</a>, 2011);
    Settings::instance().evaluationDate() = today;
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> dc = <a class="code" href="class_quant_lib_1_1_actual_actual.html" title="Actual/Actual day count.">ActualActual</a>();

    boost::shared_ptr&lt;YieldTermStructure&gt; rTS = <a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(today, 0.03, dc);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x0     = 3.3;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a75f63a468538f062319982a22c52c2c4">beta</a>   = 0.05;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alpha  = 3.1;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gamma  = -0.09;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> delta  = 0.07;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> eps    = -0.40;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> zeta   = -0.40;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a06d0bee201af9d379ec8f9563ecf7f66">d</a>      = 1.6;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> k      = 1.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tau    = 0.5;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sig2   = 10.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>      =-7.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>      =-0.3;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta1 = 35.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta2 = 9.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta3 = 0.10;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> psi    = 1.9;

    boost::shared_ptr&lt;GemanRoncoroniProcess&gt; grProcess(
                <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_geman_roncoroni_process.html" title="Geman-Roncoroni process class.">GemanRoncoroniProcess</a>(x0, alpha, beta, gamma, delta,
                                          eps, zeta, d, k, tau, sig2, a, b,
                                          theta1, theta2, theta3, psi));


    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> speed     = 5.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#ae3abfa256de5aa2b506ab6bda014e4dc" title="volatility">Volatility</a> vol = std::sqrt(1.4);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> betaG     = 0.08;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alphaG    = 1.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x0G       = 1.1;

    boost::function&lt;Real (Real)&gt; <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = alphaG + betaG*boost::lambda::_1;

    boost::shared_ptr&lt;StochasticProcess1D&gt; eouProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_extended_ornstein_uhlenbeck_process.html" title="Extended Ornstein-Uhlenbeck process class.">ExtendedOrnsteinUhlenbeckProcess</a>(speed, vol, x0G, f,
                           ExtendedOrnsteinUhlenbeckProcess::Trapezodial));

    std::vector&lt;boost::shared_ptr&lt;StochasticProcess1D&gt; &gt; processes;
    processes.push_back(grProcess);
    processes.push_back(eouProcess);

    <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> correlation(2, 2, 1.0);
    correlation[0][1] = correlation[1][0] = 0.25;

    boost::shared_ptr&lt;StochasticProcess&gt; pArray(
                           <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_stochastic_process_array.html" title="Array of correlated 1-D stochastic processes">StochasticProcessArray</a>(processes, correlation));

    <span class="keyword">const</span> <a class="code" href="class_time.html">Time</a> <a class="code" href="class_t.html">T</a> = 10.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> stepsPerYear = 250;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> steps = <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a>(T*<a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>(stepsPerYear));

    <a class="code" href="class_quant_lib_1_1_time_grid.html" title="time grid class">TimeGrid</a> grid(T, steps);

    <span class="keyword">typedef</span> <a class="code" href="class_quant_lib_1_1_inverse_cumulative_rsg.html" title="Inverse cumulative random sequence generator.">PseudoRandom::rsg_type</a> rsg_type;
    <span class="keyword">typedef</span> <a class="code" href="struct_quant_lib_1_1_sample.html">MultiPathGenerator&lt;rsg_type&gt;::sample_type</a> sample_type;
    rsg_type rsg = PseudoRandom::make_sequence_generator(
                               pArray-&gt;size()*(grid.size()-1), <a class="code" href="namespace_quant_lib.html#a9fbc8c414c2b597d214cca2f9e914740" title="large positive integer">BigNatural</a>(421));

    <a class="code" href="class_quant_lib_1_1_general_statistics.html" title="Statistics tool.">GeneralStatistics</a> npv, onTime;
    <a class="code" href="class_quant_lib_1_1_multi_path_generator.html" title="Generates a multipath from a random number generator.">MultiPathGenerator&lt;rsg_type&gt;</a> generator(pArray, grid, rsg, <span class="keyword">false</span>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> heatRate = 8.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nrTrails = 250;

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n=0; n &lt; nrTrails; ++n) {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> plantValue = 0.0;
        sample_type path = generator.next();

        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=1; i &lt;= steps; ++i) {
            <span class="keyword">const</span> <a class="code" href="class_time.html">Time</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a>(i)/stepsPerYear;
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a05e8e288a4bdedfe5b4e16d8cec14f1c" title="discount factor between dates">DiscountFactor</a> df = rTS-&gt;discount(t);

            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gasPrice         = std::exp(path.value[1][i]);
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> electricityPrice = std::exp(path.value[0][i]);

            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sparkSpread = electricityPrice - heatRate*gasPrice;
            plantValue += std::max(0.0, sparkSpread)*df;
            onTime.add((sparkSpread &gt; 0.0) ? 1.0 : 0.0);
        }

        npv.add(plantValue);
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedNPV = 12500;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculatedNPV = npv.mean();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> errorEstimateNPV = npv.errorEstimate();

    <span class="keywordflow">if</span> (std::fabs(calculatedNPV - expectedNPV) &gt; 3.0*errorEstimateNPV) {
        BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce cached price with MC engine&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculatedNPV
                    &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expectedNPV
                    &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt; errorEstimateNPV);
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedOnTime = 0.43;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculatedOnTime = onTime.mean();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> errorEstimateOnTime
        = std::sqrt(calculatedOnTime*(1-calculatedOnTime))/nrTrails;

    <span class="keywordflow">if</span> (std::fabs(calculatedOnTime - expectedOnTime)&gt;3.0*errorEstimateOnTime) {
        BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce cached price with MC engine&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculatedNPV
                    &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expectedNPV
                    &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt; errorEstimateNPV);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab70027f7cdef86e27e1a6783304d8f96"></a><!-- doxytag: member="VPPTest::testKlugeExtOUSpreadOption" ref="ab70027f7cdef86e27e1a6783304d8f96" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_v_p_p_test.html#ab70027f7cdef86e27e1a6783304d8f96">VPPTest::testKlugeExtOUSpreadOption</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="vpp_8cpp_source.html#l00253">253</a> of file <a class="el" href="vpp_8cpp_source.html">vpp.cpp</a>.</p>

<p>References <a class="el" href="generalstatistics_8hpp_source.html#l00222">QuantLib::GeneralStatistics::add()</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00384">QuantLib::Array::back()</a>, <a class="el" href="option_8hpp_source.html#l00039">QuantLib::Option::Call</a>, <a class="el" href="swingoption_8cpp_source.html#l00049">anonymous_namespace{swingoption.cpp}::createKlugeProcess()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00129">anonymous_namespace{marketmodel.cpp}::dayCounter</a>, <a class="el" href="date_8hpp_source.html#l00056">QuantLib::December</a>, <a class="el" href="generalstatistics_8hpp_source.html#l00205">QuantLib::GeneralStatistics::errorEstimate()</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00618">QuantLib::Exp()</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="ql_2math_2randomnumbers_2rngtraits_8hpp_source.html#l00052">QuantLib::GenericPseudoRandom&lt; URNG, IC &gt;::make_sequence_generator()</a>, <a class="el" href="generalstatistics_8cpp_source.html#l00035">QuantLib::GeneralStatistics::mean()</a>, <a class="el" href="multipathgenerator_8hpp_source.html#l00092">QuantLib::MultiPathGenerator&lt; GSG &gt;::next()</a>, <a class="el" href="instrument_8hpp_source.html#l00186">QuantLib::Instrument::NPV()</a>, <a class="el" href="instrument_8hpp_source.html#l00133">QuantLib::Instrument::setPricingEngine()</a>, <a class="el" href="timegrid_8hpp_source.html#l00158">QuantLib::TimeGrid::size()</a>, <a class="el" href="extendedornsteinuhlenbeckprocess_8hpp_source.html#l00045">QuantLib::ExtendedOrnsteinUhlenbeckProcess::Trapezodial</a>, <a class="el" href="daycounter_8hpp_source.html#l00126">QuantLib::DayCounter::yearFraction()</a>, and <a class="el" href="timeunit_8hpp_source.html#l00040">QuantLib::Years</a>.</p>

<p>Referenced by <a class="el" href="vpp_8cpp_source.html#l00891">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                         {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing Simple Kluge ext-Ornstein-Uhlenbeck spread option...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> settlementDate = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(18, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4ad4988bf6760edb92c088bb47d4b61dc5">December</a>, 2011);
    Settings::instance().evaluationDate() = settlementDate;

    <a class="code" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#abc24484d02b5cded0a275ade16b95733">dayCounter</a> = <a class="code" href="class_quant_lib_1_1_actual_actual.html" title="Actual/Actual day count.">ActualActual</a>();
    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> maturityDate = settlementDate + <a class="code" href="class_quant_lib_1_1_period.html">Period</a>(1, <a class="code" href="namespace_quant_lib.html#a6cdac5e2dae1e972076cc8e3302e4ad3ae2d856134531729a1696e66bebeafb32">Years</a>);
    <a class="code" href="class_time.html">Time</a> maturity = dayCounter.<a class="code" href="class_quant_lib_1_1_day_counter.html#aba442c829252ee786e1b4ea3d0f04bd9" title="Returns the period between two dates as a fraction of year.">yearFraction</a>(settlementDate, maturityDate);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> speed     = 1.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#ae3abfa256de5aa2b506ab6bda014e4dc" title="volatility">Volatility</a> vol = std::sqrt(1.4);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> betaG     = 0.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alphaG    = 3.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x0G       = 3.0;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a919ba3567cc89fca373f8d6b8e80126b" title="interest rates">Rate</a> irRate      = 0.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> heatRate    = 2.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> rho         = 0.5;

    boost::shared_ptr&lt;ExtOUWithJumpsProcess&gt;
                                           klugeProcess = <a class="code" href="namespaceanonymous__namespace_02swingoption_8cpp_03.html#ae98cb912536d35dfdc4d049b31c2e0d9">createKlugeProcess</a>();
    boost::function&lt;Real (Real)&gt; <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a> = alphaG + betaG*boost::lambda::_1;

    boost::shared_ptr&lt;ExtendedOrnsteinUhlenbeckProcess&gt; extOUProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_extended_ornstein_uhlenbeck_process.html" title="Extended Ornstein-Uhlenbeck process class.">ExtendedOrnsteinUhlenbeckProcess</a>(speed, vol, x0G, f,
                           ExtendedOrnsteinUhlenbeckProcess::Trapezodial));

    boost::shared_ptr&lt;YieldTermStructure&gt; rTS(
                                <a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(settlementDate, irRate, dayCounter));

    boost::shared_ptr&lt;KlugeExtOUProcess&gt; klugeOUProcess(
                    <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_kluge_ext_o_u_process.html">KlugeExtOUProcess</a>(rho, klugeProcess, extOUProcess));


    boost::shared_ptr&lt;Payoff&gt; payoff(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_plain_vanilla_payoff.html" title="Plain-vanilla payoff.">PlainVanillaPayoff</a>(Option::Call, 0.0));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> spreadFactors(2);
    spreadFactors[0] = 1.0; spreadFactors[1] = -heatRate;
    boost::shared_ptr&lt;BasketPayoff&gt; basketPayoff(
                               <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_average_basket_payoff.html">AverageBasketPayoff</a>(payoff, spreadFactors));

    boost::shared_ptr&lt;Exercise&gt; exercise(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_european_exercise.html" title="European exercise.">EuropeanExercise</a>(maturityDate));

    <a class="code" href="class_quant_lib_1_1_basket_option.html" title="Basket option on a number of assets.">BasketOption</a> option(basketPayoff, exercise);
    option.setPricingEngine(boost::shared_ptr&lt;PricingEngine&gt;(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fd_kluge_ext_o_u_spread_engine.html">FdKlugeExtOUSpreadEngine</a>(klugeOUProcess, rTS,
                                     5, 200, 50, 20)));

    <a class="code" href="class_quant_lib_1_1_time_grid.html" title="time grid class">TimeGrid</a> grid(maturity, 50);
    <span class="keyword">typedef</span> <a class="code" href="class_quant_lib_1_1_inverse_cumulative_rsg.html" title="Inverse cumulative random sequence generator.">PseudoRandom::rsg_type</a> rsg_type;
    <span class="keyword">typedef</span> <a class="code" href="struct_quant_lib_1_1_sample.html">MultiPathGenerator&lt;rsg_type&gt;::sample_type</a> sample_type;

    rsg_type rsg = PseudoRandom::make_sequence_generator(
                           klugeOUProcess-&gt;factors()*(grid.size()-1), 1234ul);

    <a class="code" href="class_quant_lib_1_1_multi_path_generator.html" title="Generates a multipath from a random number generator.">MultiPathGenerator&lt;rsg_type&gt;</a> generator(klugeOUProcess, grid, rsg, <span class="keyword">false</span>);


    <a class="code" href="class_quant_lib_1_1_general_statistics.html" title="Statistics tool.">GeneralStatistics</a> npv;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nTrails = 20000;
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; nTrails; ++i) {
        <span class="keyword">const</span> sample_type path = generator.next();

        <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> p(2);
        p[0] = path.value[0].back() + path.value[1].back();
        p[1] = path.value[2].back();
        npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#ad3a191db3b8499fe3ca40b2767566c37" title="adds a datum to the set, possibly with a weight">add</a>((*basketPayoff)(<a class="code" href="namespace_quant_lib.html#a2b771571c200e1b50cd7a697cc919508">Exp</a>(p)));
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = option.NPV();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedMC = npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#a054bb4330c1dcde6176dd281f76e87a1">mean</a>();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> mcError = npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#af6a95e6f21454454e9f8f7caba211f8f">errorEstimate</a>();
    <span class="keywordflow">if</span> (std::fabs(expectedMC - calculated) &gt; 3*mcError) {
            BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce referenc values&quot;</span>
                       &lt;&lt; <span class="stringliteral">&quot;\n    calculated:   &quot;</span> &lt;&lt; calculated
                       &lt;&lt; <span class="stringliteral">&quot;\n    expected(MC): &quot;</span> &lt;&lt; expectedMC
                       &lt;&lt; <span class="stringliteral">&quot;\n    mc error    : &quot;</span> &lt;&lt; mcError);

    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a60244af07b8df80ad18c96dccd47f4"></a><!-- doxytag: member="VPPTest::testSimpleExtOUStorageEngine" ref="a2a60244af07b8df80ad18c96dccd47f4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_v_p_p_test.html#a2a60244af07b8df80ad18c96dccd47f4">VPPTest::testSimpleExtOUStorageEngine</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="vpp_8cpp_source.html#l00205">205</a> of file <a class="el" href="vpp_8cpp_source.html">vpp.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00129">anonymous_namespace{marketmodel.cpp}::dayCounter</a>, <a class="el" href="timeunit_8hpp_source.html#l00037">QuantLib::Days</a>, <a class="el" href="date_8hpp_source.html#l00056">QuantLib::December</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="timeunit_8hpp_source.html#l00039">QuantLib::Months</a>, <a class="el" href="instrument_8hpp_source.html#l00186">QuantLib::Instrument::NPV()</a>, <a class="el" href="instrument_8hpp_source.html#l00133">QuantLib::Instrument::setPricingEngine()</a>, and <a class="el" href="dataformatters_8hpp_source.html#l00133">QuantLib::io::volatility()</a>.</p>

<p>Referenced by <a class="el" href="vpp_8cpp_source.html#l00891">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                           {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing Simple Storage option based on ext. OU model...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> settlementDate = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(18, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4ad4988bf6760edb92c088bb47d4b61dc5">December</a>, 2011);
    Settings::instance().evaluationDate() = settlementDate;
    <a class="code" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#abc24484d02b5cded0a275ade16b95733">dayCounter</a> = <a class="code" href="class_quant_lib_1_1_actual_actual.html" title="Actual/Actual day count.">ActualActual</a>();
    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> maturityDate = settlementDate + <a class="code" href="class_quant_lib_1_1_period.html">Period</a>(12, <a class="code" href="namespace_quant_lib.html#a6cdac5e2dae1e972076cc8e3302e4ad3a3d158b618e2bf6e66da9aca81f706dae">Months</a>);

    std::vector&lt;Date&gt; exerciseDates(1, settlementDate+<a class="code" href="class_quant_lib_1_1_period.html">Period</a>(1, <a class="code" href="namespace_quant_lib.html#a6cdac5e2dae1e972076cc8e3302e4ad3ac2d73aad1a6496a6481563e7b5e62b36">Days</a>));
    <span class="keywordflow">while</span> (exerciseDates.back() &lt; maturityDate) {
        exerciseDates.push_back(exerciseDates.back()+<a class="code" href="class_quant_lib_1_1_period.html">Period</a>(1, <a class="code" href="namespace_quant_lib.html#a6cdac5e2dae1e972076cc8e3302e4ad3ac2d73aad1a6496a6481563e7b5e62b36">Days</a>));
    }
    boost::shared_ptr&lt;BermudanExercise&gt; bermudanExercise(
                                        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_bermudan_exercise.html" title="Bermudan exercise.">BermudanExercise</a>(exerciseDates));

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x0 = 3.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> speed = 1.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="group__manips.html#ga9890b88f8d11494a518492be973b9046" title="output volatilities as percentages">volatility</a> = 0.5;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a919ba3567cc89fca373f8d6b8e80126b" title="interest rates">Rate</a> irRate = 0.1;

    boost::shared_ptr&lt;ExtendedOrnsteinUhlenbeckProcess&gt; ouProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_extended_ornstein_uhlenbeck_process.html" title="Extended Ornstein-Uhlenbeck process class.">ExtendedOrnsteinUhlenbeckProcess</a>(speed, volatility, x0,
                                             <a class="code" href="class_quant_lib_1_1constant.html">constant&lt;Real, Real&gt;</a>(x0)));

    boost::shared_ptr&lt;YieldTermStructure&gt; rTS(
                                <a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(settlementDate, irRate, dayCounter));

    boost::shared_ptr&lt;PricingEngine&gt; storageEngine(
               <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fd_simple_ext_o_u_storage_engine.html">FdSimpleExtOUStorageEngine</a>(ouProcess, rTS, 1, 25));

    <a class="code" href="class_quant_lib_1_1_vanilla_storage_option.html" title="base option class">VanillaStorageOption</a> storageOption(bermudanExercise, 50, 0, 1);

    storageOption.setPricingEngine(storageEngine);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = 69.5755;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = storageOption.NPV();

    <span class="keywordflow">if</span> (std::fabs(expected - calculated) &gt; 5e-2) {
        BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce cached values&quot;</span> &lt;&lt;
                    <span class="stringliteral">&quot;\n calculated: &quot;</span> &lt;&lt; calculated &lt;&lt;
                    <span class="stringliteral">&quot;\n   expected: &quot;</span> &lt;&lt; expected);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a61796a971c03a1e7109a91505d4a466a"></a><!-- doxytag: member="VPPTest::testVPPIntrinsicValue" ref="a61796a971c03a1e7109a91505d4a466a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_v_p_p_test.html#a61796a971c03a1e7109a91505d4a466a">VPPTest::testVPPIntrinsicValue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="vpp_8cpp_source.html#l00411">411</a> of file <a class="el" href="vpp_8cpp_source.html">vpp.cpp</a>.</p>

<p>References <a class="el" href="ql_2math_2array_8hpp_source.html#l00429">QuantLib::Array::begin()</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00437">QuantLib::Array::end()</a>, <a class="el" href="vpp_8cpp_source.html#l00341">anonymous_namespace{vpp.cpp}::gasPrices</a>, and <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>.</p>

<p>Referenced by <a class="el" href="vpp_8cpp_source.html#l00891">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                    {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing VPP step condition...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <span class="comment">// vpp parameters</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> pMin           = 8;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> pMax           = 40;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> tMinUp         = 2;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> tMinDown       = 2;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> startUpFuel    = 20;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> startUpFixCost = 100;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> carbonPrice    = 3.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nStarts        = <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> stateDirection = 0;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nStates = ((nStarts == <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>()) ? 1 : nStarts)*
                         (2*tMinUp + tMinDown);

    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(1, nStates);
    <span class="keyword">const</span> boost::shared_ptr&lt;FdmLinearOpLayout&gt; layout(
                                                   <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    <span class="keyword">const</span> boost::shared_ptr&lt;FdmMesher&gt; mesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_mesher_composite.html">FdmMesherComposite</a>(layout,
             std::vector&lt;boost::shared_ptr&lt;Fdm1dMesher&gt; &gt;(1,
                                boost::shared_ptr&lt;Fdm1dMesher&gt;(
                                    <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform1d_mesher.html">Uniform1dMesher</a>(0.0, 1.0, nStates)))));

    <span class="keyword">const</span> boost::shared_ptr&lt;FdmInnerValueCalculator&gt; gasPrice(<span class="keyword">new</span> GasPrice());

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> efficiency[] = { 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.9 };

    <span class="comment">// Expected values are calculated using mixed integer programming</span>
    <span class="comment">// based on the gnu linear programming toolkit. For details please see:</span>
    <span class="comment">// http://spanderen.de/</span>
    <span class="comment">//        2011/06/23/vpp-pricing-ii-mixed-integer-linear-programming/</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected[] = { 0.0, 2056.04, 11145.577778, 26452.04,
                              44512.461818, 62000.626667, 137591.911111};

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; <a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(efficiency); ++i) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> heatRate = 1.0/efficiency[i];
        <span class="keyword">const</span> boost::shared_ptr&lt;FdmInnerValueCalculator&gt; sparkSpreadPrice(
                                              <span class="keyword">new</span> SparkSpreadPrice(heatRate));

        boost::shared_ptr&lt;StepCondition&lt;Array&gt; &gt; stepCondition(
            <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_v_p_p_step_condition.html">FdmVPPStepCondition</a>(heatRate,
                                    pMin, pMax,
                                    tMinUp, tMinDown,
                                    nStarts,
                                    startUpFuel, startUpFixCost,
                                    carbonPrice, stateDirection,
                                    mesher, gasPrice, sparkSpreadPrice));

        <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> state(nStates, 0.0);
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(<a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#ade08b0fa7b99018e0706b5982490417f">gasPrices</a>); j &gt; 0; --j) {
            stepCondition-&gt;applyTo(state, (<a class="code" href="class_time.html">Time</a>) j-1);
        }
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = *std::max_element(state.begin(), state.end());
        <span class="keywordflow">if</span> (std::fabs(expected[i] - calculated) &gt; 1e-2) {
            BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce reference values&quot;</span>
                       &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                       &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected[i]);

        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a44dd1d94973358b8b0d5c3103d2b687a"></a><!-- doxytag: member="VPPTest::testVPPPricing" ref="a44dd1d94973358b8b0d5c3103d2b687a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_v_p_p_test.html#a44dd1d94973358b8b0d5c3103d2b687a">VPPTest::testVPPPricing</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="vpp_8cpp_source.html#l00549">549</a> of file <a class="el" href="vpp_8cpp_source.html">vpp.cpp</a>.</p>

<p>References <a class="el" href="generalstatistics_8hpp_source.html#l00222">QuantLib::GeneralStatistics::add()</a>, <a class="el" href="multipathgenerator_8hpp_source.html#l00098">QuantLib::MultiPathGenerator&lt; GSG &gt;::antithetic()</a>, <a class="el" href="fdmvppstepcondition_8cpp_source.html#l00088">QuantLib::FdmVPPStepCondition::applyTo()</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00370">QuantLib::Array::at()</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00384">QuantLib::Array::back()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00138">anonymous_namespace{marketmodel.cpp}::beta</a>, <a class="el" href="generallinearleastsquares_8hpp_source.html#l00059">QuantLib::GeneralLinearLeastSquares::coefficients()</a>, <a class="el" href="date_8hpp_source.html#l00056">QuantLib::December</a>, <a class="el" href="generalstatistics_8hpp_source.html#l00205">QuantLib::GeneralStatistics::errorEstimate()</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00377">QuantLib::Array::front()</a>, <a class="el" href="vpp_8cpp_source.html#l00341">anonymous_namespace{vpp.cpp}::gasPrices</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="ql_2math_2randomnumbers_2rngtraits_8hpp_source.html#l00052">QuantLib::GenericPseudoRandom&lt; URNG, IC &gt;::make_sequence_generator()</a>, <a class="el" href="generalstatistics_8cpp_source.html#l00035">QuantLib::GeneralStatistics::mean()</a>, <a class="el" href="lsmbasissystem_8hpp_source.html#l00039">QuantLib::LsmBasisSystem::Monomial</a>, <a class="el" href="lsmbasissystem_8cpp_source.html#l00144">QuantLib::LsmBasisSystem::multiPathBasisSystem()</a>, <a class="el" href="multipathgenerator_8hpp_source.html#l00092">QuantLib::MultiPathGenerator&lt; GSG &gt;::next()</a>, <a class="el" href="instrument_8hpp_source.html#l00186">QuantLib::Instrument::NPV()</a>, <a class="el" href="vpp_8cpp_source.html#l00363">anonymous_namespace{vpp.cpp}::powerPrices</a>, <a class="el" href="generalstatistics_8hpp_source.html#l00228">QuantLib::GeneralStatistics::reset()</a>, <a class="el" href="instrument_8hpp_source.html#l00133">QuantLib::Instrument::setPricingEngine()</a>, <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00433">anonymous_namespace{perturbativebarrieroptionengine.cpp}::v()</a>, and <a class="el" href="daycounter_8hpp_source.html#l00126">QuantLib::DayCounter::yearFraction()</a>.</p>

<p>Referenced by <a class="el" href="vpp_8cpp_source.html#l00891">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                             {
    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing VPP pricing using perfect foresight or FDM...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> today = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(18, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4ad4988bf6760edb92c088bb47d4b61dc5">December</a>, 2011);
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> dc = <a class="code" href="class_quant_lib_1_1_actual_actual.html" title="Actual/Actual day count.">ActualActual</a>();
    Settings::instance().evaluationDate() = today;

    <span class="comment">// vpp paramter</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> heatRate       = 2.5;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> pMin           = 8;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> pMax           = 40;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> tMinUp         = 6;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> tMinDown       = 2;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> startUpFuel    = 20;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> startUpFixCost = 100;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nStates        = 2u*tMinUp + tMinDown;

    boost::shared_ptr&lt;SwingExercise&gt; exercise(
                                <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_swing_exercise.html" title="Swing exercise.">SwingExercise</a>(today, today+6, 3600u));

    <a class="code" href="class_quant_lib_1_1_vanilla_v_p_p_option.html">VanillaVPPOption</a> vppOption(heatRate, pMin, pMax,
                               tMinUp, tMinDown,
                               <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>(),
                               startUpFuel, startUpFixCost,
                               exercise);

    <span class="comment">// model definition</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a75f63a468538f062319982a22c52c2c4">beta</a>         = 200;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> eta          = 1.0/0.2;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> lambda       = 4.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> alpha        = 7.0;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> volatility_x = 1.4;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> kappa        = 4.45;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> volatility_u = std::sqrt(1.3);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> rho          = 0.7;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a919ba3567cc89fca373f8d6b8e80126b" title="interest rates">Rate</a> irRate       = 0.00;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> carbonPrice  = 3.0;

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> x0(2);
    x0[0] = 0.0; x0[1] = 0.0;

    <span class="keyword">const</span> boost::shared_ptr&lt;ExtendedOrnsteinUhlenbeckProcess&gt; ouProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_extended_ornstein_uhlenbeck_process.html" title="Extended Ornstein-Uhlenbeck process class.">ExtendedOrnsteinUhlenbeckProcess</a>(alpha, volatility_x, x0[0],
                                             <a class="code" href="class_quant_lib_1_1constant.html">constant&lt;Real, Real&gt;</a>(x0[0])));
    <span class="keyword">const</span> boost::shared_ptr&lt;ExtOUWithJumpsProcess&gt; lnPowerProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_ext_o_u_with_jumps_process.html">ExtOUWithJumpsProcess</a>(ouProcess, x0[1], beta, lambda, eta));

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> u=0.0;
    <span class="keyword">const</span> boost::shared_ptr&lt;ExtendedOrnsteinUhlenbeckProcess&gt; lnGasProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_extended_ornstein_uhlenbeck_process.html" title="Extended Ornstein-Uhlenbeck process class.">ExtendedOrnsteinUhlenbeckProcess</a>(kappa, volatility_u, u,
                                             <a class="code" href="class_quant_lib_1_1constant.html">constant&lt;Real, Real&gt;</a>(u)));

    <span class="keyword">const</span> boost::shared_ptr&lt;KlugeExtOUProcess&gt; klugeOUProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_kluge_ext_o_u_process.html">KlugeExtOUProcess</a>(rho, lnPowerProcess, lnGasProcess));

    <span class="keyword">const</span> boost::shared_ptr&lt;YieldTermStructure&gt; rTS
        = <a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(today, irRate, dc);


    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nHours = <a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(<a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#a2325faab0206cbc021c2d7178e09aa03">powerPrices</a>);

    <span class="keyword">typedef</span> <a class="code" href="class_quant_lib_1_1_fd_simple_kluge_ext_o_u_v_p_p_engine.html#aa10a0dc6cb9215b20f794ab7d78a3b5e">FdSimpleKlugeExtOUVPPEngine::Shape</a> Shape;
    boost::shared_ptr&lt;Shape&gt; gasShape(<span class="keyword">new</span> Shape(nHours));
    boost::shared_ptr&lt;Shape&gt; powerShape(<span class="keyword">new</span> Shape(nHours));

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; nHours; ++i) {
        <span class="keyword">const</span> <a class="code" href="class_time.html">Time</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = (i+1)/(365*24.);

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gasPrice = <a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#ade08b0fa7b99018e0706b5982490417f">gasPrices</a>[i];
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gs = std::log(gasPrice)-<a class="code" href="class_quant_lib_1_1square.html">square&lt;Real&gt;</a>()(volatility_u)
                               /(4*kappa)*(1-std::exp(-2*kappa*t));
        (*gasShape)[i] = Shape::value_type(t, gs);

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> powerPrice = <a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#a2325faab0206cbc021c2d7178e09aa03">powerPrices</a>[i];
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> ps = std::log(powerPrice)-<a class="code" href="class_quant_lib_1_1square.html">square&lt;Real&gt;</a>()(volatility_x)
                 /(4*alpha)*(1-std::exp(-2*alpha*t))
                -lambda/beta*std::log((eta-std::exp(-beta*t))/(eta-1.0));

        (*powerShape)[i] = Shape::value_type(t, ps);
    }

    <span class="comment">// Test: intrinsic value</span>
    <span class="keyword">const</span> boost::shared_ptr&lt;FdmMesher&gt; oneDimMesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_mesher_composite.html">FdmMesherComposite</a>(boost::shared_ptr&lt;FdmLinearOpLayout&gt;(
            <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(std::vector&lt;Size&gt;(1, nStates))),
            std::vector&lt;boost::shared_ptr&lt;Fdm1dMesher&gt; &gt;(1,
                boost::shared_ptr&lt;Fdm1dMesher&gt;(
                    <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform1d_mesher.html">Uniform1dMesher</a>(0.0, 1.0, nStates)))));

    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_v_p_p_step_condition.html">FdmVPPStepCondition</a> stepCondition(
            heatRate, pMin, pMax, tMinUp, tMinDown, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>(),
            startUpFuel, startUpFixCost, carbonPrice, 0u, oneDimMesher,
            boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(<span class="keyword">new</span> GasPrice()),
            boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(
               <span class="keyword">new</span> SparkSpreadPrice(heatRate)));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> state(nStates, 0.0);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=exercise-&gt;dates().size(); j &gt; 0; --j) {
        stepCondition.applyTo(state, (<a class="code" href="class_time.html">Time</a>) j-1);
    }
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> intrinsic = state.back();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedIntrinsic = 2056.04;
    <span class="keywordflow">if</span> (std::fabs(intrinsic - expectedIntrinsic) &gt; 0.1) {
        BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce intrinsic value&quot;</span>
                   &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; intrinsic
                   &lt;&lt; <span class="stringliteral">&quot;\n    expected  : &quot;</span> &lt;&lt; expectedIntrinsic);
    }

    <span class="comment">// Test: finite difference price</span>
    <span class="keyword">const</span> boost::shared_ptr&lt;PricingEngine&gt; <a class="code" href="class_quant_lib_1_1engine.html">engine</a>(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fd_simple_kluge_ext_o_u_v_p_p_engine.html">FdSimpleKlugeExtOUVPPEngine</a>(klugeOUProcess, rTS, carbonPrice,
                                        1, 25, 11, 10,
                                        gasShape, powerShape));

    vppOption.setPricingEngine(<a class="code" href="class_quant_lib_1_1engine.html">engine</a>);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fdmPrice = vppOption.NPV();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedFdmPrice = 5217.68;
    <span class="keywordflow">if</span> (std::fabs(fdmPrice - expectedFdmPrice) &gt; 0.1) {
       BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce finite difference price&quot;</span>
                   &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; fdmPrice
                   &lt;&lt; <span class="stringliteral">&quot;\n    expected  : &quot;</span> &lt;&lt; expectedFdmPrice);
    }

    <span class="comment">// Test: Monte-Carlo perfect foresight price</span>
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_time_grid.html" title="time grid class">TimeGrid</a> grid(dc.<a class="code" href="class_quant_lib_1_1_day_counter.html#aba442c829252ee786e1b4ea3d0f04bd9" title="Returns the period between two dates as a fraction of year.">yearFraction</a>(today, exercise-&gt;lastDate()+1),
                        exercise-&gt;dates().size());
    <span class="keyword">typedef</span> <a class="code" href="class_quant_lib_1_1_inverse_cumulative_rsg.html" title="Inverse cumulative random sequence generator.">PseudoRandom::rsg_type</a> rsg_type;
    <span class="keyword">typedef</span> <a class="code" href="struct_quant_lib_1_1_sample.html">MultiPathGenerator&lt;rsg_type&gt;::sample_type</a> sample_type;

    rsg_type rsg = PseudoRandom::make_sequence_generator(
                           klugeOUProcess-&gt;factors()*(grid.size()-1), 1234ul);
    <a class="code" href="class_quant_lib_1_1_multi_path_generator.html" title="Generates a multipath from a random number generator.">MultiPathGenerator&lt;rsg_type&gt;</a> generator(klugeOUProcess, grid, rsg, <span class="keyword">false</span>);

    <a class="code" href="class_quant_lib_1_1_general_statistics.html" title="Statistics tool.">GeneralStatistics</a> npv;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nTrails = 2500;

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; nTrails; ++i) {
        <span class="keyword">const</span> sample_type&amp; path = generator.next();

        <a class="code" href="class_quant_lib_1_1_fdm_v_p_p_step_condition.html">FdmVPPStepCondition</a> stepCondition(
            heatRate, pMin, pMax, tMinUp, tMinDown, <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>(),
            startUpFuel, startUpFixCost, carbonPrice, 0u, oneDimMesher,
            boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(
                <span class="keyword">new</span> PathGasPrice(path.value, gasShape)),
            boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(
                <span class="keyword">new</span> PathSparkSpreadPrice(heatRate, path.value,
                                         gasShape, powerShape)));

        <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> state(nStates, 0.0);
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=exercise-&gt;dates().size(); j &gt; 0; --j) {
            stepCondition.applyTo(state, grid.at(j));
            state*=rTS-&gt;discount(grid.at(j))/rTS-&gt;discount(grid.at(j-1));
        }

        npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#ad3a191db3b8499fe3ca40b2767566c37" title="adds a datum to the set, possibly with a weight">add</a>(state.back());
    }
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> npvMC = npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#a054bb4330c1dcde6176dd281f76e87a1">mean</a>();
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> errorMC = npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#af6a95e6f21454454e9f8f7caba211f8f">errorEstimate</a>();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedMC = 5250.0;
    <span class="keywordflow">if</span> (std::fabs(npvMC-expectedMC) &gt; 3*errorMC) {
        BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce Monte-Carlo price&quot;</span>
                   &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; npvMC
                   &lt;&lt; <span class="stringliteral">&quot;\n    error     ; &quot;</span> &lt;&lt; errorMC
                   &lt;&lt; <span class="stringliteral">&quot;\n    expected  : &quot;</span> &lt;&lt; expectedMC);
    }
    npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#a3e240328f09a7420ca357bd6ccad6ef3" title="resets the data to a null set">reset</a>();

    <span class="comment">// Test: Longstaff Schwartz least square Monte-Carlo</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nCalibrationTrails = 1000u;
    std::vector&lt;sample_type&gt; calibrationPaths;
    std::vector&lt;boost::shared_ptr&lt;FdmVPPStepCondition&gt; &gt; stepConditions;
    std::vector&lt;boost::shared_ptr&lt;FdmInnerValueCalculator&gt; &gt; sparkSpreads;

    sparkSpreads.reserve(nCalibrationTrails);
    stepConditions.reserve(nCalibrationTrails);
    calibrationPaths.reserve(nCalibrationTrails);

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; nCalibrationTrails; ++i) {
        calibrationPaths.push_back(generator.next());

        sparkSpreads.push_back(boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(
            <span class="keyword">new</span> PathSparkSpreadPrice(heatRate, calibrationPaths.back().value,
                                     gasShape, powerShape)));

        stepConditions.push_back(boost::shared_ptr&lt;FdmVPPStepCondition&gt;(
            <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_v_p_p_step_condition.html">FdmVPPStepCondition</a>(
                heatRate, pMin, pMax, tMinUp, tMinDown,<a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>(),
                startUpFuel, startUpFixCost, carbonPrice, 0u, oneDimMesher,
                boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(
                    <span class="keyword">new</span> PathGasPrice(calibrationPaths.back().value, gasShape)),
                sparkSpreads.back())));
    }


    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = oneDimMesher-&gt;layout()-&gt;begin();

    <span class="comment">// prices of all calibration paths for all states</span>
    std::vector&lt;Array&gt; prices(nCalibrationTrails, <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(nStates, 0.0));

    <span class="comment">// regression coefficients for all states and all exercise dates</span>
    std::vector&lt;std::vector&lt;Array&gt; &gt; coeff(
        nStates, std::vector&lt;Array&gt;(exercise-&gt;dates().size(), <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>()));

    <span class="comment">// regression functions</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dim = 1u;
    std::vector&lt;boost::function1&lt;Real, Array&gt; &gt; <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>(
        LsmBasisSystem::multiPathBasisSystem(dim,5u, LsmBasisSystem::Monomial));

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=exercise-&gt;dates().size(); i &gt; 0u; --i) {
        <span class="keyword">const</span> <a class="code" href="class_time.html">Time</a> t = grid.at(i);

        std::vector&lt;Array&gt; x(nCalibrationTrails, <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(dim));

        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; nCalibrationTrails; ++j) {
            x[j][0] = sparkSpreads[j]-&gt;innerValue(iter, t);
        }

        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k &lt; nStates; ++k) {
            std::vector&lt;Real&gt; y(nCalibrationTrails);

            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; nCalibrationTrails; ++j) {
                y[j] = prices[j][k];
            }
            coeff[k][i-1] = <a class="code" href="class_quant_lib_1_1_general_linear_least_squares.html" title="general linear least squares regression">GeneralLinearLeastSquares</a>(x, y, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>).<a class="code" href="class_quant_lib_1_1_general_linear_least_squares.html#aa3bdc7ac4113bb4bdc54e6d40800e31d">coefficients</a>();

            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; nCalibrationTrails; ++j) {
                prices[j][k] = 0.0;
                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> l=0; l &lt; <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>.size(); ++l) {
                    prices[j][k] += coeff[k][i-1][l]*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>[l](x[j]);
                }
            }
        }

        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; nCalibrationTrails; ++j) {
            stepConditions[j]-&gt;applyTo(prices[j], grid.at(i));
        }
    }

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tmpValue = 0.0;
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; nTrails; ++i) {
        <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> x(dim), state(nStates, 0.0), contState(nStates, 0.0);

        <span class="keyword">const</span> sample_type&amp; path = (i % 2) ? generator.antithetic()
                                          : generator.next();

        <span class="keyword">const</span> boost::shared_ptr&lt;FdmInnerValueCalculator&gt; <a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#ade08b0fa7b99018e0706b5982490417f">gasPrices</a>(
            <span class="keyword">new</span> PathGasPrice(path.value, gasShape));

        <span class="keyword">const</span> boost::shared_ptr&lt;FdmInnerValueCalculator&gt; sparkSpreads(
            <span class="keyword">new</span> PathSparkSpreadPrice(heatRate, path.value,
                                     gasShape, powerShape));

        <a class="code" href="class_quant_lib_1_1_fdm_v_p_p_step_condition.html">FdmVPPStepCondition</a> stepCondition(
            heatRate, pMin, pMax, tMinUp, tMinDown,<a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Size&gt;</a>(),
            startUpFuel, startUpFixCost, carbonPrice, 0u, oneDimMesher,
            <a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#ade08b0fa7b99018e0706b5982490417f">gasPrices</a>, sparkSpreads);

        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=exercise-&gt;dates().size(); j &gt; 0u; --j) {
            <span class="keyword">const</span> <a class="code" href="class_time.html">Time</a> t = grid.at(j);
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gasPrice = <a class="code" href="namespaceanonymous__namespace_02vpp_8cpp_03.html#ade08b0fa7b99018e0706b5982490417f">gasPrices</a>-&gt;innerValue(iter, t);
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sparkSpread = sparkSpreads-&gt;innerValue(iter, t);
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> startUpCost
                    = startUpFixCost + (gasPrice + carbonPrice)*startUpFuel;

            x[0] = sparkSpread;
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k &lt; nStates; ++k) {
                contState[k] = 0.0;
                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> l=0; l &lt; <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>.size(); ++l) {
                    contState[k] += coeff[k][j-1][l]*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>[l](x);
                }
            }

            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> pMinFlow = pMin*(sparkSpread - heatRate*carbonPrice);
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> pMaxFlow = pMax*(sparkSpread - heatRate*carbonPrice);

            <span class="comment">// rollback continuation states and the path states</span>
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; 2*tMinUp; ++i) {
                <span class="keywordflow">if</span> (i &lt; tMinUp) {
                    state[i]    += pMinFlow;
                    contState[i]+= pMinFlow;
                }
                <span class="keywordflow">else</span> {
                    state[i]    += pMaxFlow;
                    contState[i]+= pMaxFlow;
                }
            }

            <span class="comment">// dynamic programming using the continuation values</span>
            <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> retVal(nStates);
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; tMinUp-1; ++i) {
                retVal[i] = retVal[tMinUp + i]
                          = (contState[i+1] &gt; contState[tMinUp + i+1])?
                                          state[i+1] : state[tMinUp + i+1];
            }

            <span class="keywordflow">if</span> (contState[2*tMinUp] &gt;=
                std::max(contState[tMinUp-1], contState[2*tMinUp-1])) {
                retVal[tMinUp-1] = retVal[2*tMinUp-1] = state[2*tMinUp];
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (contState[tMinUp-1] &gt;= contState[2*tMinUp-1]) {
                retVal[tMinUp-1] = retVal[2*tMinUp-1] = state[tMinUp-1];
            }
            <span class="keywordflow">else</span> {
                retVal[tMinUp-1] = retVal[2*tMinUp-1] = state[2*tMinUp-1];
            }

            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; tMinDown-1; ++i) {
                retVal[2*tMinUp + i] = state[2*tMinUp + i+1];
            }

            <span class="keywordflow">if</span> (contState.back() &gt;=
                std::max(contState.front(), contState[tMinUp]) - startUpCost) {
                retVal.back() = state.back();
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (contState.front() &gt;  contState[tMinUp]) {
                retVal.back() = state.front()-startUpCost;
            }
            <span class="keywordflow">else</span> {
                retVal.back() = state[tMinUp]-startUpCost;
            }
            state = retVal;
        }
        tmpValue+=0.5*state.back();
        <span class="keywordflow">if</span> ((i%2)) {
            npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#ad3a191db3b8499fe3ca40b2767566c37" title="adds a datum to the set, possibly with a weight">add</a>(tmpValue, 1.0);
            tmpValue = 0.0;
        }
    }

    npvMC = npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#a054bb4330c1dcde6176dd281f76e87a1">mean</a>();
    errorMC = npv.<a class="code" href="class_quant_lib_1_1_general_statistics.html#af6a95e6f21454454e9f8f7caba211f8f">errorEstimate</a>();
    <span class="keywordflow">if</span> (std::fabs(npvMC-fdmPrice) &gt; 3*errorMC) {
        BOOST_ERROR(<span class="stringliteral">&quot;Failed to reproduce Least Square Monte-Carlo price&quot;</span>
                   &lt;&lt; <span class="stringliteral">&quot;\n    calculated   : &quot;</span> &lt;&lt; npvMC
                   &lt;&lt; <span class="stringliteral">&quot;\n    error        : &quot;</span> &lt;&lt; errorMC
                   &lt;&lt; <span class="stringliteral">&quot;\n    expected FDM : &quot;</span> &lt;&lt; fdmPrice);
    }
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/test-suite/<a class="el" href="vpp_8hpp_source.html">vpp.hpp</a></li>
<li>/home/deriversatile/QuantLib/QuantLibQt/test-suite/<a class="el" href="vpp_8cpp_source.html">vpp.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_v_p_p_test.html">VPPTest</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:02 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
