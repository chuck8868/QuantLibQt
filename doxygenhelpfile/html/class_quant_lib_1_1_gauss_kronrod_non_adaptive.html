<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: QuantLib::GaussKronrodNonAdaptive Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_quant_lib_1_1_gauss_kronrod_non_adaptive.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">QuantLib::GaussKronrodNonAdaptive Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="QuantLib::GaussKronrodNonAdaptive" --><!-- doxytag: inherits="QuantLib::Integrator" -->
<p>Integral of a 1-dimensional function using the Gauss-Kronrod methods.  
 <a href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="kronrodintegral_8hpp_source.html">kronrodintegral.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for QuantLib::GaussKronrodNonAdaptive:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_lib_1_1_gauss_kronrod_non_adaptive__inherit__graph.png" border="0" usemap="#_quant_lib_1_1_gauss_kronrod_non_adaptive_inherit__map" alt="Inheritance graph"/></div>
<map name="_quant_lib_1_1_gauss_kronrod_non_adaptive_inherit__map" id="_quant_lib_1_1_gauss_kronrod_non_adaptive_inherit__map">
<area shape="rect" id="node2" href="class_quant_lib_1_1_integrator.html" title="{QuantLib::Integrator\n|&#45; absoluteAccuracy_\l&#45; absoluteError_\l&#45; maxEvaluations_\l&#45; evaluations_\l|+ Integrator()\l+ ~Integrator()\l+ operator()()\l+ absoluteError()\l+ numberOfEvaluations()\l+ integrationSuccess()\l+ setAbsoluteAccuracy()\l+ setMaxEvaluations()\l+ absoluteAccuracy()\l+ maxEvaluations()\l# integrate()\l# setAbsoluteError()\l# setNumberOfEvaluations()\l# increaseNumberOfEvaluations()\l* setAbsoluteAccuracy()\l* setMaxEvaluations()\l* absoluteAccuracy()\l* maxEvaluations()\l}" alt="" coords="16,5,235,437"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for QuantLib::GaussKronrodNonAdaptive:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_lib_1_1_gauss_kronrod_non_adaptive__coll__graph.png" border="0" usemap="#_quant_lib_1_1_gauss_kronrod_non_adaptive_coll__map" alt="Collaboration graph"/></div>
<map name="_quant_lib_1_1_gauss_kronrod_non_adaptive_coll__map" id="_quant_lib_1_1_gauss_kronrod_non_adaptive_coll__map">
<area shape="rect" id="node2" href="class_quant_lib_1_1_integrator.html" title="{QuantLib::Integrator\n|&#45; absoluteAccuracy_\l&#45; absoluteError_\l&#45; maxEvaluations_\l&#45; evaluations_\l|+ Integrator()\l+ ~Integrator()\l+ operator()()\l+ absoluteError()\l+ numberOfEvaluations()\l+ integrationSuccess()\l+ setAbsoluteAccuracy()\l+ setMaxEvaluations()\l+ absoluteAccuracy()\l+ maxEvaluations()\l# integrate()\l# setAbsoluteError()\l# setNumberOfEvaluations()\l# increaseNumberOfEvaluations()\l* setAbsoluteAccuracy()\l* setMaxEvaluations()\l* absoluteAccuracy()\l* maxEvaluations()\l}" alt="" coords="191,173,409,605"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_quant_lib_1_1_gauss_kronrod_non_adaptive-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a79fa7aa07ccff07d65aefeec330bd04a">GaussKronrodNonAdaptive</a> (<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_integrator.html#aa035733902c4e8ac827731ff00add2ff">absoluteAccuracy</a>, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> <a class="el" href="class_quant_lib_1_1_integrator.html#a01c6f993418d302517b879ca6dc6747d">maxEvaluations</a>, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a252130ee33e8f69ac834877f6ced98db">relativeAccuracy</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a5093d06a5a8d9486bfc92a21ffe0a430">setRelativeAccuracy</a> (<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a252130ee33e8f69ac834877f6ced98db">relativeAccuracy</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a9595093633d53c74381666e4b0d07971">integrate</a> (const boost::function&lt; <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>(<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>)&gt; &amp;f, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> a, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> b) const </td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#af1a1e35aeb143a9753eee1c494063366">relativeAccuracy_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Integral of a 1-dimensional function using the Gauss-Kronrod methods. </p>
<p>This class provide a non-adaptive integration procedure which uses fixed Gauss-Kronrod abscissae to sample the integrand at a maximum of 87 points. It is provided for fast integration of smooth functions.</p>
<p>This function applies the Gauss-Kronrod 10-point, 21-point, 43-point and 87-point integration rules in succession until an estimate of the integral of f over (a, b) is achieved within the desired absolute and relative error limits, epsabs and epsrel. The function returns the final approximation, result, an estimate of the absolute error, abserr and the number of function evaluations used, neval. The Gauss-Kronrod rules are designed in such a way that each rule uses all the results of its predecessors, in order to minimize the total number of function evaluations. </p>

<p>Definition at line <a class="el" href="kronrodintegral_8hpp_source.html#l00052">52</a> of file <a class="el" href="kronrodintegral_8hpp_source.html">kronrodintegral.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a79fa7aa07ccff07d65aefeec330bd04a"></a><!-- doxytag: member="QuantLib::GaussKronrodNonAdaptive::GaussKronrodNonAdaptive" ref="a79fa7aa07ccff07d65aefeec330bd04a" args="(Real absoluteAccuracy, Size maxEvaluations, Real relativeAccuracy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a79fa7aa07ccff07d65aefeec330bd04a">QuantLib::GaussKronrodNonAdaptive::GaussKronrodNonAdaptive</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>absoluteAccuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>maxEvaluations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>relativeAccuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="kronrodintegral_8cpp_source.html#l00222">222</a> of file <a class="el" href="kronrodintegral_8cpp_source.html">kronrodintegral.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    : <a class="code" href="class_quant_lib_1_1_integrator.html#af1b1a6639727b55ddf35989fef19376e">Integrator</a>(<a class="code" href="class_quant_lib_1_1_integrator.html#aa035733902c4e8ac827731ff00add2ff">absoluteAccuracy</a>, <a class="code" href="class_quant_lib_1_1_integrator.html#a01c6f993418d302517b879ca6dc6747d">maxEvaluations</a>),
      <a class="code" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#af1a1e35aeb143a9753eee1c494063366">relativeAccuracy_</a>(<a class="code" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a252130ee33e8f69ac834877f6ced98db">relativeAccuracy</a>) {}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a9595093633d53c74381666e4b0d07971"></a><!-- doxytag: member="QuantLib::GaussKronrodNonAdaptive::integrate" ref="a9595093633d53c74381666e4b0d07971" args="(const boost::function&lt; Real(Real)&gt; &amp;f, Real a, Real b) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a9595093633d53c74381666e4b0d07971">QuantLib::GaussKronrodNonAdaptive::integrate</a> </td>
          <td>(</td>
          <td class="paramtype">const boost::function&lt; <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>(<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>)&gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="class_quant_lib_1_1_integrator.html#a965d682f2527ab60985da5613410998d">QuantLib::Integrator</a>.</p>

<p>Definition at line <a class="el" href="kronrodintegral_8cpp_source.html#l00229">229</a> of file <a class="el" href="kronrodintegral_8cpp_source.html">kronrodintegral.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="integral_8cpp_source.html#l00043">QuantLib::Integrator::absoluteAccuracy()</a>, <a class="el" href="interpolations_8cpp_source.html#l01615">anonymous_namespace{interpolations.cpp}::f()</a>, <a class="el" href="errors_8hpp_source.html#l00086">QL_REQUIRE</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00218">relativeAccuracy()</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00025">QuantLib::rescaleError()</a>, <a class="el" href="integral_8cpp_source.html#l00055">QuantLib::Integrator::setAbsoluteError()</a>, <a class="el" href="integral_8cpp_source.html#l00063">QuantLib::Integrator::setNumberOfEvaluations()</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00059">QuantLib::w10</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00077">QuantLib::w21a</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00086">QuantLib::w21b</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00111">QuantLib::w43a</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00125">QuantLib::w43b</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00167">QuantLib::w87a</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00192">QuantLib::w87b</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00050">QuantLib::x1</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00068">QuantLib::x2</a>, <a class="el" href="kronrodintegral_8cpp_source.html#l00096">QuantLib::x3</a>, and <a class="el" href="kronrodintegral_8cpp_source.html#l00141">QuantLib::x4</a>.</p>
<div class="fragment"><pre class="fragment">                                                     {
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> result;
        <span class="comment">//Size neval;</span>
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fv1[5], fv2[5], fv3[5], fv4[5];
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> savfun[21];  <span class="comment">/* array of function values which have been computed */</span>
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> res10, res21, res43, res87;    <span class="comment">/* 10, 21, 43 and 87 point results */</span>
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> err;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> resAbs; <span class="comment">/* approximation to the integral of abs(f) */</span>
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> resasc; <span class="comment">/* approximation to the integral of abs(f-i/(b-a)) */</span>
        <span class="keywordtype">int</span> k ;

        <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>&lt;<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>, <span class="stringliteral">&quot;b must be greater than a)&quot;</span>);

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> halfLength = 0.5 * (<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a> - <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> center = 0.5 * (<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a> + <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fCenter = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center);

        <span class="comment">// Compute the integral using the 10- and 21-point formula.</span>

        res10 = 0;
        res21 = <a class="code" href="namespace_quant_lib.html#ad51efa7db3fadbd19f26f50605067097">w21b</a>[5] * fCenter;
        resAbs = <a class="code" href="namespace_quant_lib.html#ad51efa7db3fadbd19f26f50605067097">w21b</a>[5] * std::fabs(fCenter);

        <span class="keywordflow">for</span> (k = 0; k &lt; 5; k++) {
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> abscissa = halfLength * <a class="code" href="namespace_quant_lib.html#ac5497abeb868c17a2880edf81c8bec12">x1</a>[k];
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval1 = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center + abscissa);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval2 = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center - abscissa);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval = fval1 + fval2;
            res10 += <a class="code" href="namespace_quant_lib.html#a2adb8bee729fba02b139b9a378c91cbc">w10</a>[k] * fval;
            res21 += <a class="code" href="namespace_quant_lib.html#ad00178d849f6af7986fb24bb6bde6ac8">w21a</a>[k] * fval;
            resAbs += <a class="code" href="namespace_quant_lib.html#ad00178d849f6af7986fb24bb6bde6ac8">w21a</a>[k] * (std::fabs(fval1) + std::fabs(fval2));
            savfun[k] = fval;
            fv1[k] = fval1;
            fv2[k] = fval2;
        }

        <span class="keywordflow">for</span> (k = 0; k &lt; 5; k++) {
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> abscissa = halfLength * <a class="code" href="namespace_quant_lib.html#a69d53a718e2be6b797f41f174ab1b05e">x2</a>[k];
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval1 = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center + abscissa);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval2 = <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center - abscissa);
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval = fval1 + fval2;
            res21 += <a class="code" href="namespace_quant_lib.html#ad51efa7db3fadbd19f26f50605067097">w21b</a>[k] * fval;
            resAbs += <a class="code" href="namespace_quant_lib.html#ad51efa7db3fadbd19f26f50605067097">w21b</a>[k] * (std::fabs(fval1) + std::fabs(fval2));
            savfun[k + 5] = fval;
            fv3[k] = fval1;
            fv4[k] = fval2;
        }

        result = res21 * halfLength;
        resAbs *= halfLength ;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> mean = 0.5 * res21;
        resasc = <a class="code" href="namespace_quant_lib.html#ad51efa7db3fadbd19f26f50605067097">w21b</a>[5] * std::fabs(fCenter - mean);

        <span class="keywordflow">for</span> (k = 0; k &lt; 5; k++)
            resasc += (<a class="code" href="namespace_quant_lib.html#ad00178d849f6af7986fb24bb6bde6ac8">w21a</a>[k] * (std::fabs(fv1[k] - mean)
                        + std::fabs(fv2[k] - mean))
                        + <a class="code" href="namespace_quant_lib.html#ad51efa7db3fadbd19f26f50605067097">w21b</a>[k] * (std::fabs(fv3[k] - mean)
                        + std::fabs(fv4[k] - mean)));

        err = <a class="code" href="namespace_quant_lib.html#af512eae7068ec5f1d7eed67a9144efde">rescaleError</a> ((res21 - res10) * halfLength, resAbs, resasc) ;
        resasc *= halfLength ;

        <span class="comment">// test for convergence.</span>
        <span class="keywordflow">if</span> (err &lt; <a class="code" href="class_quant_lib_1_1_integrator.html#aa035733902c4e8ac827731ff00add2ff">absoluteAccuracy</a>() || err &lt; <a class="code" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a252130ee33e8f69ac834877f6ced98db">relativeAccuracy</a>() * std::fabs(result)){
            <a class="code" href="class_quant_lib_1_1_integrator.html#a192a2d8df0181e3b3ec3fc0442c1c8c7">setAbsoluteError</a>(err);
            <a class="code" href="class_quant_lib_1_1_integrator.html#a0a7d8b02ddc276f748ff40e1d8e55d9d">setNumberOfEvaluations</a>(21);
            <span class="keywordflow">return</span> result;
        }

        <span class="comment">/* compute the integral using the 43-point formula. */</span>

        res43 = <a class="code" href="namespace_quant_lib.html#adec97c6ea237027e9d0da9ada955e587">w43b</a>[11] * fCenter;

        <span class="keywordflow">for</span> (k = 0; k &lt; 10; k++)
            res43 += savfun[k] * <a class="code" href="namespace_quant_lib.html#a99f59e40467f51aba83c2a3d1b3fa83c">w43a</a>[k];

        <span class="keywordflow">for</span> (k = 0; k &lt; 11; k++){
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> abscissa = halfLength * <a class="code" href="namespace_quant_lib.html#aa3e0ff1fd0bb4406094e1c19ff77ef1f">x3</a>[k];
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> fval = (<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center + abscissa)
                + <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center - abscissa));
            res43 += fval * <a class="code" href="namespace_quant_lib.html#adec97c6ea237027e9d0da9ada955e587">w43b</a>[k];
            savfun[k + 10] = fval;
            }

        <span class="comment">// test for convergence.</span>

        result = res43 * halfLength;
        err = <a class="code" href="namespace_quant_lib.html#af512eae7068ec5f1d7eed67a9144efde">rescaleError</a> ((res43 - res21) * halfLength, resAbs, resasc);

       <span class="keywordflow">if</span> (err &lt; <a class="code" href="class_quant_lib_1_1_integrator.html#aa035733902c4e8ac827731ff00add2ff">absoluteAccuracy</a>() || err &lt; <a class="code" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a252130ee33e8f69ac834877f6ced98db">relativeAccuracy</a>() * std::fabs(result)){
            <a class="code" href="class_quant_lib_1_1_integrator.html#a192a2d8df0181e3b3ec3fc0442c1c8c7">setAbsoluteError</a>(err);
            <a class="code" href="class_quant_lib_1_1_integrator.html#a0a7d8b02ddc276f748ff40e1d8e55d9d">setNumberOfEvaluations</a>(43);
            <span class="keywordflow">return</span> result;
        }

        <span class="comment">/* compute the integral using the 87-point formula. */</span>

        res87 = <a class="code" href="namespace_quant_lib.html#ab5e7cd38656681be96eb83075d28e242">w87b</a>[22] * fCenter;

        <span class="keywordflow">for</span> (k = 0; k &lt; 21; k++)
            res87 += savfun[k] * <a class="code" href="namespace_quant_lib.html#a6f2c7992d4eebe7dbc5dc45ae964c1d2">w87a</a>[k];

        <span class="keywordflow">for</span> (k = 0; k &lt; 22; k++){
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> abscissa = halfLength * <a class="code" href="namespace_quant_lib.html#aaf35556a66458822b9ab99a5c8b59f98">x4</a>[k];
            res87 += <a class="code" href="namespace_quant_lib.html#ab5e7cd38656681be96eb83075d28e242">w87b</a>[k] * (<a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center + abscissa)
                + <a class="code" href="namespaceanonymous__namespace_02interpolations_8cpp_03.html#a31ee7b72e39dd85ef76ba20ca21a3018">f</a>(center - abscissa));
        }

        <span class="comment">// test for convergence.</span>
        result = res87 * halfLength ;
        err = <a class="code" href="namespace_quant_lib.html#af512eae7068ec5f1d7eed67a9144efde">rescaleError</a> ((res87 - res43) * halfLength, resAbs, resasc);

        <a class="code" href="class_quant_lib_1_1_integrator.html#a192a2d8df0181e3b3ec3fc0442c1c8c7">setAbsoluteError</a>(err);
        <a class="code" href="class_quant_lib_1_1_integrator.html#a0a7d8b02ddc276f748ff40e1d8e55d9d">setNumberOfEvaluations</a>(87);
        <span class="keywordflow">return</span> result;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a252130ee33e8f69ac834877f6ced98db"></a><!-- doxytag: member="QuantLib::GaussKronrodNonAdaptive::relativeAccuracy" ref="a252130ee33e8f69ac834877f6ced98db" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a252130ee33e8f69ac834877f6ced98db">QuantLib::GaussKronrodNonAdaptive::relativeAccuracy</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="kronrodintegral_8cpp_source.html#l00218">218</a> of file <a class="el" href="kronrodintegral_8cpp_source.html">kronrodintegral.cpp</a>.</p>

<p>References <a class="el" href="kronrodintegral_8hpp_source.html#l00064">relativeAccuracy_</a>.</p>

<p>Referenced by <a class="el" href="kronrodintegral_8cpp_source.html#l00229">integrate()</a>.</p>
<div class="fragment"><pre class="fragment">                                                         {
        <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#af1a1e35aeb143a9753eee1c494063366">relativeAccuracy_</a>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a5093d06a5a8d9486bfc92a21ffe0a430"></a><!-- doxytag: member="QuantLib::GaussKronrodNonAdaptive::setRelativeAccuracy" ref="a5093d06a5a8d9486bfc92a21ffe0a430" args="(Real)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#a5093d06a5a8d9486bfc92a21ffe0a430">QuantLib::GaussKronrodNonAdaptive::setRelativeAccuracy</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="af1a1e35aeb143a9753eee1c494063366"></a><!-- doxytag: member="QuantLib::GaussKronrodNonAdaptive::relativeAccuracy_" ref="af1a1e35aeb143a9753eee1c494063366" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html#af1a1e35aeb143a9753eee1c494063366">QuantLib::GaussKronrodNonAdaptive::relativeAccuracy_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="kronrodintegral_8hpp_source.html#l00064">64</a> of file <a class="el" href="kronrodintegral_8hpp_source.html">kronrodintegral.hpp</a>.</p>

<p>Referenced by <a class="el" href="kronrodintegral_8cpp_source.html#l00218">relativeAccuracy()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/math/integrals/<a class="el" href="kronrodintegral_8hpp_source.html">kronrodintegral.hpp</a></li>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/math/integrals/<a class="el" href="kronrodintegral_8cpp_source.html">kronrodintegral.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_quant_lib.html">QuantLib</a>      </li>
      <li class="navelem"><a class="el" href="class_quant_lib_1_1_gauss_kronrod_non_adaptive.html">GaussKronrodNonAdaptive</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:09 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
