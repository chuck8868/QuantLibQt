<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: anonymous_namespace{perturbativebarrieroptionengine.cpp} Namespace Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">anonymous_namespace{perturbativebarrieroptionengine.cpp} Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a> (double a, double b, double rho)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa081b5a3b7ab1aa27ab243b2fa4e85e1">ndf</a> (double t)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a92f65f969a12afdf46cdcd5ec12534cb">nc</a> (double x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a> (double Z)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd0702ab2efd15487a19263a556852ed">ff</a> (double p, double tt, double a, double b, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a> (double p, double tt, double a, double b, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a> (double p, double tt, double a, double b, double c, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a> (double limit[4], double sigmarho[4], int idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#afdff3da0091a96a033a55c5946217728">ddvv</a> (double s, double p, double tt, double a, double b, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#add806343b0abfb64da47c796f2b3e2b3">ddff</a> (double s, double p, double tt, double a, double b, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a> (double s, double p, double tt, double a, double b, double c, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a> (double s, double p, double tt, double ax, double bx, double c, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a> (double s, double p, double tt, double a, double b, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a52651175fbb4f00e632decc2b753bbff">dff</a> (double s, double p, double tt, double a, double b, double gm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a> (int jj, double limit[4], double sigmarho[4], double epsi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a83b7af85879e60d95a0cbadd8d033c01">BarrierUPD</a> (double kprice, double stock, double hbarr, double taumin, double taumax, int iord, int igm, boost::function&lt; double(double, double)&gt; integr, boost::function&lt; double(double, double)&gt; integalpha, boost::function&lt; double(double, double)&gt; integs, boost::function&lt; double(double)&gt; alpha, boost::function&lt; double(double)&gt; sigmaq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a18ee9929f01bcb3568544248b01ed6e4">fxy</a> (double x, double y, double a, double b, double rho)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a> (int NU, double DH, double DK, double RRR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a> (double X, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>, int <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a75e211334db54a064564a63ae12350d5">ADONET</a> (double ZRO, double ONE, double EPS, double(*<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>)(double X, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>, int <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2424516ac427745126c95f7e48e36087">tvtl</a> (int NU, double limit[], double sigmarho[], double epsi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6877f2a2f654587ecb96bf604fa5ac42">SINCS</a> (double v1, double v2, double v3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a30555fb868b18f0d9657aafc473ddc6e">PNTGND</a> (int, double, double, double, double, double, double, double)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a7a928543a2509276892abc731ff7c55d">KRNRDT</a> (double, double, double(*<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>)(double, double, double, double, double, double, double, double, double, int), double)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a887b3dd544e90342af96092dde616a1b">KRNRDT</a> (double A, double B, double(*<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>)(double X, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>, double <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>, int <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>), double ERR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a> (int NU, double <a class="el" href="class_t.html">T</a>)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a75e211334db54a064564a63ae12350d5"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ADONET" ref="a75e211334db54a064564a63ae12350d5" args="(double ZRO, double ONE, double EPS, double(*TVTMFN)(double X, double H1, double H2, double H3, double R23, double RUA, double RUB, double AR, double RUC, int NUC))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a75e211334db54a064564a63ae12350d5">ADONET</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ZRO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ONE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>EPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double X, double H1, double H2, double H3, double R23, double RUA, double RUB, double AR, double RUC, int NUC)&#160;</td>
          <td class="paramname"><em>TVTMFN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01000">1000</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="matrices_8cpp_source.html#l00038">anonymous_namespace{matrices.cpp}::I</a>, <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a7a928543a2509276892abc731ff7c55d">KRNRDT()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00944">TVTMFN()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                                                                               {
        <span class="comment">//</span>
        <span class="comment">//     One Dimensional Globally Adaptive Integration Function</span>
        <span class="comment">//</span>
        <span class="keywordtype">int</span> NL=100, <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>, IM, IP;
        <span class="keyword">static</span> <span class="keywordtype">double</span> EI[101], AI[101], BI[101], FI[101], FIN;
        <span class="keyword">static</span> <span class="keywordtype">double</span> result,ERR;


        AI[1] = A;
        BI[1] = B;
        ERR = 1;
        IP = 1;
        IM = 1;
        <span class="keywordflow">while</span> ( ((4*ERR)&gt; TOL) &amp;&amp; (IM&lt; NL) )
            {
                IM = IM + 1;
                BI[IM] = BI[IP];
                AI[IM] = (AI[IP] + BI[IP] )/2.0;
                BI[IP] = AI[IM];
                FI[IP] = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a7a928543a2509276892abc731ff7c55d">KRNRDT</a>( AI[IP], BI[IP], *<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>, EI[IP] );
                FI[IM] = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a7a928543a2509276892abc731ff7c55d">KRNRDT</a>( AI[IM], BI[IM], *<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>, EI[IM] );

                ERR = 0.0;
                FIN = 0.0;
                <span class="keywordflow">for</span>(<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a> = 1; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>&lt;=IM; <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>++)
                    {
                        <span class="keywordflow">if</span>( EI[<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>] &gt; EI[IP]) IP = <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>;
                        FIN = FIN + FI[<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>];
                        ERR = ERR + EI[<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>]*EI[<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>];
                    }
                ERR = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( ERR,0.5 );
            }
        result=FIN;
        <span class="comment">//   ADONET = FIN</span>
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a83b7af85879e60d95a0cbadd8d033c01"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::BarrierUPD" ref="a83b7af85879e60d95a0cbadd8d033c01" args="(double kprice, double stock, double hbarr, double taumin, double taumax, int iord, int igm, boost::function&lt; double(double, double)&gt; integr, boost::function&lt; double(double, double)&gt; integalpha, boost::function&lt; double(double, double)&gt; integs, boost::function&lt; double(double)&gt; alpha, boost::function&lt; double(double)&gt; sigmaq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a83b7af85879e60d95a0cbadd8d033c01">BarrierUPD</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kprice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hbarr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>taumin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>taumax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>igm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::function&lt; double(double, double)&gt;&#160;</td>
          <td class="paramname"><em>integr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::function&lt; double(double, double)&gt;&#160;</td>
          <td class="paramname"><em>integalpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::function&lt; double(double, double)&gt;&#160;</td>
          <td class="paramname"><em>integs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>sigmaq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">70</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::c</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00590">ddff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00646">ddll()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00711">ddvv()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00518">dff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00551">dll()</a>, <a class="el" href="yieldtermstructure_8cpp_source.html#l00029">QuantLib::anonymous_namespace{yieldtermstructure.cpp}::dt</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00482">dvv()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00413">ff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00452">llold()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00433">v()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01571">QuantLib::PerturbativeBarrierOptionEngine::calculate()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> v0=0.0, v1=0.0, v1p=0.0, v2p=0.0, v2pp=0.0, gm=0.0;
        <span class="keywordtype">int</span> i=0,j=0;
        <span class="keywordtype">double</span> tmp=0.0, e1=0.0, e2=0.0, e3=0.0, e4=0.0;
        <span class="keywordtype">double</span> xstar=0.0, s0=0.0;
        <span class="keywordtype">double</span> sigmat=0.0, disc=0.0, d1=0.0,d2=0.0,d3=0.0,d4=0.0;
        <span class="keywordtype">double</span> et=0.0,tt=0.0, <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02yieldtermstructure_8cpp_03.html#a380ac4fa89b26a124e27dfdb4dfdc6a5">dt</a>=0.0,p=0.0;
        <span class="keywordtype">int</span> npoint,npoint2;
        <span class="keyword">static</span> <span class="keywordtype">double</span> pi= 3.14159265358979324;
        <span class="keywordtype">double</span> dsqpi;
        <span class="keywordtype">double</span> caux=0.0,ccaux=0.0;
        <span class="keywordtype">double</span> auxnew=0.0;
        <span class="keywordtype">double</span> x=0.0,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=0.0,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>=0.0;

        <span class="keywordflow">if</span>(igm==0) {
            gm=0.0;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(igm==1) {
            gm=integalpha(taumin,taumax)/(0.5*integs(taumin,taumax));
        } <span class="keywordflow">else</span> {
            igm=0;
            gm=0.0;
        }

        <span class="comment">/*</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">          !!                                 !!</span>
<span class="comment">          !! xstar=min(0,log(kprice/hbarr))  !!</span>
<span class="comment">          !!                                 !!</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">        */</span>

        xstar=log(kprice/hbarr);

        <span class="keywordflow">if</span>(xstar&gt;0.0) xstar=0.0;
        sigmat=integs(taumin,taumax);
        disc=-integr(taumin,taumax);

        <span class="comment">/*</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">          !!    Change of variable            !!</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">        */</span>
        s0=stock/hbarr;

        <span class="comment">/*</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">          !!                                       !!</span>
<span class="comment">          !! Compute the zero-th order term P_0    !!</span>
<span class="comment">          !!                                       !!</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">        */</span>
        d1=(xstar-log(s0)+(1.0-gm)*0.5*sigmat)/sqrt(sigmat);
        d2=(xstar+log(s0)+(1.0-gm)*0.5*sigmat)/sqrt(sigmat);
        d3=(xstar-log(s0)-(1.0+gm)*0.5*sigmat)/sqrt(sigmat);
        d4=(xstar+log(s0)-(1.0+gm)*0.5*sigmat)/sqrt(sigmat);

        e1=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(d1);
        e2=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(d2);
        e3=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(d3);
        e4=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(d4);

        v0=kprice*e1-kprice*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(s0,(1.0-gm))*e2;
        v0=v0+exp(gm*0.5*sigmat)*(-hbarr*s0*e3+hbarr*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(s0,-gm)*e4);
        v0=v0*exp(disc);

        <span class="keywordflow">if</span>(iord==0) <span class="keywordflow">return</span> v0;

        <span class="comment">/*</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">          !!                                           !!</span>
<span class="comment">          !! Compute the first order term  P_1         !!</span>
<span class="comment">          !!                                           !!</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">        */</span>

        npoint=1000;
        npoint2=100;

        <a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02yieldtermstructure_8cpp_03.html#a380ac4fa89b26a124e27dfdb4dfdc6a5">dt</a>=(taumax-taumin)/<span class="keywordtype">double</span>(npoint);

        tt=0.5*integs(taumin,taumax);

        x=log(s0);
        et=exp(0.5*(1.0-gm)*x);

        dsqpi=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(pi,0.5);

        v1=0.0;
        <span class="keywordflow">for</span>( i=1;i&lt;=npoint;i++) {
            v1p=0.0;
            tmp=taumin+<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02yieldtermstructure_8cpp_03.html#a380ac4fa89b26a124e27dfdb4dfdc6a5">dt</a>*double(2*i-1)*0.5;
            p=0.5*integs(tmp,taumax);
            <span class="comment">/*</span>
<span class="comment">              !!</span>
<span class="comment">              !! Function E(p,tt,a,b,gm)</span>
<span class="comment">              !!</span>
<span class="comment">            */</span>
            caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>(p,tt,x,xstar,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>(p,tt,x,-xstar,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>(p,tt,-x,xstar,gm);
            ccaux=ccaux-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a>(p,tt,-x,-xstar,gm);
            auxnew=ccaux*(-kprice*exp(-xstar*0.5*(1.0-gm))+hbarr*exp(xstar*0.5*(1.0+gm)));
            v1p=v1p+auxnew;
            <span class="comment">/*</span>
<span class="comment">              !!</span>
<span class="comment">              !! Function L(p,tt,a,b,c,gm)</span>
<span class="comment">              !!</span>
<span class="comment">            */</span>
            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=gm-1.0;
            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>=-xstar;
            ccaux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a>(p,tt,x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a>(p,tt,-x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>,gm);
            auxnew=kprice*(1.0-gm)*ccaux;
            v1p=v1p+auxnew;

            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=-(gm+1.0);
            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>=xstar;
            ccaux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a>(p,tt,x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a>(p,tt,-x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>,gm);
            auxnew=-exp(gm*p)*hbarr*ccaux;
            v1p=v1p+auxnew;

            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=(gm+1.0);
            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>=-xstar;
            ccaux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a>(p,tt,x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a>(p,tt,-x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>,gm);
            auxnew=exp(gm*p)*hbarr*gm*ccaux;
            v1p=v1p+auxnew;
            <span class="comment">/*</span>
<span class="comment">              !!</span>
<span class="comment">              !! Function F(p,tt,a,b,c,gm)</span>
<span class="comment">              !!</span>
<span class="comment">            */</span>
            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=gm-1.0;
            auxnew=-kprice*(1.0-gm)*(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd0702ab2efd15487a19263a556852ed">ff</a>(p,tt,x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd0702ab2efd15487a19263a556852ed">ff</a>(p,tt,-x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,gm));
            v1p=v1p+auxnew;

            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>=gm+1.0;
            auxnew=-exp(gm*p)*gm*hbarr*(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd0702ab2efd15487a19263a556852ed">ff</a>(p,tt,x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd0702ab2efd15487a19263a556852ed">ff</a>(p,tt,-x,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,gm));
            v1p=v1p+auxnew;

            v1=v1+(alpha(tmp)-gm*0.5*sigmaq(tmp))*v1p;
        }

        v1=exp(disc)*et*v1*<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02yieldtermstructure_8cpp_03.html#a380ac4fa89b26a124e27dfdb4dfdc6a5">dt</a>/(dsqpi*2.0);

        <span class="keywordflow">if</span>(iord==1) <span class="keywordflow">return</span> v0+v1;

        <span class="comment">/*</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">          !!                                          !!</span>
<span class="comment">          !! Compute the second order term P_2        !!</span>
<span class="comment">          !!                                          !!</span>
<span class="comment">          !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="comment">        */</span>

        <span class="keywordtype">double</span> v2,dtp, tmp1,s,caux2;
        v2=0.0;

        <span class="keywordflow">for</span>(i=1;i&lt;=npoint;i++) {
            v2p=0.0;
            tmp=taumin+<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02yieldtermstructure_8cpp_03.html#a380ac4fa89b26a124e27dfdb4dfdc6a5">dt</a>*(double)(2*i-1)*0.5;
            p=0.5*integs(tmp,taumax);

            dtp=(taumax-tmp)/(<span class="keywordtype">double</span>)(npoint2);

            <span class="keywordflow">for</span>(j=1;j&lt;=npoint2; j++) {
                v2pp=0.0;
                tmp1=tmp+dtp*(double)(2*j-1)*0.50;
                s=0.50*integs(tmp1,taumax);

                caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a>(s,p,tt,-x,-1.0+gm,-xstar,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a>(s,p,tt,x,-1.0+gm,-xstar,gm);
                v2pp=caux*kprice*(1.0-gm);

                caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a>(s,p,tt,-x,-1.0-gm,xstar,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a>(s,p,tt,x,-1.0-gm,xstar,gm);
                v2pp=v2pp-exp(gm*s)*hbarr*caux;

                caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a>(s,p,tt,-x,1.0+gm,-xstar,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a>(s,p,tt,x,1.0+gm,-xstar,gm);
                v2pp=v2pp+exp(gm*s)*gm*hbarr*caux;

                caux=+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a>(s,p,tt,-x,xstar,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a>(s,p,tt,x,xstar,gm);
                caux=caux+(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a>(s,p,tt,-x,-xstar,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a>(s,p,tt,x,-xstar,gm));
                caux2=hbarr*exp(0.5*(1.0+gm)*xstar)-kprice*exp(-0.5*(1.0-gm)*xstar);
                v2pp=v2pp+caux2*caux;

                caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a52651175fbb4f00e632decc2b753bbff">dff</a>(s,p,tt,-x,-1.0+gm,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a52651175fbb4f00e632decc2b753bbff">dff</a>(s,p,tt,x,-1.0+gm,gm);
                v2pp=v2pp-(1.0-gm)*kprice*caux;

                caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a52651175fbb4f00e632decc2b753bbff">dff</a>(s,p,tt,-x,1.0+gm,gm)-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a52651175fbb4f00e632decc2b753bbff">dff</a>(s,p,tt,x,1.0+gm,gm);
                v2pp=v2pp-exp(gm*s)*gm*hbarr*caux;

                v2pp=v2pp*0.5*(1.0-gm);

                caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a>(s,p,tt,-x,-1.0+gm,-xstar,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a>(s,p,tt,x,-1.0+gm,-xstar,gm);
                v2pp=v2pp+caux*kprice*(1.0-gm);

                caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a>(s,p,tt,-x,-1.0-gm,xstar,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a>(s,p,tt,x,-1.0-gm,xstar,gm);
                v2pp=v2pp-exp(gm*s)*hbarr*caux;

                caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a>(s,p,tt,-x,1.0+gm,-xstar,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a>(s,p,tt,x,1.0+gm,-xstar,gm);
                v2pp=v2pp+exp(gm*s)*gm*hbarr*caux;

                caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#afdff3da0091a96a033a55c5946217728">ddvv</a>(s,p,tt,-x,xstar,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#afdff3da0091a96a033a55c5946217728">ddvv</a>(s,p,tt,x,xstar,gm);
                caux=caux+(-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a>(s,p,tt,-x,-xstar,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a>(s,p,tt,x,-xstar,gm));
                caux2=hbarr*exp(0.5*(1.0+gm)*xstar)-kprice*exp(-0.5*(1-gm)*xstar);

                v2pp=v2pp+caux2*caux;

                caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#add806343b0abfb64da47c796f2b3e2b3">ddff</a>(s,p,tt,-x,-1+gm,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#add806343b0abfb64da47c796f2b3e2b3">ddff</a>(s,p,tt,x,-1+gm,gm);
                v2pp=v2pp-(1.0-gm)*kprice*caux;

                caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#add806343b0abfb64da47c796f2b3e2b3">ddff</a>(s,p,tt,-x,1.0+gm,gm)+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#add806343b0abfb64da47c796f2b3e2b3">ddff</a>(s,p,tt,x,1.0+gm,gm);
                v2pp=v2pp-exp(gm*s)*gm*hbarr*caux;

                v2p=v2p+(alpha(tmp1)-gm*0.5*sigmaq(tmp1))*v2pp;
            }

            v2=v2+v2p*(alpha(tmp)-gm*0.5*sigmaq(tmp))*dtp;
        }

        v2=exp(disc)*et*v2*<a class="code" href="namespace_quant_lib_1_1anonymous__namespace_02yieldtermstructure_8cpp_03.html#a380ac4fa89b26a124e27dfdb4dfdc6a5">dt</a>;

        <span class="keywordflow">return</span> v0+v1+v2;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aec796ffb56fd24f67e440e3210b09868"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::BVTL" ref="aec796ffb56fd24f67e440e3210b09868" args="(int NU, double DH, double DK, double RRR)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RRR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01165">1165</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00035">PI</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00032">SIGN</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01125">STUDNT()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">/*</span>
<span class="comment">          A function for computing bivariate t probabilities.</span>
<span class="comment">          This function is based on the method described by</span>
<span class="comment">          Dunnett, C.W. and M. Sobel, (1954),</span>
<span class="comment">          A bivariate generalization of Student&#39;s t-distribution</span>
<span class="comment">          with tables for certain special cases,</span>
<span class="comment">          Biometrika 41, pp. 153-169.</span>
<span class="comment">          The software given here has been developed by M.C. Recchioni based on previous</span>
<span class="comment">          software developed by</span>
<span class="comment">          Alan Genz</span>
<span class="comment">          Department of Mathematics</span>
<span class="comment">          Washington State University</span>
<span class="comment">          Pullman, WA 99164-3113</span>
<span class="comment">          Email : alangenz@wsu.edu</span>
<span class="comment">          The software developed by A. Genz is available free of charge in</span>
<span class="comment">          the website: www.math.wsu.edu/faculty/genz/software/software.html</span>
<span class="comment">          ***</span>
<span class="comment"></span>
<span class="comment">          BVTL - calculate the probability that X &lt; DH and Y &lt; DK.</span>
<span class="comment"></span>
<span class="comment">          parameters</span>
<span class="comment"></span>
<span class="comment">          NU number of degrees of freedom</span>
<span class="comment">          DH 1st lower integration limit</span>
<span class="comment">          DK 2nd lower integration limit</span>
<span class="comment">          R   correlation coefficient</span>
<span class="comment">        */</span>
        <span class="keyword">static</span> <span class="keywordtype">int</span>  J, HS, KS;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  TPI, ORS, HRK, KRH, BVT, SNU;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  GMPH, GMPK, XNKH, XNHK, QHRK, HKN, HPK, HKRN;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  BTNCKH, BTNCHK, BTPDKH, BTPDHK, ONE, EPS;
        <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>(<span class="keywordtype">int</span> , <span class="keywordtype">double</span> );
        <span class="keyword">static</span> <span class="keywordtype">double</span> result;
        ONE = 1;
        EPS = 1e-15;
        <span class="keywordflow">if</span> ( NU &lt;1 ) result = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>( -DH, -DK, R );

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (1 - R)&lt;= EPS ) result = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>( NU, min( DH, DK ) );

        <span class="keywordflow">else</span>  <span class="keywordflow">if</span>( (R + 1)&lt;=EPS )
            {
                <span class="keywordflow">if</span>( DH &gt; -DK ) result = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>( NU, DH ) - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>( NU, -DK );
                <span class="keywordflow">else</span>
                    result = 0.0;
            }
        <span class="keywordflow">else</span>
            {
                TPI = 2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;
                SNU = (double)NU;
                SNU = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(SNU,0.5);
                ORS = 1.0 - R*R;
                HRK = DH - R*DK;
                KRH = DK - R*DH;
                <span class="keywordflow">if</span>((fabs(HRK) + ORS)&gt; 0 )
                    {
                        XNHK = HRK*HRK/( HRK*HRK + ORS*( NU + DK*DK ) );
                        XNKH = KRH*KRH/( KRH*KRH+ ORS*( NU + DH*DH ) );
                    }
                <span class="keywordflow">else</span>
                    {
                        XNHK = 0.0;
                        XNKH = 0.0;
                    }

                HS =(int)<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ac89d5f8a358eb8a1abdcd0fcef134f1a">SIGN</a>( ONE, DH - R*DK );
                KS =(int)<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ac89d5f8a358eb8a1abdcd0fcef134f1a">SIGN</a>( ONE, DK - R*DH );
                <span class="keywordflow">if</span>((NU-2*(<span class="keywordtype">int</span>)(NU/2))==0 )
                    {
                        BVT = atan2( <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ORS,0.5), -R )/TPI;
                        GMPH = DH/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( 16*( NU + DH*DH ),0.5 );
                        GMPK = DK/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( 16*( NU + DK*DK),0.5);
                        BTNCKH = 2*atan2( <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( XNKH,0.5 ), <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( 1-XNKH),0.5) )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;
                        BTPDKH = 2*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( XNKH*( 1 - XNKH ),0.5 )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;
                        BTNCHK = 2*atan2( <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( XNHK,0.5 ), <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1 - XNHK),0.5) )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;
                        BTPDHK = 2*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( XNHK*( 1 - XNHK ),0.5 )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;
                        <span class="keywordflow">for</span>( J = 1; J&lt;= NU/2;J++)
                            {
                                BVT = BVT + GMPH*( 1 + KS*BTNCKH );
                                BVT = BVT + GMPK*( 1 + HS*BTNCHK );
                                BTNCKH = BTNCKH + BTPDKH;
                                BTPDKH = 2*J*BTPDKH*( 1 - XNKH )/( 2*J + 1 );
                                BTNCHK = BTNCHK + BTPDHK;
                                BTPDHK = 2*J*BTPDHK*( 1 - XNHK )/( 2*J + 1 );
                                GMPH = GMPH*( 2*J - 1 )/( 2*J*( 1 + DH*DH/NU ) );
                                GMPK = GMPK*( 2*J - 1 )/( 2*J*( 1 + DK*DK/NU ) );
                            }
                    }
                <span class="keywordflow">else</span>
                    {
                        QHRK = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((DH*DH + DK*DK - 2*R*DH*DK + NU*ORS),0.5 ) ;
                        HKRN = DH*DK + R*NU ;
                        HKN = DH*DK - NU;
                        HPK = DH + DK;
                        BVT = atan2( -SNU*( HKN*QHRK + HPK*HKRN ),HKN*HKRN-NU*HPK*QHRK )/TPI;
                        <span class="keywordflow">if</span> ( BVT &lt; -EPS ) BVT = BVT + 1;
                        GMPH = DH/( TPI*SNU*( 1 + DH*DH/NU ) );
                        GMPK = DK/( TPI*SNU*( 1 + DK*DK/NU ) );
                        BTNCKH = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( XNKH,0.5 );
                        BTPDKH = BTNCKH;
                        BTNCHK = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( XNHK,0.5 );
                        BTPDHK = BTNCHK;
                        <span class="keywordflow">for</span>( J = 1;J&lt;= ( NU - 1 )/2; J++)
                            {
                                BVT = BVT + GMPH*( 1 + KS*BTNCKH );
                                BVT = BVT + GMPK*( 1 + HS*BTNCHK );
                                BTPDKH = ( 2*J - 1 )*BTPDKH*( 1 - XNKH )/( 2*J );
                                BTNCKH = BTNCKH + BTPDKH;
                                BTPDHK = ( 2*J - 1 )*BTPDHK*( 1 - XNHK )/( 2*J );
                                BTNCHK = BTNCHK + BTPDHK;
                                GMPH = 2*J*GMPH/( ( 2*J + 1 )*( 1 + DH*DH/NU ) );
                                GMPK = 2*J*GMPK/( ( 2*J + 1 )*( 1 + DK*DK/NU ) );
                            }
                    }
                result = BVT;
            }

        <span class="keywordflow">return</span>(result);

    }
</pre></div>
</div>
</div>
<a class="anchor" id="add806343b0abfb64da47c796f2b3e2b3"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ddff" ref="add806343b0abfb64da47c796f2b3e2b3" args="(double s, double p, double tt, double a, double b, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#add806343b0abfb64da47c796f2b3e2b3">ddff</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00590">590</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> aa,caux,caux1,caux2,caux3,caux4;
        <span class="keywordtype">double</span> xx,yy,rho;
        <span class="keywordtype">double</span> result;
        <span class="keywordtype">double</span> ppi= 3.14159265358979324;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(xx)*exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        caux1=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux1=exp(0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*caux1;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        caux2=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux2=-exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*caux2;

        caux=0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(caux+caux1+caux2);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((p-s),0.5)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0,0.5);
        caux1=exp(-0.5*xx*xx)*exp(0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(yy)/(2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi*(tt-p),0.5));


        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        yy=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((p-s),0.5)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p)*(tt-s),0.5);
        caux2=exp(-0.5*xx*xx)*exp(0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(yy)/(2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi*(tt-s),0.5));

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((p-s),0.5)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0,0.5);
        caux3=-exp(-0.5*xx*xx)*exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(yy)/(2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi*(tt-p),0.5));


        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        yy=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((p-s),0.5)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p)*(tt-s),0.5);
        caux4=exp(-0.5*xx*xx)*exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(yy)/(2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi*(tt-s),0.5));



        aa=exp((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-(1.0-gm)*(1.0-gm))*(tt-p)/4.0);


        result=(caux+caux1+caux2+caux3+caux4)*aa;
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a345345e84fb9ca25be6bb57b0526b03b"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ddll" ref="a345345e84fb9ca25be6bb57b0526b03b" args="(double s, double p, double tt, double ax, double bx, double c, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a345345e84fb9ca25be6bb57b0526b03b">ddll</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00646">646</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::c</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00776">derivn3()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, and <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keyword">static</span> <span class="keywordtype">double</span> result;
        <span class="keyword">static</span> <span class="keywordtype">double</span> aa,caux,caux1;
        <span class="keyword">static</span> <span class="keywordtype">double</span> sigmarho[4],limit[4];
        <span class="keyword">static</span> <span class="keywordtype">int</span> idx;
        <span class="keywordtype">double</span> epsi;
        <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(<span class="keywordtype">double</span>[],<span class="keywordtype">double</span>[], <span class="keywordtype">int</span> );
        <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a>(<span class="keywordtype">int</span> ,<span class="keywordtype">double</span>[],<span class="keywordtype">double</span>[],<span class="keywordtype">double</span>);

        epsi=1.e-12;
        limit[1]=(ax+bx*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        limit[2]=(ax+bx*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        limit[3]=(ax+bx*tt+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);
        sigmarho[1]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        sigmarho[2]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/tt,0.5);
        sigmarho[3]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-s)/tt,0.5);

        caux=0.5*bx*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a>(0,limit,sigmarho,epsi);


        idx=1;
        caux=caux+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(limit,sigmarho,idx)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);

        idx=2;
        caux=caux+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(limit,sigmarho,idx)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);

        idx=3;
        caux=caux+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(limit,sigmarho,idx)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);

        caux=exp(0.5*ax*bx)*caux;

        limit[1]=(ax-bx*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        limit[2]=(-ax+bx*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        limit[3]=(-ax+bx*tt+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);
        sigmarho[1]=-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        sigmarho[2]=-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/tt,0.5);
        sigmarho[3]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-s)/tt,0.5);

        caux1=0.5*bx*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a>(0,limit,sigmarho,epsi);

        idx=1;
        caux1=caux1-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(limit,sigmarho,idx)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);

        idx=2;
        caux1=caux1+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(limit,sigmarho,idx)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);


        idx=3;
        caux1=caux1+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a>(limit,sigmarho,idx)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);

        caux1=exp(-0.5*ax*bx)*caux1;


        aa=exp((bx*bx-(1.0-gm)*(1.0-gm))*(tt-s)/4.0);

        result=(caux+caux1)*aa;
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="afdff3da0091a96a033a55c5946217728"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ddvv" ref="afdff3da0091a96a033a55c5946217728" args="(double s, double p, double tt, double a, double b, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#afdff3da0091a96a033a55c5946217728">ddvv</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00711">711</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::b</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keyword">static</span> <span class="keywordtype">double</span> result;
        <span class="keyword">static</span> <span class="keywordtype">double</span> aa,caux,caux1,caux2,caux6;
        <span class="keyword">static</span> <span class="keywordtype">double</span> caux3,caux4,caux5,aux;
        <span class="keyword">static</span> <span class="keywordtype">double</span> xx,yy,rho;
        <span class="keyword">static</span> <span class="keywordtype">double</span> ppi= 3.14159265358979324;

        aa=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*p*tt*(tt-p),0.5);
        caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(aa);

        aa=exp(-(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt))/tt;

        caux=0.5*aa*caux*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*p*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*s+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*s*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((s*(tt-p))/(p*(tt-s)),0.5);
        caux1=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux1=-0.5*aa*caux1*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>);


        aa=exp(-(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt))/tt;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*p*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*s-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*s*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((s*(tt-p))/(p*(tt-s)),0.5);
        caux2=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux2=-0.5*aa*caux2*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>);

        aa=-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((p-s)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*p*s,0.5),0.5);
        aux=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(p/(ppi*tt*(tt-p)),0.5)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(aa);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt);
        yy=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p)),2)/(4.0*p*tt*(tt-p));
        caux3=aux*exp(-xx)*exp(-yy)/2.0;


        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt);
        yy=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p)),2)/(4.0*p*tt*(tt-p));
        caux4=aux*exp(-xx)*exp(-yy)/2.0;

        aa=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((p-s)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p)*(tt-s),0.5),0.5);
        aux=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(s/(ppi*tt*(tt-s)),0.5)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(aa);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt);
        yy=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*s-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s)),2)/(4.0*s*tt*(tt-s));
        caux5=aux*exp(-xx)*exp(-yy)/2.0;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt);
        yy=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*s+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s)),2)/(4.0*s*tt*(tt-s));
        caux6=aux*exp(-xx)*exp(-yy)/2.0;

        aux=exp((1.0-gm)*(1.0-gm)*tt/4.0)*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(tt,0.5);

        result=(caux+caux1+caux2+caux3+caux4+caux5+caux6)/(aux*2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi,0.5));
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aeddd4e8e35788bbb6f46de640e6c79f6"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::derivn3" ref="aeddd4e8e35788bbb6f46de640e6c79f6" args="(double limit[4], double sigmarho[4], int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aeddd4e8e35788bbb6f46de640e6c79f6">derivn3</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>limit</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigmarho</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>!! idx=3</p>
<p>!! idx=3 </p>

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00776">776</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00646">ddll()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keyword">static</span> <span class="keywordtype">double</span> aa;
        <span class="keyword">static</span> <span class="keywordtype">double</span> xx,yy,rho,sc;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  ppi= 3.14159265358979324;
        <span class="keyword">static</span> <span class="keywordtype">double</span> deriv;
        sc=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*ppi,0.5);

        <span class="keywordflow">if</span>(idx==1)
            {
                aa=exp(-0.5*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(limit[1],2));
                xx=(limit[3]-sigmarho[2]*limit[1])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(sigmarho[2],2)),0.5);
                yy=(limit[2]-sigmarho[1]*limit[1])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(sigmarho[1],2)),0.5);
                rho=(sigmarho[3]-sigmarho[1]*sigmarho[2])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-sigmarho[1]*sigmarho[1])*(1.0-sigmarho[2]*sigmarho[2]),0.5);
                deriv=aa*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho)/sc;
            }
        <span class="keywordflow">else</span>
            {
                <span class="keywordflow">if</span>(idx==2)
                    {
                        aa=exp(-0.5*limit[2]*limit[2]);
                        xx=(limit[1]-sigmarho[1]*limit[2])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(sigmarho[1],2)),0.5);
                        yy=(limit[3]-sigmarho[3]*limit[2])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(sigmarho[3],2)),0.5);
                        rho=(sigmarho[2]-sigmarho[1]*sigmarho[3])/ \
                            <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-sigmarho[1]*sigmarho[1])*(1.0-sigmarho[3]*sigmarho[3]),0.5);
                        deriv=aa*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho)/sc;
                    }
                <span class="keywordflow">else</span>
                    {
                        aa=exp(-0.5*limit[3]*limit[3]);

                        xx=(limit[1]-sigmarho[2]*limit[3])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(sigmarho[2],2)),0.5);
                        yy=(limit[2]-sigmarho[3]*limit[3])/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(sigmarho[3],2)),0.5);
                        rho=(sigmarho[1]-sigmarho[2]*sigmarho[3])/ \
                            <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-sigmarho[2]*sigmarho[2])*(1.0-sigmarho[3]*sigmarho[3]),0.5);
                        deriv=aa*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho)/sc;
                    }

            }
        <span class="keywordflow">return</span>(deriv);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a52651175fbb4f00e632decc2b753bbff"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::dff" ref="a52651175fbb4f00e632decc2b753bbff" args="(double s, double p, double tt, double a, double b, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a52651175fbb4f00e632decc2b753bbff">dff</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00518">518</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> result;
        <span class="keywordtype">double</span> aa,caux,caux1,caux2;
        <span class="keywordtype">double</span> xx,yy,rho;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        caux=-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(xx)*exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        caux1=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux1=exp(0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*caux1;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        caux2=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux2=exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*caux2;

        aa=exp((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-(1.0-gm)*(1.0-gm))*(tt-s)/4.0);

        result=(caux+caux1+caux2)*aa;
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a14ed968e88e78b2fc5074d1a5788374e"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::dll" ref="a14ed968e88e78b2fc5074d1a5788374e" args="(double s, double p, double tt, double a, double b, double c, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a14ed968e88e78b2fc5074d1a5788374e">dll</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00551">551</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::c</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, and <a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> result;
        <span class="keywordtype">double</span> aa,caux,caux1;
        <span class="keywordtype">double</span> sigmarho[4],limit[4],epsi;
        <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a>(<span class="keywordtype">int</span> jj,<span class="keywordtype">double</span> limit[4],<span class="keywordtype">double</span> sigmarho[4],<span class="keywordtype">double</span> epsi);

        epsi=1.e-12;
        limit[1]=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        limit[2]=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        limit[3]=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*tt+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);
        sigmarho[1]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        sigmarho[2]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/tt,0.5);
        sigmarho[3]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-s)/tt,0.5);

        caux=exp(0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a>(0,limit,sigmarho,epsi);

        limit[1]=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        limit[2]=(-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-s),0.5);
        limit[3]=(-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*tt+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);
        sigmarho[1]=-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/(tt-s),0.5);
        sigmarho[2]=-<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/tt,0.5);
        sigmarho[3]=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-s)/tt,0.5);

        caux1=-exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a>(0,limit,sigmarho,epsi);

        aa=exp((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-(1.0-gm)*(1.0-gm))*(tt-s)/4.0);


        result=(caux+caux1)*aa;

        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aa5c95c98bae41d2f28453830768d0660"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::dvv" ref="aa5c95c98bae41d2f28453830768d0660" args="(double s, double p, double tt, double a, double b, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa5c95c98bae41d2f28453830768d0660">dvv</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00482">482</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> ppi= 3.14159265358979324;
        <span class="keywordtype">double</span> result;
        <span class="keywordtype">double</span> aa,caux,caux1,caux2;
        <span class="keywordtype">double</span> xx,yy,rho;

        aa=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*p*tt*(tt-p),0.5);
        caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(aa);

        aa=exp((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt))*exp(<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-gm),2)*tt/4.0)*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(tt,0.5);
        caux=-caux/aa;

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*p*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*s+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*s*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((s*(tt-p))/(p*(tt-s)),0.5);
        caux1=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux1=caux1/aa;


        aa=exp((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)/(4.0*tt))*exp(<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-gm),2)*tt/4.0)*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(tt,0.5);

        xx=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*p-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*p*(tt-p),0.5);
        yy=(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*s-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-s))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt*s*(tt-s),0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((s*(tt-p))/(p*(tt-s)),0.5);
        caux2=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);
        caux2=caux2/aa;
        result=(caux+caux1+caux2)/(2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi,0.5));
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="abd0702ab2efd15487a19263a556852ed"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ff" ref="abd0702ab2efd15487a19263a556852ed" args="(double p, double tt, double a, double b, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd0702ab2efd15487a19263a556852ed">ff</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00413">413</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>, <a class="el" href="integralhestonvarianceoptionengine_8cpp_source.html#l00054">anonymous_namespace{integralhestonvarianceoptionengine.cpp}::IvopOneDim()</a>, and <a class="el" href="integralhestonvarianceoptionengine_8cpp_source.html#l00198">anonymous_namespace{integralhestonvarianceoptionengine.cpp}::IvopTwoDim()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                {
        <span class="keywordtype">double</span> phid;
        <span class="keywordtype">double</span> aa, caux;
        <span class="keywordtype">double</span> ppi= 3.14159265358979324;

        aa=-(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*p-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*tt+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);

        caux=2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi,0.5)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(aa);
        aa=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-(1.0-gm)*(1.0-gm);
        aa=aa/4.0;
        phid=exp(-0.5*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)*exp(aa*(tt-p))*caux;

        <span class="keywordflow">return</span> phid;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a18ee9929f01bcb3568544248b01ed6e4"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::fxy" ref="a18ee9929f01bcb3568544248b01ed6e4" args="(double x, double y, double a, double b, double rho)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a18ee9929f01bcb3568544248b01ed6e4">fxy</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00388">388</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                   {
        <span class="keywordtype">double</span> a_s;
        <span class="keywordtype">double</span> b_s;
        <span class="keywordtype">double</span> result;
        a_s = <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a> / sqrt(2 * (1 - rho * rho));
        b_s = <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a> / sqrt(2 * (1 - rho * rho));
        result = exp(a_s * (2 * x - a_s) + b_s * (2 * y - b_s) + 2 * rho * (x - a_s) * (y - b_s));
        <span class="keywordflow">return</span> result;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a7a928543a2509276892abc731ff7c55d"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::KRNRDT" ref="a7a928543a2509276892abc731ff7c55d" args="(double, double, double(*TVTMFN)(double, double, double, double, double, double, double, double, double, int), double)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a7a928543a2509276892abc731ff7c55d">KRNRDT</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double, double, double, double, double, double, double, double, double, int)&#160;</td>
          <td class="paramname"><em>TVTMFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01000">ADONET()</a>.</p>

</div>
</div>
<a class="anchor" id="a887b3dd544e90342af96092dde616a1b"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::KRNRDT" ref="a887b3dd544e90342af96092dde616a1b" args="(double A, double B, double(*TVTMFN)(double X, double H1, double H2, double H3, double R23, double RUA, double RUB, double AR, double RUC, int NUC), double ERR)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a7a928543a2509276892abc731ff7c55d">KRNRDT</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double X, double H1, double H2, double H3, double R23, double RUA, double RUB, double AR, double RUC, int NUC)&#160;</td>
          <td class="paramname"><em>TVTMFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ERR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01039">1039</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="matrices_8cpp_source.html#l00037">anonymous_namespace{matrices.cpp}::N</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01125">STUDNT()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00944">TVTMFN()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                                                                                {

        <span class="comment">//</span>
        <span class="comment">//     Kronrod Rule</span>
        <span class="comment">//</span>
        <span class="keyword">static</span> <span class="keywordtype">double</span>  <a class="code" href="class_t.html">T</a>, CEN, FC, WID, RESG, RESK;

        <span class="keywordtype">double</span>  <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>(<span class="keywordtype">int</span>, <span class="keywordtype">double</span> );
        <span class="keyword">static</span> <span class="keywordtype">double</span> result;
        <span class="comment">//</span>
        <span class="comment">//        The abscissae and weights are given for the interval (-1,1);</span>
        <span class="comment">//        only positive abscissae and corresponding weights are given.</span>
        <span class="comment">//</span>
        <span class="comment">//        XGK    - abscissae of the 2N+1-point Kronrod rule:</span>
        <span class="comment">//                 XGK(2), XGK(4), ...  N-point Gauss rule abscissae;</span>
        <span class="comment">//                 XGK(1), XGK(3), ...  optimally added abscissae.</span>
        <span class="comment">//        WGK    - weights of the 2N+1-point Kronrod rule.</span>
        <span class="comment">//        WG     - weights of the N-point Gauss rule.</span>
        <span class="comment">//</span>
        <span class="keywordtype">int</span> J, <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>=11;

        <span class="keyword">static</span> <span class="keywordtype">double</span>  WG[7], WGK[13], XGK[13];

        WG[1]= 0.2729250867779007;
        WG[2]=0.05566856711617449;
        WG[3]=0.1255803694649048;
        WG[4]=0.1862902109277352;
        WG[5]= 0.2331937645919914;
        WG[6]= 0.2628045445102478;
        <span class="comment">//</span>
        XGK[1]= 0.0000000000000000;
        XGK[2]= 0.9963696138895427;
        XGK[3]= 0.9782286581460570;
        XGK[4]= 0.9416771085780681;
        XGK[5]= 0.8870625997680953;
        XGK[6]= 0.8160574566562211;
        XGK[7]= 0.7301520055740492;
        XGK[8]= 0.6305995201619651;
        XGK[9]= 0.5190961292068118;
        XGK[10]= 0.3979441409523776;
        XGK[11]= 0.2695431559523450;
        XGK[12]= 0.1361130007993617;
        <span class="comment">//</span>
        WGK[1]=0.1365777947111183;
        WGK[2]=0.9765441045961290e-02;
        WGK[3]=0.2715655468210443e-01;
        WGK[4]=0.4582937856442671e-01;
        WGK[5]=0.6309742475037484e-01;
        WGK[6]=0.7866457193222764e-01;
        WGK[7]=0.9295309859690074e-01;
        WGK[8]=0.1058720744813894;
        WGK[9]=0.1167395024610472;
        WGK[10]=0.1251587991003195;
        WGK[11]=0.1312806842298057;
        WGK[12]=0.1351935727998845;
        <span class="comment">/*</span>
<span class="comment">          Major variables</span>
<span class="comment"></span>
<span class="comment">          CEN  - mid point of the interval</span>
<span class="comment">          WID  - half-length of the interval</span>
<span class="comment">          RESG - result of the N-point Gauss formula</span>
<span class="comment">          RESK - result of the 2N+1-point Kronrod formula</span>
<span class="comment">          Compute the 2N+1-point Kronrod approximation to</span>
<span class="comment">          the integral, and estimate the absolute error.</span>
<span class="comment">        */</span>
        WID = ( B - A )/2.0;
        CEN = ( B + A )/2.0;

        FC = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>(CEN,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>,  <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>);

        RESG = FC*WG[0+1];
        RESK = FC*WGK[0+1];

        <span class="keywordflow">for</span> (J = 1; J&lt;= <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#ac87ee18cd779f22a128d46ae455ac2f8">N</a>; J++)
            {
                T = WID*XGK[J+1];
                FC = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>(CEN-T,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>,  <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a> )+<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>(CEN+T,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>,  <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a> );
                RESK = RESK + WGK[J+1]*FC;
                <span class="keywordflow">if</span>((J-2*<span class="keywordtype">int</span>(J/2)) == 0 ) RESG = RESG + WG[1+J/2]*FC;
            }
        result = WID*RESK;
        ERR = fabs( WID*( RESK - RESG ) );
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a136be4926ac994114e726843fbfd0e9b"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::llold" ref="a136be4926ac994114e726843fbfd0e9b" args="(double p, double tt, double a, double b, double c, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a136be4926ac994114e726843fbfd0e9b">llold</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00452">452</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::c</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                            {
        <span class="keywordtype">double</span> bvnd;
        <span class="keywordtype">double</span> xx,yy,rho,caux;
        <span class="keywordtype">double</span> ppi= 3.14159265358979324;
        <span class="keywordtype">double</span> aa;

        xx=(-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*(tt-p))/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*(tt-p),0.5);
        yy=(-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*tt+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ad0cf80d5912ef85423efe32835d4603c">c</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*tt,0.5);
        rho=<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((tt-p)/tt,0.5);
        aa=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-(1.0-gm)*(1.0-gm);
        aa=aa/4.0;
        caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a>(-xx,-yy,rho);

        bvnd=2.0*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(ppi,0.5)*exp(-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>*<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*0.5)*exp(aa*(tt-p))*caux;
        <span class="keywordflow">return</span>(bvnd);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a92f65f969a12afdf46cdcd5ec12534cb"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::nc" ref="a92f65f969a12afdf46cdcd5ec12534cb" args="(double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a92f65f969a12afdf46cdcd5ec12534cb">nc</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00304">304</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00299">ndf()</a>.</p>
<div class="fragment"><pre class="fragment">                       {
        <span class="keywordtype">double</span> result;
        <span class="keywordflow">if</span> (x&lt;-7.) {
            result = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa081b5a3b7ab1aa27ab243b2fa4e85e1">ndf</a>(x)/sqrt(1.+x*x);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x&gt;7.) {
            result = 1. - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a92f65f969a12afdf46cdcd5ec12534cb">nc</a>(-x);
        } <span class="keywordflow">else</span> {
            result = 0.2316419;
            <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>[5] = {0.31938153,-0.356563782,1.781477937,-1.821255978,1.330274429};
            result=1./(1+result*fabs(x));
            result=1-<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa081b5a3b7ab1aa27ab243b2fa4e85e1">ndf</a>(x)*(result*(a[0]+result*(a[1]+result*(a[2]+result*(a[3]+result*a[4])))));
            <span class="keywordflow">if</span> (x&lt;=0.) result=1.-result;
        }
        <span class="keywordflow">return</span> result;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ae282125e85629aa0c3e5837e86f038f7"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ND2" ref="ae282125e85629aa0c3e5837e86f038f7" args="(double a, double b, double rho)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae282125e85629aa0c3e5837e86f038f7">ND2</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">1318</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::b</a>, <a class="el" href="matrices_8cpp_source.html#l00038">anonymous_namespace{matrices.cpp}::I</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01165">BVTL()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00590">ddff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00711">ddvv()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00776">derivn3()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00518">dff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00482">dvv()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00452">llold()</a>.</p>
<div class="fragment"><pre class="fragment">                                               {
        <span class="comment">/*</span>
<span class="comment">         *     A function for computing bivariate normal probabilities.</span>
<span class="comment">         *     This function is based on the method described by</span>
<span class="comment">         *     Z. Drezner and G.O. Wesolowsky, (1989),</span>
<span class="comment">         *     On the computation of the bivariate normal integral,</span>
<span class="comment">         *     Journal of Statist. Comput. Simul. 35, pp. 101-107,</span>
<span class="comment">         *     with major modifications for double precision, and for |R| close to 1.</span>
<span class="comment">         *     The software given here has been developed by M.C. Recchioni based on previous</span>
<span class="comment">         *     software developed by:</span>
<span class="comment">         *     Alan Genz</span>
<span class="comment">         *     Department of Mathematics</span>
<span class="comment">         *     Washington State University</span>
<span class="comment">         *     Pullman, WA 99164-3113</span>
<span class="comment">         *     Email : alangenz@wsu.edu</span>
<span class="comment">         *     The software developed by A. Genz is available free of charge in the website:</span>
<span class="comment">         *     www.math.wsu.edu/faculty/genz/software/software.html</span>
<span class="comment">         *</span>
<span class="comment">         *</span>
<span class="comment">         *      ND2 calculates the probability that X &gt; DH and Y &gt; DK.</span>
<span class="comment">         *      Note: Prob( X &lt; DH, Y &lt; DK ) = ND2( -DH, -DK, R ).</span>
<span class="comment">         *</span>
<span class="comment">         * Parameters</span>
<span class="comment">         *</span>
<span class="comment">         *   DH  DOUBLE PRECISION, integration limit</span>
<span class="comment">         *   DK  DOUBLE PRECISION, integration limit</span>
<span class="comment">         *   R   DOUBLE PRECISION, correlation coefficient</span>
<span class="comment">         */</span>
        <span class="keyword">static</span> <span class="keywordtype">double</span> TWOPI = 6.283185307179586;
        <span class="keyword">static</span> <span class="keywordtype">double</span> result, DK, DH, R;
        <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>, IS, LG, NG;

        <span class="keyword">static</span> <span class="keywordtype">double</span> XL[11][4], WL[11][4], AS, AA, BB, C, D, RS, XS, BVN;
        <span class="keyword">static</span> <span class="keywordtype">double</span> SN, ASR, H, K, BS, HS, HK;
        <span class="comment">//  Gauss Legendre Points and Weights, N =  6</span>
        <span class="comment">//  DATA ( W(I,1), X(I,1), I = 1,3) /</span>
        WL[1][1]=0.1713244923791705;
        XL[1][1]=-0.9324695142031522;
        WL[2][1]= 0.3607615730481384;
        XL[2][1]=-0.6612093864662647;
        WL[3][1]= 0.4679139345726904;
        XL[3][1]=-0.2386191860831970;

        <span class="comment">//  Gauss Legendre Points and Weights, N = 12</span>
        <span class="comment">//  DATA ( W(I,2), X(I,2), I = 1,6) /</span>
        WL[1][2]=0.4717533638651177e-01;
        XL[1][2]=-0.9815606342467191;
        WL[2][2]=  0.1069393259953183;
        XL[2][2]=-0.9041172563704750;
        WL[3][2]=  0.1600783285433464;
        XL[3][2]=-0.7699026741943050;
        WL[4][2]=  0.2031674267230659;
        XL[4][2]=-0.5873179542866171;
        WL[5][2]=  0.2334925365383547;
        XL[5][2]=-0.3678314989981802;
        WL[6][2] = 0.2491470458134029;
        XL[6][2]=-0.1252334085114692;

        <span class="comment">//  Gauss Legendre Points and Weights, N = 20</span>
        <span class="comment">//  DATA ( W(I,3), X(I,3), I = 1, 10 ) /</span>
        WL[1][3]=0.1761400713915212e-01;
        XL[1][3]=-0.9931285991850949;
        WL[2][3]=0.4060142980038694e-01;
        XL[2][3]=-0.9639719272779138;
        WL[3][3]=0.6267204833410906e-01;
        XL[3][3]=-0.9122344282513259;
        WL[4][3]=0.8327674157670475e-01;
        XL[4][3]=-0.8391169718222188;
        WL[5][3]=0.1019301198172404;
        XL[5][3]=-0.7463319064601508;
        WL[6][3]=0.1181945319615184;
        XL[6][3]=-0.6360536807265150;
        WL[7][3]=0.1316886384491766;
        XL[7][3]=-0.5108670019508271;
        WL[8][3]=0.1420961093183821;
        XL[8][3]=-0.3737060887154196;
        WL[9][3]=0.1491729864726037;
        XL[9][3]=-0.2277858511416451;
        WL[10][3]=0.1527533871307259;
        XL[10][3]=-0.7652652113349733e-01;

        R=rho;
        DH=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>;
        DK=<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>;

        <span class="keywordflow">if</span>( fabs(R) &lt; 0.3 ) {
            NG = 1;
            LG = 3; }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fabs(R) &lt; 0.75 ) {
            NG = 2;
            LG = 6;}
        <span class="keywordflow">else</span>{
            NG = 3;
            LG = 10;
        }
        H = DH;
        K = DK;
        HK = H*K;

        BVN = 0.0 ;
        <span class="keywordflow">if</span>( fabs(R) &lt; 0.925 ) {
            <span class="keywordflow">if</span>( fabs(R) &gt; 0 ) {
                HS = ( H*H + K*K )/2;
                ASR = asin(R);
                <span class="keywordflow">for</span> (I = 1;I&lt;= LG; I++){
                    <span class="keywordflow">for</span>( IS = -1; IS&lt;= 1; IS=IS+2){
                        SN = sin( ASR*(  IS*XL[I][NG] + 1 )/2 );
                        BVN = BVN + WL[<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>][NG]*exp( ( SN*HK-HS )/( 1.0-SN*SN ) );

                    }
                }
                BVN = BVN*ASR/( 2*TWOPI );

            }

            BVN = BVN + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(-H)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(-K);

        }
        <span class="keywordflow">else</span>
            {
                <span class="keywordflow">if</span> ( R &lt; 0 ) {
                    K = -K;
                    HK = -HK;
                }

                <span class="keywordflow">if</span>( fabs(R) &lt;1 ) {
                    AS = ( 1 - R )*( 1 + R );
                    AA = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(AS,0.5);

                    BS = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( H - K ),2);
                    C = ( 4 - HK )/8 ;
                    D = ( 12 - HK )/16;
                    ASR = -( BS/AS + HK )/2;
                    <span class="keywordflow">if</span>( ASR &gt; -100 ) BVN = AA*exp(ASR)*( 1 - C*( BS - AS )*( 1 - D*BS/5 )/3 + C*D*AS*AS/5 );
                    <span class="keywordflow">if</span>( -HK&lt;100 ){
                        BB = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(BS,0.5);
                        BVN = BVN - exp( -HK/2 )*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(TWOPI,0.5)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(-BB/AA)*BB*( 1 - C*BS*( 1 - D*BS/5 )/3 );
                    }
                    AA = AA/2   ;
                    <span class="keywordflow">for</span> (I = 1; I&lt;= LG;I++){
                        <span class="keywordflow">for</span>( IS = -1; IS&lt;=1; IS=IS+2){
                            XS =<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( ( AA*(  IS*XL[I][NG] + 1 ) ),2)  ;
                            RS = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>( (1 - XS),2 );
                            ASR = -( BS/XS + HK )/2;
                            <span class="keywordflow">if</span> ( ASR &gt; -100 ) {

                                BVN = BVN + AA*WL[<a class="code" href="namespaceanonymous__namespace_02matrices_8cpp_03.html#acde38c3bc61e50097a3422b06a1816aa">I</a>][NG]*exp( ASR )*(exp( -HK*( 1 - RS )/( 2*( 1 + RS ) ) )/RS- ( 1 + C*XS*( 1 + D*XS ) ) );


                            }
                        }
                    }
                    BVN = -BVN/TWOPI;
                }
                <span class="keywordflow">if</span> ( R &gt; 0 )  {

                    BVN =  BVN + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>( -max( H, K ) );

                }
                <span class="keywordflow">else</span>
                    {
                        BVN = -BVN;
                        <span class="keywordflow">if</span>( K &gt; H ) BVN = BVN + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(K) - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(H);
                    }
            }


        result=BVN;

        <span class="keywordflow">return</span>(result);

    }
</pre></div>
</div>
</div>
<a class="anchor" id="aa081b5a3b7ab1aa27ab243b2fa4e85e1"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::ndf" ref="aa081b5a3b7ab1aa27ab243b2fa4e85e1" args="(double t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aa081b5a3b7ab1aa27ab243b2fa4e85e1">ndf</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00299">299</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00304">nc()</a>.</p>
<div class="fragment"><pre class="fragment">                         {
        <span class="keywordflow">return</span> 0.398942280401433*exp(-<a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>*<a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>/2);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a95a2d20c2dbb17ceb66217aae9befa91"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::PHID" ref="a95a2d20c2dbb17ceb66217aae9befa91" args="(double Z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">321</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00590">ddff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00711">ddvv()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00518">dff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00482">dvv()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00413">ff()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01318">ND2()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01290">PNTGND()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01125">STUDNT()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00433">v()</a>.</p>
<div class="fragment"><pre class="fragment">                         {
        <span class="comment">/*</span>
<span class="comment">         *     Normal distribution probabilities accurate to 1D-15.</span>
<span class="comment">         *     Z = number of standard deviations from the mean.</span>
<span class="comment">         *</span>
<span class="comment">         *     The software that computes the normal distribution</span>
<span class="comment">         *     probabilities has been developed by M.C. Recchioni</span>
<span class="comment">         *     based upon algorithm 5666 (Programmer Alan Miller)</span>
<span class="comment">         *     for the error function, taken from:</span>
<span class="comment">         *     Hart, J.F. et al, &#39;Computer Approximations&#39;, Wiley, 1968</span>
<span class="comment">         *</span>
<span class="comment">         */</span>
        <span class="keywordtype">double</span> P0, P1, P2, P3, P4, P5, P6;
        <span class="keywordtype">double</span> Q0, Q1, Q2, Q3, Q4, Q5, Q6, Q7;
        <span class="keywordtype">double</span> P, EXPNTL, CUTOFF, ROOTPI, ZABS;

        P0 = 220.2068679123761;
        P1 = 221.2135961699311;
        P2 = 112.0792914978709;
        P3 = 33.91286607838300;
        P4 = 6.373962203531650;
        P5 = 0.7003830644436881;
        P6 = 0.03526249659989109;

        Q0 = 440.4137358247522;
        Q1 = 793.8265125199484;
        Q2 = 637.3336333788311;
        Q3 = 296.5642487796737;
        Q4 = 86.78073220294608;
        Q5 = 16.064177579206950;
        Q6 = 1.7556671631826420;
        Q7 = 0.088388347648318440;
        ROOTPI = 2.506628274631001;
        CUTOFF = 7.071067811865475;

        ZABS = fabs(Z);
        <span class="comment">/*</span>
<span class="comment">          |Z| &gt; 37</span>
<span class="comment">        */</span>
        <span class="keywordflow">if</span> (ZABS &gt; 37)
            P = 0;
        <span class="keywordflow">else</span>
        {
            <span class="comment">/*</span>
<span class="comment">              |Z| &lt;= 37</span>
<span class="comment">            */</span>
            EXPNTL =exp(-ZABS*ZABS/2);
            <span class="comment">/*</span>
<span class="comment">              |Z| &lt; CUTOFF = 10/SQRT(2)</span>
<span class="comment">            */</span>
            <span class="keywordflow">if</span> ( ZABS &lt; CUTOFF )
                P = EXPNTL*((((((P6*ZABS + P5)*ZABS + P4)*ZABS + P3)*ZABS+ P2)*ZABS + P1)*ZABS + P0)/(((((((Q7*ZABS + Q6)*ZABS + Q5)*ZABS + Q4)*ZABS + Q3)*ZABS + Q2)*ZABS + Q1)*ZABS + Q0);
            <span class="comment">/*</span>
<span class="comment">              |Z| &gt;= CUTOFF.</span>
<span class="comment">            */</span>
            <span class="keywordflow">else</span>
                P = EXPNTL/(ZABS + 1/(ZABS + 2/(ZABS + 3/(ZABS + 4/(ZABS + 0.65)))))/ROOTPI;

        }
        <span class="keywordflow">if</span> ( Z &gt; 0 ) P = 1 - P;

        <span class="keywordflow">return</span>(P);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a30555fb868b18f0d9657aafc473ddc6e"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::PNTGND" ref="a30555fb868b18f0d9657aafc473ddc6e" args="(int, double, double, double, double, double, double, double)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a30555fb868b18f0d9657aafc473ddc6e">PNTGND</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NUC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>BA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>BB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01290">1290</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01125">STUDNT()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00944">TVTMFN()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                         {
          <span class="comment">/*</span>
<span class="comment">            Computes Plackett formula integrand</span>
<span class="comment">          */</span>
          <span class="keyword">static</span> <span class="keywordtype">double</span> DT, FT, BT,result;
          <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>(<span class="keywordtype">int</span>, <span class="keywordtype">double</span>);

          result = 0.0;
          DT = RR*( RR - <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( RA - RB ),2) - 2*RA*RB*( 1 - R ) );
          <span class="keywordflow">if</span>( DT &gt; 0 ) {
              BT = ( BC*RR + BA*( R*RB - RA ) + BB*( R*RA -RB ) )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(DT,0.5);
              FT = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( BA - R*BB ),0.5)/RR + BB*BB;
              <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>&lt;1 ) {
                  <span class="keywordflow">if</span> ( (BT &gt; -10) &amp;&amp; (FT &lt;100) ) {
                      result = exp( -FT/2 );
                      <span class="keywordflow">if</span> ( BT &lt;10 ) result= result*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(BT);
                  } <span class="keywordflow">else</span> {
                      FT = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1 + FT/<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>),0.5);
                      result = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>, BT/FT )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(FT,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>);
                  }
              }
          }
          <span class="keywordflow">return</span>(result);
      }
</pre></div>
</div>
</div>
<a class="anchor" id="a6877f2a2f654587ecb96bf604fa5ac42"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::SINCS" ref="a6877f2a2f654587ecb96bf604fa5ac42" args="(double v1, double v2, double v3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6877f2a2f654587ecb96bf604fa5ac42">SINCS</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00972">972</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00032">SIGN</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00944">TVTMFN()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">/*</span>
<span class="comment">          Computes SIN(X), COS(X)^2, with series approx. for |X| near PI/2</span>
<span class="comment">        */</span>
        <span class="keyword">static</span> <span class="keywordtype">double</span> PT, EE;
        PT = 1.57079632679489661923132169163975;
        EE = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( PT - fabs(X) ),2);

        <span class="keywordflow">if</span> ( EE &lt; 5e-5 )
            {
                SX = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ac89d5f8a358eb8a1abdcd0fcef134f1a">SIGN</a>( 1 - EE*( 1 - EE/12 )/2, X );
                CS = EE*( 1 - EE*( 1 - 2*EE/15 )/3 );
            }
        <span class="keywordflow">else</span>
            {
                SX = sin(X);
                CS = 1 - SX*SX;
            }
        <span class="keywordflow">return</span>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a832cc566efd401151896e48abf8c5b77"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::STUDNT" ref="a832cc566efd401151896e48abf8c5b77" args="(int NU, double T)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a832cc566efd401151896e48abf8c5b77">STUDNT</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01125">1125</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00035">PI</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01165">BVTL()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01039">KRNRDT()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01290">PNTGND()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">/*</span>
<span class="comment">          Student t Distribution Function</span>
<span class="comment">        */</span>
        <span class="keyword">static</span> <span class="keywordtype">int</span> J;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  ZRO=0.0, ONE=1.0;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  CSSTHE, SNTHE, POLYN, TT, TS, RN;
        <span class="keyword">static</span> <span class="keywordtype">double</span> result;


        <span class="keywordflow">if</span> ( NU &lt; 1 ) result= <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>( <a class="code" href="class_t.html">T</a> );
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( NU == 1 ) result = ( 1 + 2.0*atan(<a class="code" href="class_t.html">T</a>)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a> )/2.0;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( NU == 2 ) result = ( 1 + <a class="code" href="class_t.html">T</a>/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( 2.0 + <a class="code" href="class_t.html">T</a>*<a class="code" href="class_t.html">T</a>),0.5))/2.0;
        <span class="keywordflow">else</span>
            {
                TT = <a class="code" href="class_t.html">T</a>*<a class="code" href="class_t.html">T</a>;
                CSSTHE = 1/( 1 + TT/double(NU) );
                POLYN = 1;
                <span class="keywordflow">for</span>( J = NU-2; J&gt;= 2; J=J-2)
                    {
                        POLYN = 1.0 + ( J - 1.0 )*CSSTHE*POLYN/(<span class="keywordtype">double</span>)J;
                    }
                <span class="keywordflow">if</span> ((NU-2*<span class="keywordtype">int</span>(NU/2) ) == 1 )
                    {
                        RN = NU;
                        TS = T/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(RN,0.5);
                        result = ( 1.0 + 2.0*( atan(TS) + TS*CSSTHE*POLYN )/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a> )/2.0;
                    }
                <span class="keywordflow">else</span>
                    {
                        SNTHE = T/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(( NU + TT ),0.5);
                        result = ( 1 + SNTHE*POLYN )/2.0;
                    }
                result = max( ZRO, min( result, ONE ) );
            }
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="af81500cb4ddf7928668ba1535dba066a"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::tvtl" ref="af81500cb4ddf7928668ba1535dba066a" args="(int jj, double limit[4], double sigmarho[4], double epsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>limit</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigmarho</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00646">ddll()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00551">dll()</a>.</p>

</div>
</div>
<a class="anchor" id="a2424516ac427745126c95f7e48e36087"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::tvtl" ref="a2424516ac427745126c95f7e48e36087" args="(int NU, double limit[], double sigmarho[], double epsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af81500cb4ddf7928668ba1535dba066a">tvtl</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>limit</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigmarho</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">830</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01000">ADONET()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">AR</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01165">BVTL()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">H2</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">H3</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00032">SIGN</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00944">TVTMFN()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">/*</span>
<span class="comment">          A function for computing trivariate normal and t-probabilities.</span>
<span class="comment"></span>
<span class="comment">          This function uses algorithms developed from the ideas</span>
<span class="comment">          described in the papers:</span>
<span class="comment">          R.L. Plackett, Biometrika 41(1954), pp. 351-360.</span>
<span class="comment">          Z. Drezner, Math. Comp. 62(1994), pp. 289-294.</span>
<span class="comment">          and uses adaptive integration.</span>
<span class="comment"></span>
<span class="comment">          The software given here is based on algorithms described in</span>
<span class="comment">          the paper A. Genz: &quot;Numerical Computation of Rectangular</span>
<span class="comment">          Bivariate and Trivariate Normal and t Probabilities&quot;,</span>
<span class="comment">          Statistics and Computing 14 (2004) 251-260.</span>
<span class="comment"></span>
<span class="comment">          This software has been developed by M.C. Recchioni based on</span>
<span class="comment">          previous software developed by</span>
<span class="comment">          Alan Genz</span>
<span class="comment">          Department of Mathematics</span>
<span class="comment">          Washington State University</span>
<span class="comment">          Pullman, WA 99164-3113</span>
<span class="comment">          Email : alangenz@wsu.edu</span>
<span class="comment">          The software developed by A. Genz is available free of</span>
<span class="comment">          charge in the website:</span>
<span class="comment">          www.math.wsu.edu/faculty/genz/software/software.html</span>
<span class="comment"></span>
<span class="comment">          The software calculates the probability that</span>
<span class="comment">          X(I) &lt; H(I), for I = 1,2,3</span>
<span class="comment"></span>
<span class="comment">          NU        INTEGER degrees of freedom; use NU = 0 for normal cases.</span>
<span class="comment">          LIMIT     REAL array of uppoer limits for probability distribution</span>
<span class="comment">          SIGMARHO  REAL array of three correlation coefficients, should</span>
<span class="comment">          contain the lower left portion of the correlation matrix.</span>
<span class="comment">          SIGMARHO should contains the values r21, r31, r23 in that order.</span>
<span class="comment">          EPSI      REAL required absolute accuracy; maximum accuracy for most</span>
<span class="comment">          computations is approximately 1D-14</span>
<span class="comment"></span>
<span class="comment">        */</span>

        <span class="keyword">static</span> <span class="keywordtype">double</span> result;
        <span class="keyword">static</span> <span class="keywordtype">double</span>  ONE=1.0, ZRO=0.0, EPS,  TVT;
        <span class="keyword">static</span> <span class="keywordtype">double</span> PT, R12, R13;
        <span class="keyword">static</span> <span class="keywordtype">double</span> ppi= 3.14159265358979324;
        EPS = max( 1.e-14, epsi );
        PT=ppi/2.0;

        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a> = NU;
        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a> = limit[1];
        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a> = limit[2];
        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a> = limit[3];
        R12 = sigmarho[1];
        R13 = sigmarho[2];
        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a> = sigmarho[3];
        <span class="comment">/*</span>
<span class="comment">         *     Sort R&#39;s and check for special cases</span>
<span class="comment">         */</span>
        <span class="keywordflow">if</span> ( fabs(R12) &gt; fabs(R13) ) {
            <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a> = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>;
            <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a> = limit[2];
            R12 = R13;
            R13 = sigmarho[1];
        }

        <span class="keywordflow">if</span> ( fabs(R13) &gt; fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>) ) {
            <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a> = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>;
            <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a> = limit[1];
            <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a> = R13;
            R13 = sigmarho[3];
        }

        TVT = 0.0;
        <span class="keywordflow">if</span> ( (fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>) + fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>) + fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>)) &lt; EPS ) TVT = ( 1 + ( asin(R12) + asin(R13) + asin(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>) )/PT )/8.0;

        <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ( (NU &lt; 1) &amp;&amp; ( (fabs(R12) + fabs(R13)) &lt; EPS) )  TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a> );

        <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ( (NU &lt; 1) &amp;&amp; ((fabs(R13) + fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>))&lt; EPS) ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, R12 );

        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (NU &lt; 1) &amp;&amp; ((fabs(R12) + fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>))&lt; EPS) ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>)*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, R13 );

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (1.0 - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>)&lt; EPS ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, min( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a> ), R12 );

        <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ( (<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a> + 1.0) &lt;EPS ) {
            <span class="keywordflow">if</span>  ( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a> &gt; -<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a> ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, R12 ) - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, -<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, R12 );}
        <span class="keywordflow">else</span>
            {
                <span class="comment">/*</span>
<span class="comment">                 *        Compute singular TVT value</span>
<span class="comment">                 */</span>
                <span class="keywordflow">if</span> ( NU &lt; 1 ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a> )*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>);

                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a> &gt; 0 ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, min( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a> ), ZRO );

                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a> &gt; -<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a> ) TVT = <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, ZRO ) - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aec796ffb56fd24f67e440e3210b09868">BVTL</a>( NU, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, -<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, ZRO );

                <span class="comment">/*</span>
<span class="comment">                 *        Use numerical integration to compute probability</span>
<span class="comment">                 *</span>
<span class="comment">                 */</span>
                <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a> = asin( R12 );
                <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a> = asin( R13 );
                <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a> = asin( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>);
                <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a> = <a class="code" href="perturbativebarrieroptionengine_8cpp.html#ac89d5f8a358eb8a1abdcd0fcef134f1a">SIGN</a>( PT, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a> ) - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a>;
                TVT = TVT + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a75e211334db54a064564a63ae12350d5">ADONET</a>(  ZRO, ONE, EPS, *<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a>)/( 4.0*PT );
            }
        result = max( ZRO, min( TVT, ONE ) );

        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a1b6ea2aace8541e1813a51805a26a185"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::TVTMFN" ref="a1b6ea2aace8541e1813a51805a26a185" args="(double X, double H1, double H2, double H3, double R23, double RUA, double RUB, double AR, double RUC, int NUC)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1b6ea2aace8541e1813a51805a26a185">TVTMFN</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>H1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>H2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>H3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R23</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RUA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RUB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RUC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NUC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00944">944</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01290">PNTGND()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00972">SINCS()</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01000">ADONET()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01039">KRNRDT()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                         {
        <span class="comment">/*</span>
<span class="comment">          Computes Plackett formula integrands</span>
<span class="comment">        */</span>

        <span class="keyword">static</span> <span class="keywordtype">double</span>  R12=0.0, RR2=0, R13=0.0, RR3=0.0, R=0.0, RR=0.0, ZRO=0.0;
        <span class="keyword">static</span> <span class="keywordtype">double</span> result;

        ZRO = 0.0;

        result = 0.0;

        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6877f2a2f654587ecb96bf604fa5ac42">SINCS</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>*X, R12, RR2 );
        <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6877f2a2f654587ecb96bf604fa5ac42">SINCS</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>*X, R13, RR3 );

        <span class="keywordflow">if</span> ( fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>)&gt; 0 )  result = result + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a>*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a30555fb868b18f0d9657aafc473ddc6e">PNTGND</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, R13,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>,R12,RR2);
        <span class="keywordflow">if</span>( fabs(<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>)&gt;0 ) result = result + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a>*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a30555fb868b18f0d9657aafc473ddc6e">PNTGND</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, R12,<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a>,R13,RR3 ) ;
        <span class="keywordflow">if</span> ( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a> &gt; 0 )
            {
                <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6877f2a2f654587ecb96bf604fa5ac42">SINCS</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a> + <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>*X, R, RR );
                result = result - <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a>*<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a30555fb868b18f0d9657aafc473ddc6e">PNTGND</a>( <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a>, <a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a>, ZRO, ZRO, R, RR );
            }
        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a1c6cf95dc58d77fbce730d3c1f8ccda7"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::v" ref="a1c6cf95dc58d77fbce730d3c1f8ccda7" args="(double p, double tt, double a, double b, double gm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a1c6cf95dc58d77fbce730d3c1f8ccda7">v</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00433">433</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::b</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00321">PHID()</a>, and <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00034">POW</a>.</p>

<p>Referenced by <a class="el" href="payoffs_8cpp_source.html#l00039">QuantLib::NullPayoff::accept()</a>, <a class="el" href="simplecashflow_8hpp_source.html#l00089">QuantLib::SimpleCashFlow::accept()</a>, <a class="el" href="dividend_8cpp_source.html#l00025">QuantLib::Dividend::accept()</a>, <a class="el" href="oisratehelper_8cpp_source.html#l00078">QuantLib::OISRateHelper::accept()</a>, <a class="el" href="payoff_8hpp_source.html#l00058">QuantLib::Payoff::accept()</a>, <a class="el" href="stickyratchet_8cpp_source.html#l00050">QuantLib::DoubleStickyRatchetPayoff::accept()</a>, <a class="el" href="digitalcmscoupon_8cpp_source.html#l00042">QuantLib::DigitalCmsCoupon::accept()</a>, <a class="el" href="digitaliborcoupon_8cpp_source.html#l00042">QuantLib::DigitalIborCoupon::accept()</a>, <a class="el" href="impliedvoltermstructure_8hpp_source.html#l00088">QuantLib::ImpliedVolTermStructure::accept()</a>, <a class="el" href="bondhelpers_8cpp_source.html#l00063">QuantLib::BondHelper::accept()</a>, <a class="el" href="event_8cpp_source.html#l00039">QuantLib::Event::accept()</a>, <a class="el" href="extendedblackvariancecurve_8hpp_source.html#l00086">QuantLib::ExtendedBlackVarianceCurve::accept()</a>, <a class="el" href="cmscoupon_8cpp_source.html#l00046">QuantLib::CmsCoupon::accept()</a>, <a class="el" href="iborcoupon_8cpp_source.html#l00120">QuantLib::IborCoupon::accept()</a>, <a class="el" href="cashflow_8cpp_source.html#l00049">QuantLib::CashFlow::accept()</a>, <a class="el" href="yoyinflationcoupon_8cpp_source.html#l00047">QuantLib::YoYInflationCoupon::accept()</a>, <a class="el" href="sabrvolsurface_8cpp_source.html#l00176">QuantLib::SabrVolSurface::accept()</a>, <a class="el" href="overnightindexedcoupon_8cpp_source.html#l00170">QuantLib::OvernightIndexedCoupon::accept()</a>, <a class="el" href="simplecashflow_8hpp_source.html#l00098">QuantLib::Redemption::accept()</a>, <a class="el" href="extendedblackvariancesurface_8hpp_source.html#l00082">QuantLib::ExtendedBlackVarianceSurface::accept()</a>, <a class="el" href="localconstantvol_8hpp_source.html#l00109">QuantLib::LocalConstantVol::accept()</a>, <a class="el" href="localvolcurve_8hpp_source.html#l00079">QuantLib::LocalVolCurve::accept()</a>, <a class="el" href="blackconstantvol_8hpp_source.html#l00123">QuantLib::BlackConstantVol::accept()</a>, <a class="el" href="localvolsurface_8cpp_source.html#l00077">QuantLib::LocalVolSurface::accept()</a>, <a class="el" href="callabilityschedule_8hpp_source.html#l00078">QuantLib::Callability::accept()</a>, <a class="el" href="fixedratecoupon_8hpp_source.html#l00108">QuantLib::FixedRateCoupon::accept()</a>, <a class="el" href="indexedcashflow_8hpp_source.html#l00088">QuantLib::IndexedCashFlow::accept()</a>, <a class="el" href="averagebmacoupon_8cpp_source.html#l00150">QuantLib::AverageBMACoupon::accept()</a>, <a class="el" href="defaultevent_8cpp_source.html#l00045">QuantLib::DefaultEvent::DefaultSettlement::accept()</a>, <a class="el" href="blackvariancecurve_8hpp_source.html#l00103">QuantLib::BlackVarianceCurve::accept()</a>, <a class="el" href="commoditycashflow_8cpp_source.html#l00025">QuantLib::CommodityCashFlow::accept()</a>, <a class="el" href="pathpayoff_8hpp_source.html#l00084">QuantLib::PathPayoff::accept()</a>, <a class="el" href="oisratehelper_8cpp_source.html#l00128">QuantLib::DatedOISRateHelper::accept()</a>, <a class="el" href="ql_2cashflows_2rangeaccrual_8cpp_source.html#l00086">QuantLib::RangeAccrualFloatersCoupon::accept()</a>, <a class="el" href="coupon_8cpp_source.html#l00073">QuantLib::Coupon::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00073">QuantLib::FloatingTypePayoff::accept()</a>, <a class="el" href="simplecashflow_8hpp_source.html#l00107">QuantLib::AmortizingPayment::accept()</a>, <a class="el" href="bondhelpers_8cpp_source.html#l00092">QuantLib::FixedRateBondHelper::accept()</a>, <a class="el" href="subperiodcoupons_8cpp_source.html#l00072">QuantLib::SubPeriodsCoupon::accept()</a>, <a class="el" href="ql_2cashflows_2capflooredcoupon_8cpp_source.html#l00130">QuantLib::CappedFlooredCoupon::accept()</a>, <a class="el" href="localvoltermstructure_8cpp_source.html#l00064">QuantLib::LocalVolTermStructure::accept()</a>, <a class="el" href="abcdatmvolcurve_8cpp_source.html#l00096">QuantLib::AbcdAtmVolCurve::accept()</a>, <a class="el" href="interestratevolsurface_8cpp_source.html#l00064">QuantLib::InterestRateVolSurface::accept()</a>, <a class="el" href="bootstraphelper_8hpp_source.html#l00156">QuantLib::BootstrapHelper&lt; TS &gt;::accept()</a>, <a class="el" href="blackvolsurface_8cpp_source.html#l00058">QuantLib::BlackVolSurface::accept()</a>, <a class="el" href="blackvariancesurface_8hpp_source.html#l00107">QuantLib::BlackVarianceSurface::accept()</a>, <a class="el" href="ratehelpers_8cpp_source.html#l00180">QuantLib::FuturesRateHelper::accept()</a>, <a class="el" href="inflationcoupon_8hpp_source.html#l00116">QuantLib::InflationCoupon::accept()</a>, <a class="el" href="equityfxvolsurface_8cpp_source.html#l00083">QuantLib::EquityFXVolSurface::accept()</a>, <a class="el" href="blackatmvolcurve_8cpp_source.html#l00083">QuantLib::BlackAtmVolCurve::accept()</a>, <a class="el" href="floatingratecoupon_8hpp_source.html#l00143">QuantLib::FloatingRateCoupon::accept()</a>, <a class="el" href="cpicoupon_8cpp_source.html#l00059">QuantLib::CPICoupon::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00093">QuantLib::PlainVanillaPayoff::accept()</a>, <a class="el" href="blackvoltermstructure_8hpp_source.html#l00281">QuantLib::BlackVolTermStructure::accept()</a>, <a class="el" href="capflooredinflationcoupon_8cpp_source.html#l00152">QuantLib::CappedFlooredYoYInflationCoupon::accept()</a>, <a class="el" href="ql_2cashflows_2capflooredcoupon_8hpp_source.html#l00120">QuantLib::CappedFlooredIborCoupon::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00113">QuantLib::PercentageStrikePayoff::accept()</a>, <a class="el" href="ratehelpers_8cpp_source.html#l00265">QuantLib::DepositRateHelper::accept()</a>, <a class="el" href="ql_2cashflows_2digitalcoupon_8cpp_source.html#l00284">QuantLib::DigitalCoupon::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00133">QuantLib::AssetOrNothingPayoff::accept()</a>, <a class="el" href="ql_2cashflows_2capflooredcoupon_8hpp_source.html#l00152">QuantLib::CappedFlooredCmsCoupon::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00159">QuantLib::CashOrNothingPayoff::accept()</a>, <a class="el" href="defaultevent_8cpp_source.html#l00031">QuantLib::DefaultEvent::accept()</a>, <a class="el" href="blackvoltermstructure_8hpp_source.html#l00297">QuantLib::BlackVolatilityTermStructure::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00184">QuantLib::GapPayoff::accept()</a>, <a class="el" href="ratehelpers_8cpp_source.html#l00438">QuantLib::FraRateHelper::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00197">QuantLib::SuperFundPayoff::accept()</a>, <a class="el" href="blackvoltermstructure_8hpp_source.html#l00314">QuantLib::BlackVarianceTermStructure::accept()</a>, <a class="el" href="payoffs_8cpp_source.html#l00215">QuantLib::SuperSharePayoff::accept()</a>, <a class="el" href="ratehelpers_8cpp_source.html#l00620">QuantLib::SwapRateHelper::accept()</a>, <a class="el" href="ratehelpers_8cpp_source.html#l00716">QuantLib::BMASwapRateHelper::accept()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00070">BarrierUPD()</a>, <a class="el" href="greeks_8cpp_source.html#l00025">QuantLib::blackScholesTheta()</a>, <a class="el" href="optionletvolatilitystructure_8hpp_source.html#l00153">QuantLib::OptionletVolatilityStructure::blackVariance()</a>, <a class="el" href="swaptionvolstructure_8hpp_source.html#l00243">QuantLib::SwaptionVolatilityStructure::blackVariance()</a>, <a class="el" href="jumpdiffusionengine_8cpp_source.html#l00041">QuantLib::JumpDiffusionEngine::calculate()</a>, <a class="el" href="kirkengine_8cpp_source.html#l00037">QuantLib::KirkEngine::calculate()</a>, <a class="el" href="analyticbsmhullwhiteengine_8cpp_source.html#l00074">QuantLib::AnalyticBSMHullWhiteEngine::calculate()</a>, <a class="el" href="binomialconvertibleengine_8hpp_source.html#l00064">QuantLib::BinomialConvertibleEngine&lt; T &gt;::calculate()</a>, <a class="el" href="binomialengine_8hpp_source.html#l00075">QuantLib::BinomialVanillaEngine&lt; T &gt;::calculate()</a>, <a class="el" href="collectnodedata_8cpp_source.html#l00036">QuantLib::collectNodeData()</a>, <a class="el" href="garch_8cpp_source.html#l00049">QuantLib::Garch11::costFunction()</a>, <a class="el" href="multicubicspline_8hpp_source.html#l00055">QuantLib::detail::DataTable&lt; X &gt;::DataTable()</a>, <a class="el" href="multicubicspline_8hpp_source.html#l00073">QuantLib::detail::DataTable&lt; Real &gt;::DataTable()</a>, <a class="el" href="ql_2timeseries_8hpp_source.html#l00289">QuantLib::TimeSeries&lt; T, Container &gt;::dates()</a>, <a class="el" href="fdm2dblackscholessolver_8cpp_source.html#l00082">QuantLib::Fdm2dBlackScholesSolver::deltaYat()</a>, <a class="el" href="bumpinstrumentjacobian_8cpp_source.html#l00042">QuantLib::VolatilityBumpInstrumentJacobian::derivativesVolatility()</a>, <a class="el" href="vasicek_8cpp_source.html#l00057">QuantLib::Vasicek::discountBondOption()</a>, <a class="el" href="hullwhite_8cpp_source.html#l00086">QuantLib::HullWhite::discountBondOption()</a>, <a class="el" href="g2_8cpp_source.html#l00077">QuantLib::G2::discountBondOption()</a>, <a class="el" href="kinterpolatedyoyoptionletvolatilitysurface_8hpp_source.html#l00168">QuantLib::KInterpolatedYoYOptionletVolatilitySurface&lt; Interpolator1D &gt;::Dslice()</a>, <a class="el" href="swaptionvolcube1_8cpp_source.html#l00739">QuantLib::SwaptionVolCube1::Cube::expandLayers()</a>, <a class="el" href="vectors_8hpp_source.html#l00035">QuantLib::detail::get()</a>, <a class="el" href="test-suite_2hestonmodel_8cpp_source.html#l00062">anonymous_namespace{hestonmodel.cpp}::getDAXCalibrationMarketData()</a>, <a class="el" href="fdsimpleextoustorageengine_8cpp_source.html#l00049">QuantLib::anonymous_namespace{fdsimpleextoustorageengine.cpp}::FdmStorageValue::innerValue()</a>, <a class="el" href="vegabumpcluster_8cpp_source.html#l00149">QuantLib::VegaBumpCollection::isFull()</a>, <a class="el" href="vegabumpcluster_8cpp_source.html#l00187">QuantLib::VegaBumpCollection::isNonOverlapping()</a>, <a class="el" href="incrementalstatistics_8cpp_source.html#l00107">QuantLib::IncrementalStatistics::kurtosis()</a>, <a class="el" href="lsstrategy_8cpp_source.html#l00030">QuantLib::LongstaffSchwartzExerciseStrategy::LongstaffSchwartzExerciseStrategy()</a>, <a class="el" href="sobolrsg_8hpp_source.html#l00120">QuantLib::SobolRsg::nextSequence()</a>, <a class="el" href="chisquaredistribution_8cpp_source.html#l00033">QuantLib::NonCentralChiSquareDistribution::operator()()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01542">QuantLib::anonymous_namespace{perturbativebarrieroptionengine.cpp}::sigmaq_adapter::operator()()</a>, <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l01555">QuantLib::anonymous_namespace{perturbativebarrieroptionengine.cpp}::integs_adapter::operator()()</a>, <a class="el" href="complexarray_8hpp_source.html#l00402">QuantLib::operator+()</a>, <a class="el" href="lossdistribution_8cpp_source.html#l00067">QuantLib::LossDist::probabilityOfNEvents()</a>, <a class="el" href="multicubicspline_8hpp_source.html#l00539">QuantLib::MultiCubicSpline&lt; i &gt;::set_shared_coefficients()</a>, <a class="el" href="multicubicspline_8hpp_source.html#l00508">QuantLib::MultiCubicSpline&lt; i &gt;::set_shared_increments()</a>, <a class="el" href="yoyinflationoptionletvolatilitystructure_8hpp_source.html#l00129">QuantLib::YoYOptionletVolatilitySurface::setBaseLevel()</a>, <a class="el" href="couponpricer_8hpp_source.html#l00071">QuantLib::IborCouponPricer::setCapletVolatility()</a>, <a class="el" href="couponpricer_8hpp_source.html#l00124">QuantLib::CmsCouponPricer::setSwaptionVolatility()</a>, <a class="el" href="fdmblackscholesop_8cpp_source.html#l00053">QuantLib::FdmBlackScholesOp::setTime()</a>, <a class="el" href="inflationcapfloorengines_8cpp_source.html#l00037">QuantLib::YoYInflationCapFloorEngine::setVolatility()</a>, <a class="el" href="interpolatedyoyoptionletstripper_8hpp_source.html#l00292">QuantLib::InterpolatedYoYOptionletStripper&lt; Interpolator1D &gt;::slice()</a>, <a class="el" href="bicgstab_8cpp_source.html#l00037">QuantLib::BiCGstab::solve()</a>, <a class="el" href="linearleastsquaresregression_8cpp_source.html#l00181">LinearLeastSquaresRegressionTest::test1dLinearRegression()</a>, <a class="el" href="mclongstaffschwartzengine_8cpp_source.html#l00210">MCLongstaffSchwartzEngineTest::testAmericanMaxOption()</a>, <a class="el" href="lookbackoptions_8cpp_source.html#l00169">LookbackOptionTest::testAnalyticContinuousFixedLookback()</a>, <a class="el" href="lookbackoptions_8cpp_source.html#l00091">LookbackOptionTest::testAnalyticContinuousFloatingLookback()</a>, <a class="el" href="asianoptions_8cpp_source.html#l00166">AsianOptionTest::testAnalyticContinuousGeometricAveragePriceGreeks()</a>, <a class="el" href="asianoptions_8cpp_source.html#l00827">AsianOptionTest::testAnalyticDiscreteGeometricAveragePriceGreeks()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00435">DigitalOptionTest::testAssetAtExpiryOrNothingAmericanValues()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00307">DigitalOptionTest::testAssetAtHitOrNothingAmericanValues()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00129">DigitalOptionTest::testAssetOrNothingEuropeanValues()</a>, <a class="el" href="americanoption_8cpp_source.html#l00074">AmericanOptionTest::testBaroneAdesiWhaleyValues()</a>, <a class="el" href="quantooption_8cpp_source.html#l00823">QuantoOptionTest::testBarrierValues()</a>, <a class="el" href="americanoption_8cpp_source.html#l00178">AmericanOptionTest::testBjerksundStenslandValues()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00373">DigitalOptionTest::testCashAtExpiryOrNothingAmericanValues()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00503">DigitalOptionTest::testCashAtHitOrNothingAmericanGreeks()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00239">DigitalOptionTest::testCashAtHitOrNothingAmericanValues()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00074">DigitalOptionTest::testCashOrNothingEuropeanValues()</a>, <a class="el" href="test-suite_2gjrgarchmodel_8cpp_source.html#l00196">GJRGARCHModelTest::testDAXCalibration()</a>, <a class="el" href="test-suite_2batesmodel_8cpp_source.html#l00381">BatesModelTest::testDAXCalibration()</a>, <a class="el" href="test-suite_2blackdeltacalculator_8cpp_source.html#l00152">BlackDeltaCalculatorTest::testDeltaPriceConsistency()</a>, <a class="el" href="test-suite_2hybridhestonhullwhiteprocess_8cpp_source.html#l00771">HybridHestonHullWhiteProcessTest::testDiscretizationError()</a>, <a class="el" href="matrices_8cpp_source.html#l00101">MatricesTest::testEigenvectors()</a>, <a class="el" href="extendedtrees_8cpp_source.html#l00166">anonymous_namespace{extendedtrees.cpp}::testEngineConsistency()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l01009">anonymous_namespace{europeanoption.cpp}::testEngineConsistency()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00322">DividendOptionTest::testEuropeanEndLimit()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00421">DividendOptionTest::testEuropeanGreeks()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00163">DividendOptionTest::testEuropeanKnownValue()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00229">DividendOptionTest::testEuropeanStartLimit()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00064">DividendOptionTest::testEuropeanValues()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00569">DividendOptionTest::testFdEuropeanValues()</a>, <a class="el" href="americanoption_8cpp_source.html#l00430">anonymous_namespace{americanoption.cpp}::testFdGreeks()</a>, <a class="el" href="dividendoption_8cpp_source.html#l00677">anonymous_namespace{dividendoption.cpp}::testFdGreeks()</a>, <a class="el" href="swingoption_8cpp_source.html#l00124">SwingOptionTest::testFdmExponentialJump1dMesher()</a>, <a class="el" href="fdheston_8cpp_source.html#l00056">FdHestonTest::testFdmHestonBarrierVsBlackScholes()</a>, <a class="el" href="americanoption_8cpp_source.html#l00372">AmericanOptionTest::testFdValues()</a>, <a class="el" href="quantooption_8cpp_source.html#l00530">QuantoOptionTest::testForwardGreeks()</a>, <a class="el" href="forwardoption_8cpp_source.html#l00210">anonymous_namespace{forwardoption.cpp}::testForwardGreeks()</a>, <a class="el" href="quantooption_8cpp_source.html#l00741">QuantoOptionTest::testForwardPerformanceValues()</a>, <a class="el" href="quantooption_8cpp_source.html#l00448">QuantoOptionTest::testForwardValues()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00184">DigitalOptionTest::testGapEuropeanValues()</a>, <a class="el" href="jumpdiffusion_8cpp_source.html#l00346">JumpDiffusionTest::testGreeks()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l00640">EuropeanOptionTest::testGreeks()</a>, <a class="el" href="quantooption_8cpp_source.html#l00244">QuantoOptionTest::testGreeks()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l00351">EuropeanOptionTest::testGreekValues()</a>, <a class="el" href="test-suite_2barrieroption_8cpp_source.html#l00110">BarrierOptionTest::testHaugValues()</a>, <a class="el" href="test-suite_2hybridhestonhullwhiteprocess_8cpp_source.html#l01223">HybridHestonHullWhiteProcessTest::testHestonHullWhiteCalibration()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l00801">EuropeanOptionTest::testImpliedVol()</a>, <a class="el" href="test-suite_2capfloor_8cpp_source.html#l00484">CapFloorTest::testImpliedVolatility()</a>, <a class="el" href="americanoption_8cpp_source.html#l00318">AmericanOptionTest::testJuValues()</a>, <a class="el" href="test-suite_2barrieroption_8cpp_source.html#l00568">BarrierOptionTest::testLocalVolAndHestonComparison()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l01415">EuropeanOptionTest::testLocalVolatility()</a>, <a class="el" href="digitaloption_8cpp_source.html#l00670">DigitalOptionTest::testMCCashAtHit()</a>, <a class="el" href="test-suite_2cliquetoption_8cpp_source.html#l00276">CliquetOptionTest::testMcPerformance()</a>, <a class="el" href="varianceswaps_8cpp_source.html#l00223">VarianceSwapTest::testMCVarianceSwap()</a>, <a class="el" href="jumpdiffusion_8cpp_source.html#l00096">JumpDiffusionTest::testMerton76()</a>, <a class="el" href="linearleastsquaresregression_8cpp_source.html#l00110">LinearLeastSquaresRegressionTest::testMultiDimRegression()</a>, <a class="el" href="interpolations_8cpp_source.html#l00789">InterpolationTest::testMultiSpline()</a>, <a class="el" href="test-suite_2basketoption_8cpp_source.html#l00862">BasketOptionTest::testOddSamples()</a>, <a class="el" href="test-suite_2basketoption_8cpp_source.html#l00737">BasketOptionTest::testOneDAmericanValues()</a>, <a class="el" href="test-suite_2cliquetoption_8cpp_source.html#l00106">anonymous_namespace{cliquetoption.cpp}::testOptionGreeks()</a>, <a class="el" href="forwardoption_8cpp_source.html#l00140">ForwardOptionTest::testPerformanceValues()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l01317">EuropeanOptionTest::testPriceCurve()</a>, <a class="el" href="test-suite_2compoundoption_8cpp_source.html#l00085">CompoundOptionTest::testPutCallParity()</a>, <a class="el" href="test-suite_2blackdeltacalculator_8cpp_source.html#l00305">BlackDeltaCalculatorTest::testPutCallParity()</a>, <a class="el" href="linearleastsquaresregression_8cpp_source.html#l00032">LinearLeastSquaresRegressionTest::testRegression()</a>, <a class="el" href="varianceswaps_8cpp_source.html#l00096">VarianceSwapTest::testReplicatingVarianceSwap()</a>, <a class="el" href="test-suite_2compoundoption_8cpp_source.html#l00204">CompoundOptionTest::testValues()</a>, <a class="el" href="forwardoption_8cpp_source.html#l00073">ForwardOptionTest::testValues()</a>, <a class="el" href="test-suite_2europeanoption_8cpp_source.html#l00229">EuropeanOptionTest::testValues()</a>, <a class="el" href="quantooption_8cpp_source.html#l00166">QuantoOptionTest::testValues()</a>, <a class="el" href="vpp_8cpp_source.html#l00549">VPPTest::testVPPPricing()</a>, <a class="el" href="trinomialtree_8cpp_source.html#l00026">QuantLib::TrinomialTree::TrinomialTree()</a>, <a class="el" href="ql_2timeseries_8hpp_source.html#l00298">QuantLib::TimeSeries&lt; T, Container &gt;::values()</a>, <a class="el" href="incrementalstatistics_8cpp_source.html#l00044">QuantLib::IncrementalStatistics::variance()</a>, <a class="el" href="smilesection_8hpp_source.html#l00086">QuantLib::SmileSection::varianceImpl()</a>, <a class="el" href="interpolatedsmilesection_8hpp_source.html#l00193">QuantLib::InterpolatedSmileSection&lt; Interpolator &gt;::varianceImpl()</a>, and <a class="el" href="sabrinterpolatedsmilesection_8cpp_source.html#l00122">QuantLib::SabrInterpolatedSmileSection::varianceImpl()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> result;
        <span class="keywordtype">double</span> aa,caux;

        aa=-(p*(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>)+<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>*tt)/<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(2.0*p*tt*(tt-p),0.5);
        caux=<a class="code" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a95a2d20c2dbb17ceb66217aae9befa91">PHID</a>(aa);

        aa=exp(<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>-<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>),2)/(4.0*tt))*exp(<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>((1.0-gm),2)*tt/4.0)*<a class="code" href="perturbativebarrieroptionengine_8cpp.html#ad3fdc89d294523ce27c49c1c4b34f558">POW</a>(tt,0.5);
        result=caux/aa;

        <span class="keywordflow">return</span>(result);
    }
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="abd7073d8df2267b123de5f5d8b049172"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::AR" ref="abd7073d8df2267b123de5f5d8b049172" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#abd7073d8df2267b123de5f5d8b049172">AR</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>.</p>

</div>
</div>
<a class="anchor" id="af4a99f687d81ba38ce7204c8defbf3e8"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::H1" ref="af4a99f687d81ba38ce7204c8defbf3e8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af4a99f687d81ba38ce7204c8defbf3e8">H1</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6464138479012cf12084a0d6c2bf785d"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::H2" ref="a6464138479012cf12084a0d6c2bf785d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6464138479012cf12084a0d6c2bf785d">H2</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>.</p>

</div>
</div>
<a class="anchor" id="aad31cbfa93a6ffef32d2bfbf36afebb8"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::H3" ref="aad31cbfa93a6ffef32d2bfbf36afebb8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#aad31cbfa93a6ffef32d2bfbf36afebb8">H3</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

<p>Referenced by <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00830">tvtl()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d43c7e73206b8c19b189803b6a50449"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::NUC" ref="a6d43c7e73206b8c19b189803b6a50449" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a6d43c7e73206b8c19b189803b6a50449">NUC</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00042">42</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae37fba9c30b2ce83c2d5f8b4af48fecf"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::R23" ref="ae37fba9c30b2ce83c2d5f8b4af48fecf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#ae37fba9c30b2ce83c2d5f8b4af48fecf">R23</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af3a3d772b5497d7e840ed04b020b3753"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::RUA" ref="af3a3d772b5497d7e840ed04b020b3753" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#af3a3d772b5497d7e840ed04b020b3753">RUA</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2aacb83ce8c784cd75802afaf0112bb0"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::RUB" ref="a2aacb83ce8c784cd75802afaf0112bb0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#a2aacb83ce8c784cd75802afaf0112bb0">RUB</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acd04715fa1d11a3e04068ed1541d4cfd"></a><!-- doxytag: member="anonymous_namespace{perturbativebarrieroptionengine.cpp}::RUC" ref="acd04715fa1d11a3e04068ed1541d4cfd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double anonymous_namespace{perturbativebarrieroptionengine.cpp}::<a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html#acd04715fa1d11a3e04068ed1541d4cfd">RUC</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html#l00041">41</a> of file <a class="el" href="perturbativebarrieroptionengine_8cpp_source.html">perturbativebarrieroptionengine.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceanonymous__namespace_02perturbativebarrieroptionengine_8cpp_03.html">anonymous_namespace{perturbativebarrieroptionengine.cpp}</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:02 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
