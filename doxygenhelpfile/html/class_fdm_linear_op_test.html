<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: FdmLinearOpTest Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_fdm_linear_op_test.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">FdmLinearOpTest Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="FdmLinearOpTest" -->
<p><code>#include &lt;<a class="el" href="test-suite_2fdmlinearop_8hpp_source.html">fdmlinearop.hpp</a>&gt;</code></p>

<p><a href="class_fdm_linear_op_test-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#ae1ecf79115617e8169d277e73a36612f">testFdmLinearOpLayout</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#afa9986f63a3ae5bb22a0012d121551fe">testUniformGridMesher</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a6e1f9142ad89524e69b6eebcd50e96fc">testFirstDerivativesMapApply</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a8d67781b0c9e6c26c7b25582d3bc2cc9">testSecondDerivativesMapApply</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a4807dfeb6f2b5043159e5830c120d3c0">testSecondOrderMixedDerivativesMapApply</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a6d04c01599ab61022d5ed591ad4caee9">testTripleBandMapSolve</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a3513da1ab5b87d5ea7b2f777895c6fdf">testFdmHestonBarrier</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a66cc07aaa71b10551701bf89dd2a3d0c">testFdmHestonAmerican</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a0488e03e3d93caf1867e20454e7e976c">testFdmHestonExpress</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a6caeace3b4cd1de89a6add23df1bfd8c">testFdmHestonHullWhiteOp</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#ab510a68c9011d22138cb0a0e62a1e51f">testBiCGstab</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a4340f7d1fe027b49ef548fd4e58e395d">testCrankNicolsonWithDamping</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <br class="typebreak"/>
boost::unit_test_framework::test_suite *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fdm_linear_op_test.html#a2e2c961fae21f5a003001f8a94f3c522">suite</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="test-suite_2fdmlinearop_8hpp_source.html#l00030">30</a> of file <a class="el" href="test-suite_2fdmlinearop_8hpp_source.html">fdmlinearop.hpp</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2e2c961fae21f5a003001f8a94f3c522"></a><!-- doxytag: member="FdmLinearOpTest::suite" ref="a2e2c961fae21f5a003001f8a94f3c522" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_suite * <a class="el" href="class_fdm_linear_op_test.html#a2e2c961fae21f5a003001f8a94f3c522">FdmLinearOpTest::suite</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l01233">1233</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2utilities_8hpp_source.html#l00061">QUANTLIB_TEST_CASE</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l01080">testBiCGstab()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l01139">testCrankNicolsonWithDamping()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00679">testFdmHestonAmerican()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00585">testFdmHestonBarrier()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00758">testFdmHestonExpress()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00941">testFdmHestonHullWhiteOp()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00138">testFdmLinearOpLayout()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00245">testFirstDerivativesMapApply()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00309">testSecondDerivativesMapApply()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00398">testSecondOrderMixedDerivativesMapApply()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00500">testTripleBandMapSolve()</a>, and <a class="el" href="fdmlinearop_8cpp_source.html#l00213">testUniformGridMesher()</a>.</p>

<p>Referenced by <a class="el" href="quantlibtestsuite_8cpp_source.html#l00206">init_unit_test_suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                   {
    test_suite* <a class="code" href="class_fdm_linear_op_test.html#a2e2c961fae21f5a003001f8a94f3c522">suite</a> = BOOST_TEST_SUITE(<span class="stringliteral">&quot;linear operator tests&quot;</span>);

    suite-&gt;add(
        <a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#ae1ecf79115617e8169d277e73a36612f">FdmLinearOpTest::testFdmLinearOpLayout</a>));
    suite-&gt;add(
        <a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#afa9986f63a3ae5bb22a0012d121551fe">FdmLinearOpTest::testUniformGridMesher</a>));
    suite-&gt;add(
        <a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a6e1f9142ad89524e69b6eebcd50e96fc">FdmLinearOpTest::testFirstDerivativesMapApply</a>));
    suite-&gt;add(
        <a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a8d67781b0c9e6c26c7b25582d3bc2cc9">FdmLinearOpTest::testSecondDerivativesMapApply</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(
            &amp;<a class="code" href="class_fdm_linear_op_test.html#a4807dfeb6f2b5043159e5830c120d3c0">FdmLinearOpTest::testSecondOrderMixedDerivativesMapApply</a>));
    suite-&gt;add(
        <a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a6d04c01599ab61022d5ed591ad4caee9">FdmLinearOpTest::testTripleBandMapSolve</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a3513da1ab5b87d5ea7b2f777895c6fdf">FdmLinearOpTest::testFdmHestonBarrier</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a66cc07aaa71b10551701bf89dd2a3d0c">FdmLinearOpTest::testFdmHestonAmerican</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a0488e03e3d93caf1867e20454e7e976c">FdmLinearOpTest::testFdmHestonExpress</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a6caeace3b4cd1de89a6add23df1bfd8c">FdmLinearOpTest::testFdmHestonHullWhiteOp</a>));
    suite-&gt;add(<a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#ab510a68c9011d22138cb0a0e62a1e51f">FdmLinearOpTest::testBiCGstab</a>));
    suite-&gt;add(
        <a class="code" href="test-suite_2utilities_8hpp.html#a80550c9c9a7264738072a40a2fc8fd8d">QUANTLIB_TEST_CASE</a>(&amp;<a class="code" href="class_fdm_linear_op_test.html#a4340f7d1fe027b49ef548fd4e58e395d">FdmLinearOpTest::testCrankNicolsonWithDamping</a>));

    <span class="keywordflow">return</span> <a class="code" href="class_fdm_linear_op_test.html#a2e2c961fae21f5a003001f8a94f3c522">suite</a>;
    
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab510a68c9011d22138cb0a0e62a1e51f"></a><!-- doxytag: member="FdmLinearOpTest::testBiCGstab" ref="ab510a68c9011d22138cb0a0e62a1e51f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#ab510a68c9011d22138cb0a0e62a1e51f">FdmLinearOpTest::testBiCGstab</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l01080">1080</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="sparseilupreconditioner_8cpp_source.html#l00161">QuantLib::SparseILUPreconditioner::apply()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l01065">anonymous_namespace{fdmlinearop.cpp}::axpy()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::b</a>, <a class="el" href="ql_2math_2array_8hpp_source.html#l00469">QuantLib::DotProduct()</a>, <a class="el" href="mt19937uniformrng_8hpp_source.html#l00054">QuantLib::MersenneTwisterUniformRng::next()</a>, <a class="el" href="bicgstab_8cpp_source.html#l00037">QuantLib::BiCGstab::solve()</a>, <a class="el" href="sample_8hpp_source.html#l00039">QuantLib::Sample&lt; T &gt;::value</a>, and <a class="el" href="bicgstab_8hpp_source.html#l00036">QuantLib::BiCGStabResult::x</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                   {
<span class="preprocessor">#if !defined(QL_NO_UBLAS_SUPPORT)</span>
<span class="preprocessor"></span>    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing BiCGstab with Heston operator...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;
    
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n=41, m=21;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta = 1.0;
    boost::numeric::ublas::compressed_matrix&lt;Real&gt; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>(n*m, n*m);
    
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; n; ++i) {
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; m; ++j) {
            <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k = i*m+j;
            <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>(k,k)=1.0;

            <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; j &gt; 0 &amp;&amp; i &lt;n-1 &amp;&amp; j &lt; m-1) {
                <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> im1 = i-1;
                <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> ip1 = i+1;
                <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> jm1 = j-1;
                <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> jp1 = j+1;
                <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> delta = theta/((ip1-im1)*(jp1-jm1));

                <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>(k,im1*m+jm1) =  delta;
                <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>(k,im1*m+jp1) = -delta;
                <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>(k,ip1*m+jm1) = -delta;
                <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>(k,ip1*m+jp1) =  delta;
            }
        }
    }
    
    boost::function&lt;Disposable&lt;Array&gt;(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp;)&gt; matmult(
                                                    boost::bind(&amp;<a class="code" href="namespaceanonymous__namespace_02fdmlinearop_8cpp_03.html#a9882e319376a57f06cfd81cc48e3b2c4">axpy</a>, <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>, _1));
    
    <a class="code" href="class_quant_lib_1_1_sparse_i_l_u_preconditioner.html">SparseILUPreconditioner</a> ilu(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>, 4);
    boost::function&lt;Disposable&lt;Array&gt;(<span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>&amp;)&gt; precond(
         boost::bind(&amp;SparseILUPreconditioner::apply, &amp;ilu, _1));
    
    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>(n*m);
    <a class="code" href="class_quant_lib_1_1_mersenne_twister_uniform_rng.html" title="Uniform random number generator.">MersenneTwisterUniformRng</a> rng(1234);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>.size(); ++i) {
        <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>[i] = rng.next().value;
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol = 1e-10;

    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_bi_c_gstab.html">BiCGstab</a> biCGstab(matmult, n*m, tol, precond);
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> x = biCGstab.solve(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>).x;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> error = std::sqrt(<a class="code" href="namespace_quant_lib.html#aa4a9ece3a7c58b84a51c185798672654">DotProduct</a>(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-<a class="code" href="namespaceanonymous__namespace_02fdmlinearop_8cpp_03.html#a9882e319376a57f06cfd81cc48e3b2c4">axpy</a>(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>, x), 
                                 <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>-<a class="code" href="namespaceanonymous__namespace_02fdmlinearop_8cpp_03.html#a9882e319376a57f06cfd81cc48e3b2c4">axpy</a>(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>, x))/<a class="code" href="namespace_quant_lib.html#aa4a9ece3a7c58b84a51c185798672654">DotProduct</a>(<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>,<a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a363b018ed55f2c9dd81e7c8d53aab592">b</a>));

    <span class="keywordflow">if</span> (error &gt; tol) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error calculating the inverse using BiCGstab&quot;</span> &lt;&lt;
                <span class="stringliteral">&quot;\n tolerance:  &quot;</span> &lt;&lt; tol &lt;&lt;
                <span class="stringliteral">&quot;\n error:      &quot;</span> &lt;&lt; error);
    }  
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a4340f7d1fe027b49ef548fd4e58e395d"></a><!-- doxytag: member="FdmLinearOpTest::testCrankNicolsonWithDamping" ref="a4340f7d1fe027b49ef548fd4e58e395d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a4340f7d1fe027b49ef548fd4e58e395d">FdmLinearOpTest::testCrankNicolsonWithDamping</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l01139">1139</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="fdmbackwardsolver_8cpp_source.html#l00040">QuantLib::FdmSchemeDesc::Douglas()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00086">QuantLib::flatVol()</a>, <a class="el" href="oneassetoption_8cpp_source.html#l00056">QuantLib::OneAssetOption::gamma()</a>, <a class="el" href="instrument_8hpp_source.html#l00186">QuantLib::Instrument::NPV()</a>, <a class="el" href="option_8hpp_source.html#l00038">QuantLib::Option::Put</a>, <a class="el" href="fdmbackwardsolver_8cpp_source.html#l00085">QuantLib::FdmBackwardSolver::rollback()</a>, <a class="el" href="instrument_8hpp_source.html#l00133">QuantLib::Instrument::setPricingEngine()</a>, and <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00124">anonymous_namespace{marketmodel.cpp}::todaysDate</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                   {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing Crank-Nicolson with initial implicit damping steps &quot;</span>
                  <span class="stringliteral">&quot;for a digital option...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> dc = <a class="code" href="class_quant_lib_1_1_actual360.html" title="Actual/360 day count convention.">Actual360</a>();
    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> today = <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae1b42c838cf0f4cf17262f0b22bac899">Date::todaysDate</a>();

    boost::shared_ptr&lt;SimpleQuote&gt; spot(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_simple_quote.html" title="market element returning a stored value">SimpleQuote</a>(100.0));
    boost::shared_ptr&lt;YieldTermStructure&gt; qTS = <a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(today, 0.06, dc);
    boost::shared_ptr&lt;YieldTermStructure&gt; rTS = <a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(today, 0.06, dc);
    boost::shared_ptr&lt;BlackVolTermStructure&gt; volTS = <a class="code" href="namespace_quant_lib.html#a589d5c4b0b60b0bdd42ae07d820b2ed3">flatVol</a>(today, 0.35, dc);

    boost::shared_ptr&lt;StrikedTypePayoff&gt; payoff(
                             <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_cash_or_nothing_payoff.html" title="Binary cash-or-nothing payoff.">CashOrNothingPayoff</a>(Option::Put, 100, 10.0));

    <a class="code" href="class_time.html">Time</a> maturity = 0.75;
    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> exDate = today + <a class="code" href="namespace_quant_lib.html#a8ac1a45a37d8d3dda438a2e59e222620" title="integer number">Integer</a>(maturity*360+0.5);
    boost::shared_ptr&lt;Exercise&gt; exercise(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_european_exercise.html" title="European exercise.">EuropeanExercise</a>(exDate));

    boost::shared_ptr&lt;BlackScholesMertonProcess&gt; process(<span class="keyword">new</span>
        <a class="code" href="class_quant_lib_1_1_black_scholes_merton_process.html" title="Merton (1973) extension to the Black-Scholes stochastic process.">BlackScholesMertonProcess</a>(<a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;Quote&gt;</a>(spot),
                                  <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a>(qTS),
                                  <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a>(rTS),
                                  <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;BlackVolTermStructure&gt;</a>(volTS)));
    boost::shared_ptr&lt;PricingEngine&gt; <a class="code" href="class_quant_lib_1_1engine.html">engine</a>(
                                <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_analytic_european_engine.html" title="Pricing engine for European vanilla options using analytical formulae.">AnalyticEuropeanEngine</a>(process));

    <a class="code" href="class_quant_lib_1_1_vanilla_option.html" title="Vanilla option (no discrete dividends, no barriers) on a single asset.">VanillaOption</a> opt(payoff, exercise);
    opt.setPricingEngine(<a class="code" href="class_quant_lib_1_1engine.html">engine</a>);
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedPV = opt.NPV();
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expectedGamma = opt.gamma();

    <span class="comment">// fd pricing using implicit damping steps and Crank Nicolson</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> csSteps = 25, dampingSteps = 3, xGrid = 400;
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(1, xGrid);

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; layout(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));
    <span class="keyword">const</span> boost::shared_ptr&lt;Fdm1dMesher&gt; equityMesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_black_scholes_mesher.html">FdmBlackScholesMesher</a>(
                dim[0], process, maturity, payoff-&gt;strike(),
                <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(), <a class="code" href="class_quant_lib_1_1_null.html">Null&lt;Real&gt;</a>(), 0.0001, 1.5,
                std::pair&lt;Real, Real&gt;(payoff-&gt;strike(), 0.01)));

    boost::shared_ptr&lt;FdmMesher&gt; mesher (
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_mesher_composite.html">FdmMesherComposite</a>(layout,
              std::vector&lt;boost::shared_ptr&lt;Fdm1dMesher&gt; &gt;(1, equityMesher)));

    boost::shared_ptr&lt;FdmBlackScholesOp&gt; map(
                     <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_black_scholes_op.html">FdmBlackScholesOp</a>(mesher, process, payoff-&gt;strike()));

    boost::shared_ptr&lt;FdmInnerValueCalculator&gt; calculator(
                                  <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_log_inner_value.html">FdmLogInnerValue</a>(payoff, mesher, 0));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> rhs(layout-&gt;size()), x(layout-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = layout-&gt;end();

    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = layout-&gt;begin(); iter != endIter;
         ++iter) {
        rhs[iter.index()] = calculator-&gt;avgInnerValue(iter, maturity);
        x[iter.index()] = mesher-&gt;location(iter, 0);
    }

    <a class="code" href="class_quant_lib_1_1_fdm_backward_solver.html">FdmBackwardSolver</a> solver(map, <a class="code" href="namespace_quant_lib.html#af064f77bc69893c110a3797657b02c42">FdmBoundaryConditionSet</a>(), 
                             boost::shared_ptr&lt;FdmStepConditionComposite&gt;(),
                             FdmSchemeDesc::Douglas());
    solver.rollback(rhs, maturity, 0.0, csSteps, dampingSteps);

    <a class="code" href="class_quant_lib_1_1_monotonic_cubic_natural_spline.html">MonotonicCubicNaturalSpline</a> spline(x.begin(), x.end(), rhs.begin());

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> s = spot-&gt;value();
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculatedPV = spline(std::log(s));
    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculatedGamma = (spline.secondDerivative(std::log(s))
                            - spline.derivative(std::log(s))    )/(s*s);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> relTol = 2e-3;

    <span class="keywordflow">if</span> (std::fabs(calculatedPV - expectedPV) &gt; relTol*expectedPV) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error calculating the PV of the digital option&quot;</span> &lt;&lt;
                <span class="stringliteral">&quot;\n rel. tolerance:  &quot;</span> &lt;&lt; relTol &lt;&lt;
                <span class="stringliteral">&quot;\n expected:        &quot;</span> &lt;&lt; expectedPV &lt;&lt;
                <span class="stringliteral">&quot;\n calculated:      &quot;</span> &lt;&lt; calculatedPV);
    }
    <span class="keywordflow">if</span> (std::fabs(calculatedGamma - expectedGamma) &gt; relTol*expectedGamma) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error calculating the Gamma of the digital option&quot;</span> &lt;&lt;
                <span class="stringliteral">&quot;\n rel. tolerance:  &quot;</span> &lt;&lt; relTol &lt;&lt;
                <span class="stringliteral">&quot;\n expected:        &quot;</span> &lt;&lt; expectedGamma &lt;&lt;
                <span class="stringliteral">&quot;\n calculated:      &quot;</span> &lt;&lt; calculatedGamma);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a66cc07aaa71b10551701bf89dd2a3d0c"></a><!-- doxytag: member="FdmLinearOpTest::testFdmHestonAmerican" ref="a66cc07aaa71b10551701bf89dd2a3d0c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a66cc07aaa71b10551701bf89dd2a3d0c">FdmLinearOpTest::testFdmHestonAmerican</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00679">679</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="date_8hpp_source.html#l00047">QuantLib::March</a>, <a class="el" href="option_8hpp_source.html#l00038">QuantLib::Option::Put</a>, and <a class="el" href="finitedifferencemodel_8hpp_source.html#l00070">QuantLib::FiniteDifferenceModel&lt; Evolver &gt;::rollback()</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                            {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing FDM with American option in Heston model...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {200, 100};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; index(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 3.8, std::log(220.0)));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0.000, 1.0));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(index, boundaries));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;Quote&gt;</a> s0(boost::shared_ptr&lt;Quote&gt;(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_simple_quote.html" title="market element returning a stored value">SimpleQuote</a>(100.0)));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a> rTS(<a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(0.05, <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>()));
    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a> qTS(<a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(0.0 , <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>()));

    boost::shared_ptr&lt;HestonProcess&gt; hestonProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_heston_process.html" title="Square-root stochastic-volatility Heston process.">HestonProcess</a>(rTS, qTS, s0, 0.04, 2.5, 0.04, 0.66, -0.8));

    Settings::instance().evaluationDate() = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2004);
    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> exerciseDate(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2005);

    boost::shared_ptr&lt;FdmLinearOpComposite&gt; LinearOp(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_heston_op.html">FdmHestonOp</a>(mesher, hestonProcess));

    boost::shared_ptr&lt;Payoff&gt; payoff(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_plain_vanilla_payoff.html" title="Plain-vanilla payoff.">PlainVanillaPayoff</a>(Option::Put, 100.0));
    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> rhs(mesher-&gt;layout()-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = mesher-&gt;layout()-&gt;end();
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = mesher-&gt;layout()-&gt;begin();
        iter != endIter; ++iter) {
            rhs[iter.index()]
                = payoff-&gt;operator ()(std::exp(mesher-&gt;location(iter, 0)));
    }

    <a class="code" href="class_quant_lib_1_1_fdm_american_step_condition.html">FdmAmericanStepCondition</a> condition(mesher,
        boost::shared_ptr&lt;FdmInnerValueCalculator&gt;(
                                     <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_log_inner_value.html">FdmLogInnerValue</a>(payoff, mesher, 0)));
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta=0.5+std::sqrt(3.0)/6.;
    <a class="code" href="class_quant_lib_1_1_hundsdorfer_scheme.html">HundsdorferScheme</a> hsEvolver(theta, 0.5, LinearOp);
    <a class="code" href="class_quant_lib_1_1_finite_difference_model.html" title="Generic finite difference model.">FiniteDifferenceModel&lt;HundsdorferScheme&gt;</a> hsModel(hsEvolver);
    hsModel.rollback(rhs, 1.0, 0.0, 50, condition);

    <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> ret(dims[0], dims[1]);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; dims[0]; ++i)
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; dims[1]; ++j)
            ret[i][j] = rhs[i+j*dims[0]];

    std::vector&lt;Real&gt; tx, ty;
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = mesher-&gt;layout()-&gt;begin();
        iter != endIter; ++iter) {
            <span class="keywordflow">if</span> (iter.coordinates()[1] == 0) {
                tx.push_back(mesher-&gt;location(iter, 0));
            }
            <span class="keywordflow">if</span> (iter.coordinates()[0] == 0) {
                ty.push_back(mesher-&gt;location(iter, 1));
            }
    }

    <a class="code" href="class_quant_lib_1_1_bilinear_interpolation.html" title="bilinear interpolation between discrete points">BilinearInterpolation</a> interpolate(ty.begin(), ty.end(),
                                      tx.begin(), tx.end(), ret);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = 100;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> v0 = 0.04;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> npv = interpolate(v0, std::log(x));
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> npvExpected = 5.641648;

    <span class="keywordflow">if</span> (std::fabs(npv - npvExpected) &gt; 0.000001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating PV for Heston American Option&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3513da1ab5b87d5ea7b2f777895c6fdf"></a><!-- doxytag: member="FdmLinearOpTest::testFdmHestonBarrier" ref="a3513da1ab5b87d5ea7b2f777895c6fdf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a3513da1ab5b87d5ea7b2f777895c6fdf">FdmLinearOpTest::testFdmHestonBarrier</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00585">585</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="date_8hpp_source.html#l00047">QuantLib::March</a>, <a class="el" href="finitedifferencemodel_8hpp_source.html#l00070">QuantLib::FiniteDifferenceModel&lt; Evolver &gt;::rollback()</a>, and <a class="el" href="boundarycondition_8hpp_source.html#l00041">QuantLib::BoundaryCondition&lt; FdmLinearOp &gt;::Upper</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                           {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing FDM with Barrier option in Heston model...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {200, 100};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; index(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 3.8, 4.905274778));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0.000, 1.0));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(index, boundaries));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;Quote&gt;</a> s0(boost::shared_ptr&lt;Quote&gt;(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_simple_quote.html" title="market element returning a stored value">SimpleQuote</a>(100.0)));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a> rTS(<a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(0.05, <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>()));
    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a> qTS(<a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(0.0 , <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>()));

    boost::shared_ptr&lt;HestonProcess&gt; hestonProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_heston_process.html" title="Square-root stochastic-volatility Heston process.">HestonProcess</a>(rTS, qTS, s0, 0.04, 2.5, 0.04, 0.66, -0.8));

    Settings::instance().evaluationDate() = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2004);
    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> exerciseDate(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2005);

    boost::shared_ptr&lt;FdmLinearOpComposite&gt; hestonOp(
                                   <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_heston_op.html">FdmHestonOp</a>(mesher, hestonProcess));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> rhs(mesher-&gt;layout()-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = mesher-&gt;layout()-&gt;end();
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = mesher-&gt;layout()-&gt;begin();
         iter != endIter; ++iter) {
        rhs[iter.index()]=std::max(std::exp(mesher-&gt;location(iter,0))-100, 0.0);
    }

    <a class="code" href="namespace_quant_lib.html#af064f77bc69893c110a3797657b02c42">FdmBoundaryConditionSet</a> bcSet;
    bcSet.push_back(boost::shared_ptr&lt;FdmDirichletBoundary&gt;(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_dirichlet_boundary.html">FdmDirichletBoundary</a>(mesher, 0.0, 0,
                                 FdmDirichletBoundary::Upper)));

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta=0.5+std::sqrt(3.0)/6.;
    <a class="code" href="class_quant_lib_1_1_hundsdorfer_scheme.html">HundsdorferScheme</a> hsEvolver(theta, 0.5, hestonOp, bcSet);
    <a class="code" href="class_quant_lib_1_1_finite_difference_model.html" title="Generic finite difference model.">FiniteDifferenceModel&lt;HundsdorferScheme&gt;</a> hsModel(hsEvolver);
    hsModel.rollback(rhs, 1.0, 0.0, 50);

    <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> ret(dims[0], dims[1]);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; dims[0]; ++i)
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; dims[1]; ++j)
            ret[i][j] = rhs[i+j*dims[0]];

    std::vector&lt;Real&gt; tx, ty;
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = mesher-&gt;layout()-&gt;begin();
        iter != endIter; ++iter) {
            <span class="keywordflow">if</span> (iter.coordinates()[1] == 0) {
                tx.push_back(mesher-&gt;location(iter, 0));
            }
            <span class="keywordflow">if</span> (iter.coordinates()[0] == 0) {
                ty.push_back(mesher-&gt;location(iter, 1));
            }
    }

    <a class="code" href="class_quant_lib_1_1_bilinear_interpolation.html" title="bilinear interpolation between discrete points">BilinearInterpolation</a> interpolate(ty.begin(), ty.end(),
                                      tx.begin(), tx.end(), ret);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = 100;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> v0 = 0.04;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> npv = interpolate(v0, std::log(x));
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> delta = 0.5*(
            interpolate(v0, std::log(x+1))-interpolate(v0, std::log(x-1)));
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gamma =   interpolate(v0, std::log(x+1))
                      +  interpolate(v0, std::log(x-1)) - 2*npv;

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> npvExpected   = 9.049016;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> deltaExpected = 0.511285;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> gammaExpected = -0.034296;

    <span class="keywordflow">if</span> (std::fabs(npv - npvExpected) &gt; 0.000001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating PV for Heston barrier option&quot;</span>);
    }

    <span class="keywordflow">if</span> (std::fabs(delta - deltaExpected) &gt; 0.000001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating Delta for Heston barrier option&quot;</span>);
    }

    <span class="keywordflow">if</span> (std::fabs(gamma - gammaExpected) &gt; 0.000001) {
            BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating Gamma for Heston barrier option&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0488e03e3d93caf1867e20454e7e976c"></a><!-- doxytag: member="FdmLinearOpTest::testFdmHestonExpress" ref="a0488e03e3d93caf1867e20454e7e976c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a0488e03e3d93caf1867e20454e7e976c">FdmLinearOpTest::testFdmHestonExpress</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00758">758</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="fdmhestonsolver_8cpp_source.html#l00059">QuantLib::FdmHestonSolver::deltaAt()</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="test-suite_2utilities_8cpp_source.html#l00058">QuantLib::flatRate()</a>, <a class="el" href="fdmhestonsolver_8cpp_source.html#l00064">QuantLib::FdmHestonSolver::gammaAt()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="date_8hpp_source.html#l00047">QuantLib::March</a>, <a class="el" href="fdmhestonsolver_8cpp_source.html#l00070">QuantLib::FdmHestonSolver::meanVarianceDeltaAt()</a>, <a class="el" href="fdmhestonsolver_8cpp_source.html#l00077">QuantLib::FdmHestonSolver::meanVarianceGammaAt()</a>, <a class="el" href="timeunit_8hpp_source.html#l00039">QuantLib::Months</a>, and <a class="el" href="fdmhestonsolver_8cpp_source.html#l00054">QuantLib::FdmHestonSolver::valueAt()</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                           {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing FDM with express certificate in Heston model...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {200, 100};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; index(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;(3.8, std::log(220.0)));
    boundaries.push_back(std::pair&lt;Real, Real&gt;(0.000, 1.0));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
                            <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(index, boundaries));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;Quote&gt;</a> s0(boost::shared_ptr&lt;Quote&gt;(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_simple_quote.html" title="market element returning a stored value">SimpleQuote</a>(100.0)));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a> rTS(<a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(0.05, <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>()));
    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;YieldTermStructure&gt;</a> qTS(<a class="code" href="namespace_quant_lib.html#a1309465a856634dcd0caff78af7ca223">flatRate</a>(0.0 , <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>()));

    <a class="code" href="class_quant_lib_1_1_handle.html">Handle&lt;HestonProcess&gt;</a> hestonProcess(boost::shared_ptr&lt;HestonProcess&gt; (
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_heston_process.html" title="Square-root stochastic-volatility Heston process.">HestonProcess</a>(rTS, qTS, s0, 0.04, 2.5, 0.04, 0.66, -0.8)));

    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> exerciseDate(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2005);
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> evaluationDate(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2004);
    Settings::instance().evaluationDate() = evaluationDate;

    std::vector&lt;Real&gt; triggerLevels(2);
    triggerLevels[0] = triggerLevels[1] = 100.0;
    std::vector&lt;Real&gt; redemptions(2);
    redemptions[0] = redemptions[1] = 108.0;
    std::vector&lt;Time&gt; exerciseTimes(2);
    exerciseTimes[0] = 0.333; exerciseTimes[1] = 0.666;

    <a class="code" href="namespace_quant_lib.html#ae9d932b9be5d94438eaa9e93a70e15a0">DividendSchedule</a> dividendSchedule(1, boost::shared_ptr&lt;Dividend&gt;(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fixed_dividend.html" title="Predetermined cash flow.">FixedDividend</a>(2.5, evaluationDate + <a class="code" href="class_quant_lib_1_1_period.html">Period</a>(6, <a class="code" href="namespace_quant_lib.html#a6cdac5e2dae1e972076cc8e3302e4ad3a3d158b618e2bf6e66da9aca81f706dae">Months</a>))));
    boost::shared_ptr&lt;FdmDividendHandler&gt; dividendCondition(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_dividend_handler.html">FdmDividendHandler</a>(dividendSchedule, mesher,
                               rTS-&gt;referenceDate(),
                               rTS-&gt;dayCounter(), 0));

    boost::shared_ptr&lt;StepCondition&lt;Array&gt; &gt; expressCondition(
        <span class="keyword">new</span> FdmHestonExpressCondition(redemptions, triggerLevels,
                                      exerciseTimes, mesher));

    std::list&lt;std::vector&lt;Time&gt; &gt; stoppingTimes;
    stoppingTimes.push_back(exerciseTimes);
    stoppingTimes.push_back(dividendCondition-&gt;dividendTimes());

    std::list&lt;boost::shared_ptr&lt;StepCondition&lt;Array&gt; &gt; &gt; conditions;
    conditions.push_back(expressCondition);
    conditions.push_back(dividendCondition);

    boost::shared_ptr&lt;FdmStepConditionComposite&gt; condition(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_step_condition_composite.html">FdmStepConditionComposite</a>(stoppingTimes, conditions));

    boost::shared_ptr&lt;Payoff&gt; payoff(<span class="keyword">new</span> ExpressPayoff());

    boost::shared_ptr&lt;FdmInnerValueCalculator&gt; calculator(
                                    <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_log_inner_value.html">FdmLogInnerValue</a>(payoff, mesher, 0));

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af064f77bc69893c110a3797657b02c42">FdmBoundaryConditionSet</a> bcSet;
    <span class="keyword">const</span> <a class="code" href="struct_quant_lib_1_1_fdm_solver_desc.html">FdmSolverDesc</a> solverDesc = { mesher, bcSet,
                                       condition, calculator, 1.0, 50, 0 };
    <a class="code" href="class_quant_lib_1_1_fdm_heston_solver.html">FdmHestonSolver</a> solver(hestonProcess, solverDesc);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> s = s0-&gt;value();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> v0 = 0.04;

    <span class="keywordflow">if</span> (std::fabs(solver.valueAt(s, v0) - 101.027) &gt; 0.01) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating PV for Heston Express Certificate&quot;</span>);
    }

    <span class="keywordflow">if</span> (std::fabs(solver.deltaAt(s, v0) - 0.4181) &gt; 0.001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating Delta for Heston Express Certificate&quot;</span>);
    }

    <span class="keywordflow">if</span> (std::fabs(solver.gammaAt(s, v0) + 0.0400) &gt; 0.001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating Gamma for Heston Express Certificate&quot;</span>);
    }

    <span class="keywordflow">if</span> (std::fabs(solver.meanVarianceDeltaAt(s, v0) - 0.6602) &gt; 0.001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating mean variance Delta for &quot;</span>
                <span class="stringliteral">&quot;Heston Express Certificate&quot;</span>);
    }

    <span class="keywordflow">if</span> (std::fabs(solver.meanVarianceGammaAt(s, v0) + 0.0316) &gt; 0.001) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating mean variance Delta for &quot;</span>
                <span class="stringliteral">&quot;Heston Express Certificate&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6caeace3b4cd1de89a6add23df1bfd8c"></a><!-- doxytag: member="FdmLinearOpTest::testFdmHestonHullWhiteOp" ref="a6caeace3b4cd1de89a6add23df1bfd8c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a6caeace3b4cd1de89a6add23df1bfd8c">FdmLinearOpTest::testFdmHestonHullWhiteOp</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00941">941</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="fdmsolverdesc_8hpp_source.html#l00039">QuantLib::FdmSolverDesc::calculator</a>, <a class="el" href="option_8hpp_source.html#l00039">QuantLib::Option::Call</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00856">anonymous_namespace{fdmlinearop.cpp}::createHestonHullWhite()</a>, <a class="el" href="fdmlinearop_8cpp_source.html#l00893">anonymous_namespace{fdmlinearop.cpp}::createSolverDesc()</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="fdmbackwardsolver_8cpp_source.html#l00053">QuantLib::FdmSchemeDesc::Hundsdorfer()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, <a class="el" href="fdm3dimsolver_8cpp_source.html#l00100">QuantLib::Fdm3DimSolver::interpolateAt()</a>, <a class="el" href="fdmndimsolver_8hpp_source.html#l00168">QuantLib::FdmNdimSolver&lt; N &gt;::interpolateAt()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="date_8hpp_source.html#l00047">QuantLib::March</a>, <a class="el" href="fdmsolverdesc_8hpp_source.html#l00036">QuantLib::FdmSolverDesc::mesher</a>, <a class="el" href="finitedifferencemodel_8hpp_source.html#l00070">QuantLib::FiniteDifferenceModel&lt; Evolver &gt;::rollback()</a>, <a class="el" href="instrument_8hpp_source.html#l00133">QuantLib::Instrument::setPricingEngine()</a>, <a class="el" href="fdm3dimsolver_8cpp_source.html#l00111">QuantLib::Fdm3DimSolver::thetaAt()</a>, <a class="el" href="fdmndimsolver_8hpp_source.html#l00147">QuantLib::FdmNdimSolver&lt; N &gt;::thetaAt()</a>, <a class="el" href="fdmsolverdesc_8hpp_source.html#l00041">QuantLib::FdmSolverDesc::timeSteps</a>, and <a class="el" href="daycounter_8hpp_source.html#l00126">QuantLib::DayCounter::yearFraction()</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                               {
    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing FDM with Heston Hull-White model...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> today = <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2004);
    Settings::instance().evaluationDate() = today;

    <a class="code" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> exerciseDate(28, <a class="code" href="namespace_quant_lib.html#afc504c75e7ee54a75e255256d99781e4a982c9e93cf4b41f4b71b5c256df6191c">March</a>, 2012);
    <span class="keyword">const</span> <a class="code" href="class_time.html">Time</a> maturity = <a class="code" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>().<a class="code" href="class_quant_lib_1_1_day_counter.html#aba442c829252ee786e1b4ea3d0f04bd9" title="Returns the period between two dates as a fraction of year.">yearFraction</a>(today, exerciseDate);

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {51, 31, 31};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;HybridHestonHullWhiteProcess&gt; jointProcess
                                            = <a class="code" href="namespaceanonymous__namespace_02fdmlinearop_8cpp_03.html#ab37401490db314953cab6a0b5234573f">createHestonHullWhite</a>(maturity);
    <a class="code" href="struct_quant_lib_1_1_fdm_solver_desc.html">FdmSolverDesc</a> desc = <a class="code" href="namespaceanonymous__namespace_02fdmlinearop_8cpp_03.html#acffc0248540db101ffff8c7fead71d9a">createSolverDesc</a>(dim, jointProcess);
    boost::shared_ptr&lt;FdmMesher&gt; mesher = desc.<a class="code" href="struct_quant_lib_1_1_fdm_solver_desc.html#ada34e56cb1584a0bc6761bc8d87cdbff">mesher</a>;

    boost::shared_ptr&lt;HullWhiteForwardProcess&gt; hwFwdProcess
                                            = jointProcess-&gt;hullWhiteProcess();

    boost::shared_ptr&lt;HullWhiteProcess&gt; hwProcess(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_hull_white_process.html" title="Hull-White stochastic process.">HullWhiteProcess</a>(jointProcess-&gt;hestonProcess()-&gt;riskFreeRate(),
                             hwFwdProcess-&gt;a(), hwFwdProcess-&gt;sigma()));

    boost::shared_ptr&lt;FdmLinearOpComposite&gt; linearOp(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_heston_hull_white_op.html">FdmHestonHullWhiteOp</a>(mesher,
                                 jointProcess-&gt;hestonProcess(),
                                 hwProcess,
                                 jointProcess-&gt;eta()));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> rhs(mesher-&gt;layout()-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = mesher-&gt;layout()-&gt;end();
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = mesher-&gt;layout()-&gt;begin();
        iter != endIter; ++iter) {
            rhs[iter.index()] = desc.<a class="code" href="struct_quant_lib_1_1_fdm_solver_desc.html#a6c985a850a1b2d72852118dc83e21a3e">calculator</a>-&gt;avgInnerValue(iter, maturity);
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> theta = 0.5+std::sqrt(3.0)/6.;
    <a class="code" href="class_quant_lib_1_1_hundsdorfer_scheme.html">HundsdorferScheme</a> hsEvolver(theta, 0.5, linearOp);
    <a class="code" href="class_quant_lib_1_1_finite_difference_model.html" title="Generic finite difference model.">FiniteDifferenceModel&lt;HundsdorferScheme&gt;</a> hsModel(hsEvolver);

    hsModel.rollback(rhs, maturity, 0.0, desc.<a class="code" href="struct_quant_lib_1_1_fdm_solver_desc.html#a578e25ca98d05e8bf4e99bc52b661824">timeSteps</a>);

    std::vector&lt;Real&gt; tx, ty, tr, y;
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = mesher-&gt;layout()-&gt;begin();
        iter != endIter; ++iter) {
            <span class="keywordflow">if</span> (iter.coordinates()[1] == 0 &amp;&amp; iter.coordinates()[2] == 0) {
                tx.push_back(mesher-&gt;location(iter, 0));
            }
            <span class="keywordflow">if</span> (iter.coordinates()[0] == 0 &amp;&amp; iter.coordinates()[2] == 0) {
                ty.push_back(mesher-&gt;location(iter, 1));
            }
            <span class="keywordflow">if</span> (iter.coordinates()[0] == 0 &amp;&amp; iter.coordinates()[1] == 0) {
                tr.push_back(mesher-&gt;location(iter, 2));
            }
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x0 = 100;
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> v0 = jointProcess-&gt;hestonProcess()-&gt;v0();
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> r0 = 0;
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k &lt; dim[2]; ++k) {
        <a class="code" href="class_quant_lib_1_1_matrix.html" title="Matrix used in linear algebra.">Matrix</a> ret(dim[0], dim[1]);
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; dim[0]; ++i)
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> j=0; j &lt; dim[1]; ++j)
                ret[i][j] = rhs[ i+j*dim[0]+k*dim[0]*dim[1] ];

        y.push_back(<a class="code" href="class_quant_lib_1_1_bicubic_spline.html" title="bicubic-spline interpolation between discrete points">BicubicSpline</a>(ty.begin(), ty.end(),
                                  tx.begin(), tx.end(), ret)(v0, std::log(x0)));
    }

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> directCalc
        = <a class="code" href="class_quant_lib_1_1_monotonic_cubic_natural_spline.html">MonotonicCubicNaturalSpline</a>(tr.begin(), tr.end(), y.begin())(r0);

    std::vector&lt;Real&gt; x(3);
    x[0] = std::log(x0); x[1] = v0; x[2] = r0;

    <a class="code" href="class_quant_lib_1_1_fdm3_dim_solver.html">Fdm3DimSolver</a> solver3d(desc, FdmSchemeDesc::Hundsdorfer(), linearOp);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> solverCalc = solver3d.interpolateAt(x[0], x[1], x[2]);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> solverTheta = solver3d.thetaAt(x[0], x[1], x[2]);

    <span class="keywordflow">if</span> (std::fabs(directCalc - solverCalc) &gt; 1e-4) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating PV for Heston Hull White Option&quot;</span>);
    }


    <a class="code" href="class_quant_lib_1_1_fdm_ndim_solver.html">FdmNdimSolver&lt;3&gt;</a> solverNd(desc, FdmSchemeDesc::Hundsdorfer(), linearOp);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> solverNdCalc = solverNd.interpolateAt(x);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> solverNdTheta = solverNd.thetaAt(x);

    <span class="keywordflow">if</span> (std::fabs(solverNdCalc - solverCalc) &gt; 1e-4) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating PV for Heston Hull White Option&quot;</span>);
    }
    <span class="keywordflow">if</span> (std::fabs(solverNdTheta - solverTheta) &gt; 1e-4) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating PV for Heston Hull White Option&quot;</span>);
    }

    <a class="code" href="class_quant_lib_1_1_vanilla_option.html" title="Vanilla option (no discrete dividends, no barriers) on a single asset.">VanillaOption</a> option(
            boost::shared_ptr&lt;StrikedTypePayoff&gt;(
                                <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_plain_vanilla_payoff.html" title="Plain-vanilla payoff.">PlainVanillaPayoff</a>(Option::Call, 160.0)),
            boost::shared_ptr&lt;Exercise&gt;(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_european_exercise.html" title="European exercise.">EuropeanExercise</a>(exerciseDate)));

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol = 0.025;
    option.setPricingEngine(
            <a class="code" href="class_quant_lib_1_1_make_m_c_heston_hull_white_engine.html" title="Monte Carlo Heston/Hull-White engine factory.">MakeMCHestonHullWhiteEngine&lt;PseudoRandom&gt;</a>(jointProcess)
            .withSteps(200)
            .withAntitheticVariate()
            .withControlVariate()
            .withAbsoluteTolerance(tol)
            .withSeed(42));

    <span class="comment">// the following takes far too long</span>
    <span class="comment">// const Real expected = option.NPV();</span>
    <span class="comment">// use precalculated value instead</span>
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected = 4.73;

    <span class="keywordflow">if</span> (std::fabs(directCalc - expected) &gt; 3*tol) {
        BOOST_FAIL(<span class="stringliteral">&quot;Error in calculating MC PV for Heston Hull White Option&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae1ecf79115617e8169d277e73a36612f"></a><!-- doxytag: member="FdmLinearOpTest::testFdmLinearOpLayout" ref="ae1ecf79115617e8169d277e73a36612f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#ae1ecf79115617e8169d277e73a36612f">FdmLinearOpTest::testFdmLinearOpLayout</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00138">138</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="fdmlinearoplayout_8hpp_source.html#l00045">QuantLib::FdmLinearOpLayout::begin()</a>, <a class="el" href="fdmlinearoplayout_8hpp_source.html#l00053">QuantLib::FdmLinearOpLayout::dim()</a>, <a class="el" href="fdmlinearoplayout_8hpp_source.html#l00065">QuantLib::FdmLinearOpLayout::index()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="fdmlinearoplayout_8cpp_source.html#l00026">QuantLib::FdmLinearOpLayout::neighbourhood()</a>, and <a class="el" href="fdmlinearoplayout_8hpp_source.html#l00061">QuantLib::FdmLinearOpLayout::size()</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                            {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing indexing of a linear operator...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {5,7,8};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a> layout = <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim);

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> calculatedDim = layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a4311c9785cfcfe0e44c4e5c0ac91aca0">dim</a>().size();
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> expectedDim = dim.size();
    <span class="keywordflow">if</span> (calculatedDim != expectedDim) {
        BOOST_ERROR(<span class="stringliteral">&quot;index.dimensions() should be &quot;</span> &lt;&lt; expectedDim
                    &lt;&lt; <span class="stringliteral">&quot;, but is &quot;</span> &lt;&lt; calculatedDim);
    }

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> calculatedSize = layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a8e91074fcb6c7f1e0a83a2a749736dea">size</a>();
    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> expectedSize = std::accumulate(dim.begin(), dim.end(),
                                        1, std::multiplies&lt;Size&gt;());

    <span class="keywordflow">if</span> (calculatedSize != expectedSize) {
        BOOST_FAIL(<span class="stringliteral">&quot;index.size() should be &quot;</span>
                    &lt;&lt; expectedSize &lt;&lt; <span class="stringliteral">&quot;, but is &quot;</span> &lt;&lt; calculatedSize);
    }

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k &lt; dim[0]; ++k) {
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> l=0; l &lt; dim[1]; ++l) {
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> m=0; m &lt; dim[2]; ++m) {
                std::vector&lt;Size&gt; tmp(3);
                tmp[0] = k; tmp[1] = l; tmp[2] = m;

                <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> calculatedIndex = layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a15c09e78d8bc8086a1533f2801548e9d">index</a>(tmp);
                <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> expectedIndex = k + l*dim[0] + m*dim[0]*dim[1];

                <span class="keywordflow">if</span> (expectedIndex != layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a15c09e78d8bc8086a1533f2801548e9d">index</a>(tmp)) {
                    BOOST_FAIL(<span class="stringliteral">&quot;index.size() should be &quot;</span> &lt;&lt; expectedIndex
                                &lt;&lt;<span class="stringliteral">&quot;, but is &quot;</span> &lt;&lt; calculatedIndex);
                }
            }
        }
    }

    <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a43b1949ab17d35cf0d0afcbc8c6676f9">begin</a>();

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> m=0; m &lt; dim[2]; ++m) {
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> l=0; l &lt; dim[1]; ++l) {
            <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> k=0; k &lt; dim[0]; ++k, ++iter) {
                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n=1; n &lt; 4; ++n) {
                    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nn = layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a8b72183d7e23919e1e3149bd1853f88f">neighbourhood</a>(iter, 1, n);
                    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> calculatedIndex = k + m*dim[0]*dim[1]
                       + ((l &lt; dim[1]-n)? l+n
                                        : dim[1]-1-(l+n-(dim[1]-1)))*dim[0];

                    <span class="keywordflow">if</span> (nn != calculatedIndex) {
                        BOOST_FAIL(<span class="stringliteral">&quot;next neighbourhood index is &quot;</span> &lt;&lt; nn
                                    &lt;&lt; <span class="stringliteral">&quot; but should be &quot;</span> &lt;&lt; calculatedIndex);
                    }
                }

                <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> n=1; n &lt; 7; ++n) {
                    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> nn = layout.<a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html#a8b72183d7e23919e1e3149bd1853f88f">neighbourhood</a>(iter, 2, -<a class="code" href="namespace_quant_lib.html#a8ac1a45a37d8d3dda438a2e59e222620" title="integer number">Integer</a>(n));
                    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> calculatedIndex = k + l*dim[0]
                            + ((m &lt; n) ? n-m : m-n)*dim[0]*dim[1];
                    <span class="keywordflow">if</span> (nn != calculatedIndex) {
                        BOOST_FAIL(<span class="stringliteral">&quot;next neighbourhood index is &quot;</span> &lt;&lt; nn
                            &lt;&lt; <span class="stringliteral">&quot; but should be &quot;</span> &lt;&lt; calculatedIndex);
                    }
                }
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6e1f9142ad89524e69b6eebcd50e96fc"></a><!-- doxytag: member="FdmLinearOpTest::testFirstDerivativesMapApply" ref="a6e1f9142ad89524e69b6eebcd50e96fc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a6e1f9142ad89524e69b6eebcd50e96fc">FdmLinearOpTest::testFirstDerivativesMapApply</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00245">245</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="triplebandlinearop_8cpp_source.html#l00222">QuantLib::TripleBandLinearOp::apply()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, and <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                   {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing application of first-derivatives map...&quot;</span>);

        <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {400, 100, 50};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));


    boost::shared_ptr&lt;FdmLinearOpLayout&gt; index(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;(-5, 5));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 10));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 5, 15));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
                                 <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(index, boundaries));

    <a class="code" href="class_quant_lib_1_1_first_derivative_op.html">FirstDerivativeOp</a> map(2, mesher);

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> r(mesher-&gt;layout()-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = index-&gt;end();

    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        r[iter.index()] =  std::sin(mesher-&gt;location(iter, 0))
                         + std::cos(mesher-&gt;location(iter, 2));
    }

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = map.apply(r);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> dz = (boundaries[2].second-boundaries[2].first)/(dims[2]-1);
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> z = iter.coordinates()[2];

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> z0 = (z &gt; 0) ? z-1 : 1;
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> z2 = (z &lt; dims[2]-1) ? z+1 : dims[2]-2;
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> lz0 = boundaries[2].first + z0*dz;
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> lz2 = boundaries[2].first + z2*dz;

        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expected;
        <span class="keywordflow">if</span> (z == 0) {
            expected = (std::cos(boundaries[2].first+dz)
                        - std::cos(boundaries[2].first))/dz;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (z == dim[2]-1) {
            expected = (std::cos(boundaries[2].second)
                        - std::cos(boundaries[2].second-dz))/dz;
        }
        <span class="keywordflow">else</span> {
            expected = (std::cos(lz2)-std::cos(lz0))/(2*dz);
        }

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> calculated = t[iter.index()];
        <span class="keywordflow">if</span> (std::fabs(calculated - expected) &gt; 1e-10) {
            BOOST_FAIL(<span class="stringliteral">&quot;first derivative calculation failed.&quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;\n    calculated: &quot;</span> &lt;&lt; calculated
                        &lt;&lt; <span class="stringliteral">&quot;\n    expected:   &quot;</span> &lt;&lt; expected);
        }
    }


}
</pre></div>
</div>
</div>
<a class="anchor" id="a8d67781b0c9e6c26c7b25582d3bc2cc9"></a><!-- doxytag: member="FdmLinearOpTest::testSecondDerivativesMapApply" ref="a8d67781b0c9e6c26c7b25582d3bc2cc9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a8d67781b0c9e6c26c7b25582d3bc2cc9">FdmLinearOpTest::testSecondDerivativesMapApply</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00309">309</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="triplebandlinearop_8cpp_source.html#l00222">QuantLib::TripleBandLinearOp::apply()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::d</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, and <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                    {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing application of second-derivatives map...&quot;</span>);

        <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {50, 50, 50};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; index(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 0.5));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 0.5));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 0.5));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
                            <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(index, boundaries));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> r(mesher-&gt;layout()-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = index-&gt;end();

    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        r[iter.index()] = std::sin(x)*std::cos(y)*std::exp(z);
    }

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = <a class="code" href="class_quant_lib_1_1_second_derivative_op.html">SecondDerivativeOp</a>(0, mesher).<a class="code" href="class_quant_lib_1_1_triple_band_linear_op.html#a977c64b5b640b362dfb1a9e4f0aa7b73">apply</a>(r);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol = 5e-2;
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = iter.index();
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a06d0bee201af9d379ec8f9563ecf7f66">d</a> = -std::sin(x)*std::cos(y)*std::exp(z);
        <span class="keywordflow">if</span> (iter.coordinates()[0] == 0 || iter.coordinates()[0] == dims[0]-1) {
            d = 0;
        }

        <span class="keywordflow">if</span> (std::fabs(d - t[i]) &gt; tol) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dx^2 deviation is too big&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z);
        }
    }

    t = <a class="code" href="class_quant_lib_1_1_second_derivative_op.html">SecondDerivativeOp</a>(1, mesher).<a class="code" href="class_quant_lib_1_1_triple_band_linear_op.html#a977c64b5b640b362dfb1a9e4f0aa7b73">apply</a>(r);
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = iter.index();
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> d = -std::sin(x)*std::cos(y)*std::exp(z);
        <span class="keywordflow">if</span> (iter.coordinates()[1] == 0 || iter.coordinates()[1] == dims[1]-1) {
            d = 0;
        }

        <span class="keywordflow">if</span> (std::fabs(d - t[i]) &gt; tol) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dy^2 deviation is too big&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z);
        }
    }

    t = <a class="code" href="class_quant_lib_1_1_second_derivative_op.html">SecondDerivativeOp</a>(2, mesher).<a class="code" href="class_quant_lib_1_1_triple_band_linear_op.html#a977c64b5b640b362dfb1a9e4f0aa7b73">apply</a>(r);
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = iter.index();
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> d = std::sin(x)*std::cos(y)*std::exp(z);
        <span class="keywordflow">if</span> (iter.coordinates()[2] == 0 || iter.coordinates()[2] == dims[2]-1) {
            d = 0;
        }

        <span class="keywordflow">if</span> (std::fabs(d - t[i]) &gt; tol) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dz^2 deviation is too big&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z);
        }
    }


}
</pre></div>
</div>
</div>
<a class="anchor" id="a4807dfeb6f2b5043159e5830c120d3c0"></a><!-- doxytag: member="FdmLinearOpTest::testSecondOrderMixedDerivativesMapApply" ref="a4807dfeb6f2b5043159e5830c120d3c0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a4807dfeb6f2b5043159e5830c120d3c0">FdmLinearOpTest::testSecondOrderMixedDerivativesMapApply</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00398">398</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="ninepointlinearop_8cpp_source.html#l00131">QuantLib::NinePointLinearOp::apply()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::d</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="qldefines_8hpp_source.html#l00135">QL_EPSILON</a>, and <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                                              {

    BOOST_MESSAGE(
        <span class="stringliteral">&quot;Testing application of second-order mixed-derivatives map...&quot;</span>);

        <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {50, 50, 50};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; index(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 0.5));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 0.5));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 0.5));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(index, boundaries));

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> r(mesher-&gt;layout()-&gt;size());
    <span class="keyword">const</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> endIter = index-&gt;end();

    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        r[iter.index()] = std::sin(x)*std::cos(y)*std::exp(z);
    }

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = <a class="code" href="class_quant_lib_1_1_second_order_mixed_derivative_op.html">SecondOrderMixedDerivativeOp</a>(0, 1, mesher).<a class="code" href="class_quant_lib_1_1_nine_point_linear_op.html#a9f44ebcdb1dc4052bea69c09b87a5c69">apply</a>(r);
    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> u = <a class="code" href="class_quant_lib_1_1_second_order_mixed_derivative_op.html">SecondOrderMixedDerivativeOp</a>(1, 0, mesher).<a class="code" href="class_quant_lib_1_1_nine_point_linear_op.html#a9f44ebcdb1dc4052bea69c09b87a5c69">apply</a>(r);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol = 5e-2;
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = iter.index();
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a06d0bee201af9d379ec8f9563ecf7f66">d</a> = -std::cos(x)*std::sin(y)*std::exp(z);

        <span class="keywordflow">if</span> (std::fabs(d - t[i]) &gt; tol) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dxdy deviation is too big&quot;</span>
                        &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z);
        }

        <span class="keywordflow">if</span> (std::fabs(t[i]-u[i]) &gt; 1e5*<a class="code" href="group__limit_macros.html#ga4f2e6bcf6b19224bce1a5a6234286c17">QL_EPSILON</a>) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dxdy not equal to dydx&quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z
                    &lt;&lt; <span class="stringliteral">&quot;\n  value    &quot;</span> &lt;&lt; std::fabs(t[i]-u[i]));
        }
    }

    t = <a class="code" href="class_quant_lib_1_1_second_order_mixed_derivative_op.html">SecondOrderMixedDerivativeOp</a>(0, 2, mesher).<a class="code" href="class_quant_lib_1_1_nine_point_linear_op.html#a9f44ebcdb1dc4052bea69c09b87a5c69">apply</a>(r);
    u = <a class="code" href="class_quant_lib_1_1_second_order_mixed_derivative_op.html">SecondOrderMixedDerivativeOp</a>(2, 0, mesher).<a class="code" href="class_quant_lib_1_1_nine_point_linear_op.html#a9f44ebcdb1dc4052bea69c09b87a5c69">apply</a>(r);
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = iter.index();
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> d = std::cos(x)*std::cos(y)*std::exp(z);

        <span class="keywordflow">if</span> (std::fabs(d - t[i]) &gt; tol) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dxdy deviation is too big&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z);
        }

        <span class="keywordflow">if</span> (std::fabs(t[i]-u[i]) &gt; 1e5*QL_EPSILON) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dxdz not equal to dzdx&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z
                &lt;&lt; <span class="stringliteral">&quot;\n  value    &quot;</span> &lt;&lt; std::fabs(t[i]-u[i]));
        }
    }

    t = <a class="code" href="class_quant_lib_1_1_second_order_mixed_derivative_op.html">SecondOrderMixedDerivativeOp</a>(1, 2, mesher).<a class="code" href="class_quant_lib_1_1_nine_point_linear_op.html#a9f44ebcdb1dc4052bea69c09b87a5c69">apply</a>(r);
    u = <a class="code" href="class_quant_lib_1_1_second_order_mixed_derivative_op.html">SecondOrderMixedDerivativeOp</a>(2, 1, mesher).<a class="code" href="class_quant_lib_1_1_nine_point_linear_op.html#a9f44ebcdb1dc4052bea69c09b87a5c69">apply</a>(r);
    <span class="keywordflow">for</span> (<a class="code" href="class_quant_lib_1_1_fdm_linear_op_iterator.html">FdmLinearOpIterator</a> iter = index-&gt;begin(); iter != endIter; ++iter) {
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = iter.index();
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> x = mesher-&gt;location(iter, 0);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> y = mesher-&gt;location(iter, 1);
        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> z = mesher-&gt;location(iter, 2);

        <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> d = -std::sin(x)*std::sin(y)*std::exp(z);

        <span class="keywordflow">if</span> (std::fabs(d - t[i]) &gt; tol) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dydz deviation is too big&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z);
        }

        <span class="keywordflow">if</span> (std::fabs(t[i]-u[i]) &gt; 1e5*QL_EPSILON) {
            BOOST_FAIL(<span class="stringliteral">&quot;numerical derivative in dydz not equal to dzdy&quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n  found at &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; z
                &lt;&lt; <span class="stringliteral">&quot;\n  value    &quot;</span> &lt;&lt; std::fabs(t[i]-u[i]));
        }
    }


}
</pre></div>
</div>
</div>
<a class="anchor" id="a6d04c01599ab61022d5ed591ad4caee9"></a><!-- doxytag: member="FdmLinearOpTest::testTripleBandMapSolve" ref="a6d04c01599ab61022d5ed591ad4caee9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#a6d04c01599ab61022d5ed591ad4caee9">FdmLinearOpTest::testTripleBandMapSolve</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00500">500</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="triplebandlinearop_8cpp_source.html#l00222">QuantLib::TripleBandLinearOp::apply()</a>, <a class="el" href="triplebandlinearop_8cpp_source.html#l00110">QuantLib::TripleBandLinearOp::axpyb()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, <a class="el" href="triplebandlinearop_8cpp_source.html#l00259">QuantLib::TripleBandLinearOp::solve_splitting()</a>, and <a class="el" href="quantlibbenchmark_8cpp_source.html#l00150">anonymous_namespace{quantlibbenchmark.cpp}::t</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                             {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing triple-band map solution...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {100, 400};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; layout(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));

    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 1.0));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 0, 1.0));

    boost::shared_ptr&lt;FdmMesher&gt; mesher(
        <span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a>(layout, boundaries));

    <a class="code" href="class_quant_lib_1_1_first_derivative_op.html">FirstDerivativeOp</a> dy(1, mesher);
    dy.axpyb(<a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(1, 2.0), dy, dy, <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(1, 1.0));

    <span class="comment">// check copy constructor</span>
    <a class="code" href="class_quant_lib_1_1_first_derivative_op.html">FirstDerivativeOp</a> copyOfDy(dy);

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> u(layout-&gt;size());
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; layout-&gt;size(); ++i)
        u[i] = std::sin(0.1*i)+std::cos(0.35*i);

    <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a> <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>(dy.solve_splitting(copyOfDy.apply(u), 1.0, 0.0));
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; u.size(); ++i) {
        <span class="keywordflow">if</span> (std::fabs(u[i] - <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]) &gt; 1e-6) {
            BOOST_FAIL(<span class="stringliteral">&quot;solve and apply are not consistent &quot;</span>
                    &lt;&lt; <span class="stringliteral">&quot;\n expected      : &quot;</span> &lt;&lt; u[i]
                    &lt;&lt; <span class="stringliteral">&quot;\n calculated    : &quot;</span> &lt;&lt; <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]);
        }
    }

    <a class="code" href="class_quant_lib_1_1_first_derivative_op.html">FirstDerivativeOp</a> dx(0, mesher);
    dx.axpyb(<a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(), dx, dx, <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(1, 1.0));

    <a class="code" href="class_quant_lib_1_1_first_derivative_op.html">FirstDerivativeOp</a> copyOfDx(0, mesher);
    <span class="comment">// check assignment</span>
    copyOfDx = dx;

    <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = dx.solve_splitting(copyOfDx.apply(u), 1.0, 0.0);
    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; u.size(); ++i) {
        <span class="keywordflow">if</span> (std::fabs(u[i] - <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]) &gt; 1e-6) {
            BOOST_FAIL(<span class="stringliteral">&quot;solve and apply are not consistent &quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n expected      : &quot;</span> &lt;&lt; u[i]
                &lt;&lt; <span class="stringliteral">&quot;\n calculated    : &quot;</span> &lt;&lt; <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]);
        }
    }

    <a class="code" href="class_quant_lib_1_1_second_derivative_op.html">SecondDerivativeOp</a> dxx(0, mesher);
    dxx.axpyb(<a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(1, 0.5), dxx, dx, <a class="code" href="class_quant_lib_1_1_array.html" title="1-D array used in linear algebra.">Array</a>(1, 1.0));

    <span class="comment">// check of copy constructor</span>
    <a class="code" href="class_quant_lib_1_1_second_derivative_op.html">SecondDerivativeOp</a> copyOfDxx(dxx);

    <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = dxx.solve_splitting(copyOfDxx.apply(u), 1.0, 0.0);

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; u.size(); ++i) {
        <span class="keywordflow">if</span> (std::fabs(u[i] - <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]) &gt; 1e-6) {
            BOOST_FAIL(<span class="stringliteral">&quot;solve and apply are not consistent &quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n expected      : &quot;</span> &lt;&lt; u[i]
                &lt;&lt; <span class="stringliteral">&quot;\n calculated    : &quot;</span> &lt;&lt; <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]);
        }
    }

    <span class="comment">//check assigment operator</span>
    copyOfDxx = <a class="code" href="class_quant_lib_1_1_second_derivative_op.html">SecondDerivativeOp</a>(1, mesher);
    copyOfDxx = dxx;

    <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a> = dxx.solve_splitting(copyOfDxx.apply(u), 1.0, 0.0);

    <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i=0; i &lt; u.size(); ++i) {
        <span class="keywordflow">if</span> (std::fabs(u[i] - <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]) &gt; 1e-6) {
            BOOST_FAIL(<span class="stringliteral">&quot;solve and apply are not consistent &quot;</span>
                &lt;&lt; <span class="stringliteral">&quot;\n expected      : &quot;</span> &lt;&lt; u[i]
                &lt;&lt; <span class="stringliteral">&quot;\n calculated    : &quot;</span> &lt;&lt; <a class="code" href="namespaceanonymous__namespace_02quantlibbenchmark_8cpp_03.html#a7a969063fde0030bd36b46055e824c34">t</a>[i]);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="afa9986f63a3ae5bb22a0012d121551fe"></a><!-- doxytag: member="FdmLinearOpTest::testUniformGridMesher" ref="afa9986f63a3ae5bb22a0012d121551fe" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fdm_linear_op_test.html#afa9986f63a3ae5bb22a0012d121551fe">FdmLinearOpTest::testUniformGridMesher</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fdmlinearop_8cpp_source.html#l00213">213</a> of file <a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a>.</p>

<p>References <a class="el" href="uniformgridmesher_8hpp_source.html#l00043">QuantLib::UniformGridMesher::dminus()</a>, <a class="el" href="uniformgridmesher_8hpp_source.html#l00040">QuantLib::UniformGridMesher::dplus()</a>, <a class="el" href="test-suite_2utilities_8hpp_source.html#l00039">LENGTH</a>, and <a class="el" href="qldefines_8hpp_source.html#l00135">QL_EPSILON</a>.</p>

<p>Referenced by <a class="el" href="fdmlinearop_8cpp_source.html#l01233">suite()</a>.</p>
<div class="fragment"><pre class="fragment">                                            {

    BOOST_MESSAGE(<span class="stringliteral">&quot;Testing uniform grid mesher...&quot;</span>);

    <a class="code" href="class_quant_lib_1_1_saved_settings.html">SavedSettings</a> backup;

    <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> dims[] = {5,7,8};
    <span class="keyword">const</span> std::vector&lt;Size&gt; dim(dims, dims+<a class="code" href="test-suite_2utilities_8hpp.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(dims));

    boost::shared_ptr&lt;FdmLinearOpLayout&gt; layout(<span class="keyword">new</span> <a class="code" href="class_quant_lib_1_1_fdm_linear_op_layout.html">FdmLinearOpLayout</a>(dim));
    std::vector&lt;std::pair&lt;Real, Real&gt; &gt; boundaries;
    boundaries.push_back(std::pair&lt;Real, Real&gt;(-5, 10));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 5, 100));
    boundaries.push_back(std::pair&lt;Real, Real&gt;( 10, 20));

    <a class="code" href="class_quant_lib_1_1_uniform_grid_mesher.html">UniformGridMesher</a> mesher(layout, boundaries);

    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> dx1 = 15.0/(dim[0]-1);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> dx2 = 95.0/(dim[1]-1);
    <span class="keyword">const</span> <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> dx3 = 10.0/(dim[2]-1);

    <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> tol = 100*<a class="code" href="group__limit_macros.html#ga4f2e6bcf6b19224bce1a5a6234286c17">QL_EPSILON</a>;
    <span class="keywordflow">if</span> (   std::fabs(dx1-mesher.dminus(layout-&gt;begin(),0)) &gt; tol
        || std::fabs(dx1-mesher.dplus(layout-&gt;begin(),0)) &gt; tol
        || std::fabs(dx2-mesher.dminus(layout-&gt;begin(),1)) &gt; tol
        || std::fabs(dx2-mesher.dplus(layout-&gt;begin(),1)) &gt; tol
        || std::fabs(dx3-mesher.dminus(layout-&gt;begin(),2)) &gt; tol
        || std::fabs(dx3-mesher.dplus(layout-&gt;begin(),2)) &gt; tol ) {
        BOOST_FAIL(<span class="stringliteral">&quot;inconsistent uniform mesher object&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/test-suite/<a class="el" href="test-suite_2fdmlinearop_8hpp_source.html">fdmlinearop.hpp</a></li>
<li>/home/deriversatile/QuantLib/QuantLibQt/test-suite/<a class="el" href="fdmlinearop_8cpp_source.html">fdmlinearop.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_fdm_linear_op_test.html">FdmLinearOpTest</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:01 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
