<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>QuantLib: QuantLib::RecursiveCdoEngine&lt; CDOEngine, copulaT &gt; Class Template Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">QuantLib
   &#160;<span id="projectnumber">1.3</span>
   </div>
   <div id="projectbrief">ql1-3</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_quant_lib_1_1_recursive_cdo_engine.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">QuantLib::RecursiveCdoEngine&lt; CDOEngine, copulaT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="QuantLib::RecursiveCdoEngine" --><!-- doxytag: inherits="CDOEngine" -->
<p><code>#include &lt;<a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for QuantLib::RecursiveCdoEngine&lt; CDOEngine, copulaT &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_lib_1_1_recursive_cdo_engine__inherit__graph.png" border="0" usemap="#_quant_lib_1_1_recursive_cdo_engine_3_01_c_d_o_engine_00_01copula_t_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="_quant_lib_1_1_recursive_cdo_engine_3_01_c_d_o_engine_00_01copula_t_01_4_inherit__map" id="_quant_lib_1_1_recursive_cdo_engine_3_01_c_d_o_engine_00_01copula_t_01_4_inherit__map">
<area shape="rect" id="node5" href="class_quant_lib_1_1_recursive_cdo_engine.html" title="{QuantLib::RecursiveCdoEngine\&lt; CDOEngine, OneFactorGaussianCopula \&gt;\n|# correlQuote_\l# copula_\l&#45; nBuckets_\l&#45; integral_\l&#45; wk_\l&#45; loss_unit_\l&#45; oneFactorCorrels_\l|+ RecursiveCdoEngine()\l+ RecursiveCdoEngine()\l+ update()\l+ expectedTrancheLoss()\l# initialize()\l&#45; integratorLoss()\l&#45; expectedConditionalLoss()\l}" alt="" coords="5,501,469,795"/><area shape="rect" id="node9" href="class_quant_lib_1_1_recursive_cdo_engine.html" title="{QuantLib::RecursiveCdoEngine\&lt; CDOEngine, OneFactorStudentCopula \&gt;\n|# correlQuote_\l# copula_\l&#45; nBuckets_\l&#45; integral_\l&#45; wk_\l&#45; loss_unit_\l&#45; oneFactorCorrels_\l|+ RecursiveCdoEngine()\l+ RecursiveCdoEngine()\l+ update()\l+ expectedTrancheLoss()\l# initialize()\l&#45; integratorLoss()\l&#45; expectedConditionalLoss()\l}" alt="" coords="493,501,947,795"/><area shape="rect" id="node2" href="class_c_d_o_engine.html" title="{CDOEngine\n||}" alt="" coords="385,5,476,91"/><area shape="rect" id="node7" href="class_quant_lib_1_1_gaussian_recursive_cdo_engine.html" title="Specialization for Gaussian copula, the integration still remains." alt="" coords="60,845,415,931"/><area shape="rect" id="node11" href="class_quant_lib_1_1_student_recursive_cdo_engine.html" title="{QuantLib::StudentRecursiveCdoEngine\&lt; CDOEngine \&gt;\n||+ StudentRecursiveCdoEngine()\l}" alt="" coords="548,845,892,931"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for QuantLib::RecursiveCdoEngine&lt; CDOEngine, copulaT &gt;:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_lib_1_1_recursive_cdo_engine__coll__graph.png" border="0" usemap="#_quant_lib_1_1_recursive_cdo_engine_3_01_c_d_o_engine_00_01copula_t_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="_quant_lib_1_1_recursive_cdo_engine_3_01_c_d_o_engine_00_01copula_t_01_4_coll__map" id="_quant_lib_1_1_recursive_cdo_engine_3_01_c_d_o_engine_00_01copula_t_01_4_coll__map">
<area shape="rect" id="node2" href="class_c_d_o_engine.html" title="{CDOEngine\n||}" alt="" coords="167,1969,257,2055"/><area shape="rect" id="node8" title="STL class." alt="" coords="77,1704,192,1789"/><area shape="rect" id="node12" href="class_quant_lib_1_1_relinkable_handle.html" title="{QuantLib::RelinkableHandle\&lt; copulaT \&gt;\n||+ RelinkableHandle()\l+ RelinkableHandle()\l+ linkTo()\l}" alt="" coords="504,1952,757,2072"/><area shape="rect" id="node14" href="class_quant_lib_1_1_handle.html" title="{QuantLib::Handle\&lt; copulaT \&gt;\n|# link_\l|+ currentLink()\l+ operator&#45;\&gt;()\l+ operator*()\l+ empty()\l+ operator boost::shared_ptr\&lt; Observable \&gt;()\l+ operator==()\l+ operator!=()\l+ operator\&lt;()\l+ Handle()\l+ Handle()\l* Handle()\l* Handle()\l}" alt="" coords="216,1609,499,1885"/><area shape="rect" id="node18" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable." alt="" coords="489,703,772,979"/><area shape="rect" id="node37" href="class_quant_lib_1_1_handle.html" title="{QuantLib::Handle\&lt; Quote \&gt;\n|# link_\l|+ currentLink()\l+ operator&#45;\&gt;()\l+ operator*()\l+ empty()\l+ operator boost::shared_ptr\&lt; Observable \&gt;()\l+ operator==()\l+ operator!=()\l+ operator\&lt;()\l+ Handle()\l+ Handle()\l* Handle()\l* Handle()\l}" alt="" coords="763,1609,1045,1885"/><area shape="rect" id="node21" href="class_quant_lib_1_1_relinkable_handle.html" title="Relinkable handle to an observable." alt="" coords="523,1687,739,1807"/><area shape="rect" id="node26" href="class_quant_lib_1_1_gauss_hermite_integration.html" title="generalized Gauss&#45;Hermite integration" alt="" coords="1043,1969,1269,2055"/><area shape="rect" id="node28" href="class_quant_lib_1_1_gaussian_quadrature.html" title="Integral of a 1&#45;dimensional function using the Gauss quadratures method." alt="" coords="1069,1661,1269,1833"/><area shape="rect" id="node30" href="class_quant_lib_1_1_array.html" title="1&#45;D array used in linear algebra." alt="" coords="1129,157,1241,1525"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_quant_lib_1_1_recursive_cdo_engine-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ab1ea803d2193d49c3c93ddada7f4646e">RecursiveCdoEngine</a> (const <a class="el" href="class_quant_lib_1_1_handle.html">Handle</a>&lt; <a class="el" href="class_quant_lib_1_1_quote.html">Quote</a> &gt; &amp;correl, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> nbuckets=1, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> quadOrder=20)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Single correlation construction.  <a href="#ab1ea803d2193d49c3c93ddada7f4646e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a28473c52094a7e4726c422022b0fbc8e">RecursiveCdoEngine</a> (const <a class="el" href="class_quant_lib_1_1_handle.html">Handle</a>&lt; <a class="el" href="class_quant_lib_1_1_quote.html">Quote</a> &gt; &amp;correl, const <a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;correlMtrx, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> nbuckets=1, <a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> quadOrder=20)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Correlation name to name single factor construction.  <a href="#a28473c52094a7e4726c422022b0fbc8e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#aad2b8d6456f9f00557f81b04976e0c80">update</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ab983f000a5e6fbf74424f05659bd0672">expectedTrancheLoss</a> (const <a class="el" href="class_quant_lib_1_1_date.html">Date</a> &amp;date) const </td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a7f240ddd6efe7daf7279ac4fa898ea02">initialize</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_quant_lib_1_1_handle.html">Handle</a>&lt; <a class="el" href="class_quant_lib_1_1_quote.html">Quote</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3784a381eabfb629ed13d32f0e2e1501">correlQuote_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_quant_lib_1_1_relinkable_handle.html">RelinkableHandle</a>&lt; copulaT &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a88c4b9d0213bdaeac8345ec9f1825e57">copula_</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3368d697aa66a47d4b808edaab473c2f">integratorLoss</a> (const <a class="el" href="class_quant_lib_1_1_date.html">Date</a> &amp;date, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> mktFactor) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Weights the conditional portfolio loss by the mkt factor.  <a href="#a3368d697aa66a47d4b808edaab473c2f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ac7c7bed5e95fb59aa2e14fdbac4cfd71">expectedConditionalLoss</a> (const <a class="el" href="class_quant_lib_1_1_date.html">Date</a> &amp;date, <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> mktFactor) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Portfolio loss conditional to the market factor value.  <a href="#ac7c7bed5e95fb59aa2e14fdbac4cfd71"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a4d6c080e816705b0775ecfd97500e4e5">nBuckets_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_quant_lib_1_1_gauss_hermite_integration.html">GaussHermiteIntegration</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ad5662bbfdaf1a294bf244e7694e0b168">integral_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0">oneFactorCorrels_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">name to name factor loadings (betas). In the single factor copula:  <a href="#a9a3b01f6c5cfa304012ce738c7feb1e0"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><h3>template&lt;class CDOEngine, class copulaT&gt;<br/>
class QuantLib::RecursiveCdoEngine&lt; CDOEngine, copulaT &gt;</h3>

<p>Recursive STCDO pricing for a heterogeneous pool of names. The pool names are heterogeneous in their default probabilities, notionals and recovery rates. Correlations are pairwise. The recursive pricing algorithm used here is described in Andersen, Sidenius and Basu; "All your hedges in one basket", Risk, November 2003, pages 67-72</p>
<p>Notice that using copulas other than Gaussian it is only an approximation (see remark on p.68). </p>

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00045">45</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab1ea803d2193d49c3c93ddada7f4646e"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::RecursiveCdoEngine" ref="ab1ea803d2193d49c3c93ddada7f4646e" args="(const Handle&lt; Quote &gt; &amp;correl, Size nbuckets=1, Size quadOrder=20)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">RecursiveCdoEngine</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_handle.html">Handle</a>&lt; <a class="el" href="class_quant_lib_1_1_quote.html">Quote</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>correl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>nbuckets</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>quadOrder</em> = <code>20</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Single correlation construction. </p>

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00051">51</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>
<div class="fragment"><pre class="fragment">        : <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3784a381eabfb629ed13d32f0e2e1501">correlQuote_</a>(correl), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a88c4b9d0213bdaeac8345ec9f1825e57">copula_</a>(), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a4d6c080e816705b0775ecfd97500e4e5">nBuckets_</a>(nbuckets),
          <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#ad5662bbfdaf1a294bf244e7694e0b168">integral_</a>(quadOrder), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>()
        {
            this-&gt;registerWith(correl);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a28473c52094a7e4726c422022b0fbc8e"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::RecursiveCdoEngine" ref="a28473c52094a7e4726c422022b0fbc8e" args="(const Handle&lt; Quote &gt; &amp;correl, const Matrix &amp;correlMtrx, Size nbuckets=1, Size quadOrder=20)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">RecursiveCdoEngine</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_handle.html">Handle</a>&lt; <a class="el" href="class_quant_lib_1_1_quote.html">Quote</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>correl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>correlMtrx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>nbuckets</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a>&#160;</td>
          <td class="paramname"><em>quadOrder</em> = <code>20</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Correlation name to name single factor construction. </p>

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00061">61</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>
<div class="fragment"><pre class="fragment">        : <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3784a381eabfb629ed13d32f0e2e1501">correlQuote_</a>(correl), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a88c4b9d0213bdaeac8345ec9f1825e57">copula_</a>(), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a4d6c080e816705b0775ecfd97500e4e5">nBuckets_</a>(nbuckets),
          <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#ad5662bbfdaf1a294bf244e7694e0b168">integral_</a>(quadOrder), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>(),
          <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>(<a class="code" href="namespace_quant_lib.html#aa8e073d51f43e3f136a5fa389911c7c4">factorReduction</a>(correlMtrx))
        {
            <span class="comment">// at least</span>
            <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(!<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>.empty(),
                <span class="stringliteral">&quot;Invalid correlation parameter matrix.&quot;</span>);
        }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac7c7bed5e95fb59aa2e14fdbac4cfd71"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::expectedConditionalLoss" ref="ac7c7bed5e95fb59aa2e14fdbac4cfd71" args="(const Date &amp;date, Real mktFactor) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine , class copulaT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ac7c7bed5e95fb59aa2e14fdbac4cfd71">expectedConditionalLoss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_date.html">Date</a> &amp;&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>mktFactor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Portfolio loss conditional to the market factor value. </p>

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00203">203</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

<p>Referenced by <a class="el" href="recursivecdoengine_8hpp_source.html#l00078">QuantLib::RecursiveCdoEngine&lt; CDOEngine, OneFactorStudentCopula &gt;::integratorLoss()</a>.</p>
<div class="fragment"><pre class="fragment">                                                       {
        <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; names = this-&gt;remainingBasket_-&gt;names();

        <span class="comment">// eq. 10 p.68</span>
        <span class="comment">// attainable losses distribution, recursive algorithm</span>
        std::vector&lt;Probability&gt; uncDefProb =
            this-&gt;remainingBasket_-&gt;probabilities(date);;
        std::map&lt;Real, Probability&gt; pIndepDistrib;
        <span class="comment">// K=0</span>
        pIndepDistrib.insert(std::make_pair(0., 1.));
        <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> iName=0; iName&lt;names.size(); iName++) {
            <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> nameLoss = <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>[iName];

            <span class="comment">// to do: allow for matrix constructor and uncoment this</span>
            <span class="comment">// correlQuote_-&gt;setValue(oneFactorCorrels_[iName]);</span>

            <a class="code" href="namespace_quant_lib.html#ac41728dd3be3e1869bbb9aec06a89d60" title="probability">Probability</a> pDef =
                <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a88c4b9d0213bdaeac8345ec9f1825e57">copula_</a>-&gt;conditionalProbability(uncDefProb[iName],
                                                mktFactor);
            <span class="comment">// iterate on all possible losses in the distribution:</span>
            std::map&lt;Real, Probability&gt; pDistTemp;
            std::map&lt;Real, Probability&gt;::iterator distIt =
                pIndepDistrib.begin();
            <span class="keywordflow">while</span>(distIt != pIndepDistrib.end()) {
                <span class="comment">// update prob if this name does not default</span>
                std::map&lt;Real, Probability&gt;::iterator matchIt
                    = pDistTemp.find(distIt-&gt;first);
                <span class="keywordflow">if</span>(matchIt != pDistTemp.end()) {
                    matchIt-&gt;second += distIt-&gt;second * (1.-pDef);
                }<span class="keywordflow">else</span>{
                    pDistTemp.insert(std::make_pair(distIt-&gt;first,
                        distIt-&gt;second * (1.-pDef)));
                }
                <span class="comment">// and if it does</span>
                matchIt = pDistTemp.find(distIt-&gt;first + <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>[iName]);
                <span class="keywordflow">if</span>(matchIt != pDistTemp.end()) {
                    matchIt-&gt;second += distIt-&gt;second * pDef;
                }<span class="keywordflow">else</span>{
                    pDistTemp.insert(std::make_pair(
                        distIt-&gt;first+<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>[iName], distIt-&gt;second * pDef));
                }
                distIt++;
            }
            <span class="comment">// copy back</span>
            pIndepDistrib = pDistTemp;
        }

        <span class="comment">// get the expected value subject to the value of the market</span>
        <span class="comment">//   factor.</span>
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> expLoss = 0.;
        <span class="comment">//---------------------------------------------------------------</span>
        <span class="comment">/* This is the original (easy to read) loop which I have partially</span>
<span class="comment">             unroll below to take profit of the fact that once we go over</span>
<span class="comment">             the tranche top the loss amount is fixed:</span>
<span class="comment"></span>
<span class="comment">        std::map&lt;Real, Probability&gt;::iterator distIt =</span>
<span class="comment">            pIndepDistrib.begin();</span>
<span class="comment">        while(distIt != pIndepDistrib.end()) {</span>
<span class="comment">            Real loss = distIt-&gt;first * loss_unit_</span>
<span class="comment">                                ;</span>
<span class="comment">            loss = std::max(std::min(loss,</span>
<span class="comment">                results_.xMax)-results_.xMin, 0.);</span>
<span class="comment">            expLoss += loss * distIt-&gt;second;</span>
<span class="comment">            distIt++;</span>
<span class="comment">        }</span>
<span class="comment">        return expLoss ;</span>
<span class="comment">        */</span>
        <span class="comment">//---------------------------------------------------------------</span>
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> relativeMax = this-&gt;results_.xMax / <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a>;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> relativeMin = this-&gt;results_.xMin / <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a>;
        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> relativeMaxIdx = std::ceil(relativeMax);
        <a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> relativeMinIdx = std::floor(relativeMin);
        std::map&lt;Real, Probability&gt;::iterator
            distIt = pIndepDistrib.lower_bound(relativeMinIdx),
            itTop  = pIndepDistrib.lower_bound(relativeMax);
        <span class="keywordflow">for</span>(; distIt != itTop; distIt++)
            expLoss += std::max(std::min(distIt-&gt;first, relativeMax)
                                -relativeMin, 0.) * distIt-&gt;second;
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> sumProbs = 0.;
        <span class="keywordflow">for</span>(;distIt != pIndepDistrib.end(); distIt++)
            sumProbs += distIt-&gt;second;
        <span class="keywordflow">return</span> expLoss * <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a> + this-&gt;results_.remainingNotional * sumProbs;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ab983f000a5e6fbf74424f05659bd0672"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::expectedTrancheLoss" ref="ab983f000a5e6fbf74424f05659bd0672" args="(const Date &amp;date) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ab983f000a5e6fbf74424f05659bd0672">expectedTrancheLoss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_date.html">Date</a> &amp;&#160;</td>
          <td class="paramname"><em>date</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00103">103</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                         {
            <span class="keywordflow">return</span>
                <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#ad5662bbfdaf1a294bf244e7694e0b168">integral_</a>(boost::bind(
                    &amp;RecursiveCdoEngine&lt;CDOEngine, copulaT&gt;::integratorLoss,
                    <span class="keyword">this</span>,
                    date,
                    _1)
                );
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a7f240ddd6efe7daf7279ac4fa898ea02"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::initialize" ref="a7f240ddd6efe7daf7279ac4fa898ea02" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine , class copulaT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a7f240ddd6efe7daf7279ac4fa898ea02">initialize</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00137">137</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

<p>References <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::a</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00137">anonymous_namespace{marketmodel.cpp}::d</a>, <a class="el" href="ql_2time_2schedule_8hpp_source.html#l00064">QuantLib::Schedule::dates()</a>, <a class="el" href="test-suite_2marketmodel_8cpp_source.html#l00125">anonymous_namespace{marketmodel.cpp}::dates</a>, <a class="el" href="settings_8hpp_source.html#l00153">QuantLib::Settings::evaluationDate()</a>, <a class="el" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93">QuantLib::Singleton&lt; Settings &gt;::instance()</a>, and <a class="el" href="errors_8hpp_source.html#l00086">QL_REQUIRE</a>.</p>
<div class="fragment"><pre class="fragment">                                                                  {
        <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>.clear();
        Date today = <a class="code" href="class_quant_lib_1_1_singleton.html#ab79257029fa4841505227497a56cbd93" title="access to the unique instance">Settings::instance</a>().<a class="code" href="class_quant_lib_1_1_settings.html#a908ff4717a9706c4329fb316a49a5720" title="the date at which pricing is to be performed.">evaluationDate</a>();
        Date start = this-&gt;arguments_.schedule.startDate();
        boost::shared_ptr&lt;Basket&gt;&amp; basket = this-&gt;arguments_.basket;
        <span class="comment">/*</span>
<span class="comment">          Remove defaulted names and adjust the subordination.</span>
<span class="comment">        */</span>
        std::vector&lt;std::string&gt; names =
            basket-&gt;remainingNames(start, today);
        std::vector&lt;Real&gt; notionals
            = basket-&gt;remainingNotionals(start, today);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a> = basket-&gt;remainingAttachmentRatio(start, today);
        <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a06d0bee201af9d379ec8f9563ecf7f66">d</a> = basket-&gt;remainingDetachmentRatio(start, today);
        <span class="keyword">const</span> boost::shared_ptr&lt;Pool&gt; pool = basket-&gt;pool();
        this-&gt;remainingBasket_ =
            boost::shared_ptr&lt;Basket&gt;(<span class="keyword">new</span> Basket(names, notionals, pool,
                                                basket-&gt;remainingDefaultKeys(start, today),
                                                basket-&gt;remainingRecModels(start, today),
                                                 <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#ae0e5e63c42e87bfe1ae6c53a72160068">a</a>, <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a06d0bee201af9d379ec8f9563ecf7f66">d</a>));

        this-&gt;results_.xMin = this-&gt;remainingBasket_-&gt;attachmentAmount();
        this-&gt;results_.xMax = this-&gt;remainingBasket_-&gt;detachmentAmount();
        this-&gt;results_.remainingNotional =
            this-&gt;results_.xMax - this-&gt;results_.xMin;
        <span class="comment">//----------------------------------------------------------------</span>
        <span class="keywordflow">if</span>(<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>.empty())
            <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a> = std::vector&lt;Real&gt;(names.size(),
                                    <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3784a381eabfb629ed13d32f0e2e1501">correlQuote_</a>-&gt;value());
        <span class="comment">// check size of factors:</span>
        <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>.size() == names.size(),
            <span class="stringliteral">&quot;Size of matrix must match number of names in the basket.&quot;</span>);
        <span class="comment">//</span>
        std::vector&lt;Real&gt; lgdsTmp, lgds = this-&gt;remainingBasket_-&gt;LGDs();
        lgdsTmp = lgds;
        std::remove(lgds.begin(), lgds.end(), 0.);
        <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a> = *(std::min_element(lgds.begin(), lgds.end()))
            / <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a4d6c080e816705b0775ecfd97500e4e5">nBuckets_</a>;

        <span class="keywordflow">for</span>(<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = 0; i&lt;names.size(); i++)
            <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a>.push_back(std::floor(lgdsTmp[i]/<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a> + .5));

        <span class="comment">// Could not check parameters at construction time because we</span>
        <span class="comment">//   had no arguments yet, do it now:</span>
        <span class="keywordflow">if</span>(<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>.size() == 1)
            <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a> =
                std::vector&lt;Real&gt;(pool-&gt;size(), <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>[0]);
        <span class="keywordflow">else</span>
            <a class="code" href="errors_8hpp.html#a7a9bcab8006882bc7d5302a0861ab1a6" title="throw an error if the given pre-condition is not verified">QL_REQUIRE</a>(<a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>.size() == this-&gt;remainingBasket_-&gt;size(),
                <span class="stringliteral">&quot;Incompatible correl matrix, pool size.&quot;</span>);
        <span class="comment">//----------------------------------------------------------------</span>
        <span class="keyword">const</span> std::vector&lt;Date&gt;&amp; <a class="code" href="namespaceanonymous__namespace_02marketmodel_8cpp_03.html#a800db345cacda47dd48925126ea05f91">dates</a> = this-&gt;arguments_.schedule.dates();
        <span class="keywordflow">for</span> (<a class="code" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3" title="size of a container">Size</a> i = 0; i &lt; dates.size(); i++) {
            <span class="keywordflow">if</span> (dates[i] &lt;= today)
                this-&gt;results_.expectedTrancheLoss.push_back(0.0);
            <span class="keywordflow">else</span> {
                <a class="code" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50" title="real number">Real</a> L = <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#ab983f000a5e6fbf74424f05659bd0672">expectedTrancheLoss</a>(dates[i]);
                this-&gt;results_.expectedTrancheLoss.push_back(L);
            }
        }

    }
</pre></div>
</div>
</div>
<a class="anchor" id="a3368d697aa66a47d4b808edaab473c2f"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::integratorLoss" ref="a3368d697aa66a47d4b808edaab473c2f" args="(const Date &amp;date, Real mktFactor) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3368d697aa66a47d4b808edaab473c2f">integratorLoss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_quant_lib_1_1_date.html">Date</a> &amp;&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&#160;</td>
          <td class="paramname"><em>mktFactor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Weights the conditional portfolio loss by the mkt factor. </p>

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00078">78</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                    {
            <span class="keywordflow">return</span> <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#ac7c7bed5e95fb59aa2e14fdbac4cfd71" title="Portfolio loss conditional to the market factor value.">expectedConditionalLoss</a>(date, mktFactor) *
               <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a88c4b9d0213bdaeac8345ec9f1825e57">copula_</a>-&gt;density(mktFactor);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="aad2b8d6456f9f00557f81b04976e0c80"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::update" ref="aad2b8d6456f9f00557f81b04976e0c80" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine , class copulaT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#aad2b8d6456f9f00557f81b04976e0c80">update</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00130">130</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                        {
        <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0" title="name to name factor loadings (betas). In the single factor copula:">oneFactorCorrels_</a>.clear();
        <a class="code" href="class_quant_lib_1_1_recursive_cdo_engine.html#aad2b8d6456f9f00557f81b04976e0c80">CDOEngine::update</a>();
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a88c4b9d0213bdaeac8345ec9f1825e57"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::copula_" ref="a88c4b9d0213bdaeac8345ec9f1825e57" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_relinkable_handle.html">RelinkableHandle</a>&lt;copulaT&gt; <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a88c4b9d0213bdaeac8345ec9f1825e57">copula_</a><code> [mutable, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00114">114</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

<p>Referenced by <a class="el" href="recursivecdoengine_8hpp_source.html#l00078">QuantLib::RecursiveCdoEngine&lt; CDOEngine, OneFactorStudentCopula &gt;::integratorLoss()</a>.</p>

</div>
</div>
<a class="anchor" id="a3784a381eabfb629ed13d32f0e2e1501"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::correlQuote_" ref="a3784a381eabfb629ed13d32f0e2e1501" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_quant_lib_1_1_handle.html">Handle</a>&lt;<a class="el" href="class_quant_lib_1_1_quote.html">Quote</a>&gt; <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a3784a381eabfb629ed13d32f0e2e1501">correlQuote_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00113">113</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad5662bbfdaf1a294bf244e7694e0b168"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::integral_" ref="ad5662bbfdaf1a294bf244e7694e0b168" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_quant_lib_1_1_gauss_hermite_integration.html">GaussHermiteIntegration</a> <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#ad5662bbfdaf1a294bf244e7694e0b168">integral_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00118">118</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

<p>Referenced by <a class="el" href="recursivecdoengine_8hpp_source.html#l00103">QuantLib::RecursiveCdoEngine&lt; CDOEngine, OneFactorStudentCopula &gt;::expectedTrancheLoss()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f9f5b0959337bf26e61cc279dd77aa9"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::loss_unit_" ref="a8f9f5b0959337bf26e61cc279dd77aa9" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a> <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a8f9f5b0959337bf26e61cc279dd77aa9">loss_unit_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00120">120</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4d6c080e816705b0775ecfd97500e4e5"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::nBuckets_" ref="a4d6c080e816705b0775ecfd97500e4e5" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_quant_lib.html#af4cc4ef40b52c17cc455ead2a97aedb3">Size</a> <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a4d6c080e816705b0775ecfd97500e4e5">nBuckets_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00117">117</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9a3b01f6c5cfa304012ce738c7feb1e0"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::oneFactorCorrels_" ref="a9a3b01f6c5cfa304012ce738c7feb1e0" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&gt; <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a9a3b01f6c5cfa304012ce738c7feb1e0">oneFactorCorrels_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>name to name factor loadings (betas). In the single factor copula: </p>

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00125">125</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

<p>Referenced by <a class="el" href="recursivecdoengine_8hpp_source.html#l00061">QuantLib::RecursiveCdoEngine&lt; CDOEngine, OneFactorStudentCopula &gt;::RecursiveCdoEngine()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ad00783dd852d16876748a253e09e44"></a><!-- doxytag: member="QuantLib::RecursiveCdoEngine::wk_" ref="a6ad00783dd852d16876748a253e09e44" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CDOEngine, class copulaT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespace_quant_lib.html#a372ac5c1a422a6b276fe0552d4d83f50">Real</a>&gt; <a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">QuantLib::RecursiveCdoEngine</a>&lt; <a class="el" href="class_c_d_o_engine.html">CDOEngine</a>, copulaT &gt;::<a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html#a6ad00783dd852d16876748a253e09e44">wk_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="recursivecdoengine_8hpp_source.html#l00119">119</a> of file <a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/deriversatile/QuantLib/QuantLibQt/ql/experimental/credit/<a class="el" href="recursivecdoengine_8hpp_source.html">recursivecdoengine.hpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_quant_lib.html">QuantLib</a>      </li>
      <li class="navelem"><a class="el" href="class_quant_lib_1_1_recursive_cdo_engine.html">RecursiveCdoEngine</a>      </li>

    <li class="footer">Generated on Sat Aug 25 2012 13:51:05 for QuantLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
